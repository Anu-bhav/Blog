{"title":"TryHackMe - Advent of Cyber 3 (2021)","slug":"THM_AdventOfCyber3","html":"<h1 id=\"tryhackme---advent-of-cyber-3-2021\"><a target=\"_blank\" rel=\"nofollow\" href=\"https://tryhackme.com/room/adventofcyber3\">TryHackMe - Advent of Cyber 3 (2021)</a></h1>\n<p>The TryHackMe - Advent of Cyber 3 just launched today on the 1st of December 2021 and there are a lot of prizes to win.</p>\n<p>The room consists of completing a new, beginner friendly security exercise every day leading up until Christmas;</p>\n<p>I will be updating this walkthrough daily for each challenge.</p>\n<h2 id=\"day-1-web-exploitation-save-the-gifts\">[Day 1] <strong><code>Web Exploitation</code></strong> Save The Gifts</h2>\n<p>This task is based on Insecure Direct Object Reference or IDOR for short.</p>\n<p>The explanations are all provided on the challenge page.</p>\n<p><img src=\"THM_AdventOfCyber3.assets/image-20211202004735054.png\" alt=\"\"></p>\n<h3 id=\"challenge-walkthrough\"><strong>Challenge Walkthrough</strong></h3>\n<p>After finding Santa&#39;s account, what is their position in the company?</p>\n<p><img src=\"THM_AdventOfCyber3.assets/image-20211202005102738.png\" alt=\"\"></p>\n<p>Santa’s <code>user_id</code> is <code>1</code></p>\n<blockquote>\n<p>The Boss!</p>\n</blockquote>\n<p>After finding McStocker&#39;s account, what is their position in the company?</p>\n<p><img src=\"THM_AdventOfCyber3.assets/image-20211202005343221.png\" alt=\"\"></p>\n<p>McStocker&#39;s <code>user_id</code> is <code>2</code></p>\n<blockquote>\n<p>Build Manager</p>\n</blockquote>\n<p>After finding the account responsible for tampering, what is their position in the company?</p>\n<p><img src=\"THM_AdventOfCyber3.assets/image-20211202005454133.png\" alt=\"\"></p>\n<p>The account responsible for tampering is <code>Grinch’s</code> and <code>user_id</code> is <code>9</code></p>\n<blockquote>\n<p>Mischief Manager</p>\n</blockquote>\n<p>What is the received flag when McSkidy fixes the Inventory Management System?</p>\n<p><img src=\"THM_AdventOfCyber3.assets/image-20211202010129552.png\" alt=\"\"></p>\n<p>Once all the actions are revoked, the flag is displayed.</p>\n<p><img src=\"THM_AdventOfCyber3.assets/image-20211202010016166.png\" alt=\"\"></p>\n<blockquote>\n<p>THM{Fake_Flag}</p>\n</blockquote>\n<h2 id=\"day-2-web-exploitation-elf-hr-problems\">[Day 2] <code>Web Exploitation</code> Elf HR Problems</h2>\n<p>This task is based on understanding the underlying technology of web servers and how the web communicates.</p>\n<p>The objective is to know what cookies are and their purpose, and to learn how to manipulate and manage cookies for malicious use.</p>\n<p>More details can be found on the challenge page.</p>\n<p><img src=\"THM_AdventOfCyber3.assets/image-20211203042343205.png\" alt=\"\"></p>\n<h3 id=\"challenge-walkthrough-1\"><strong>Challenge Walkthrough</strong></h3>\n<p>Register an account, and verify the cookies using the Developer Tools in your browser.</p>\n<p>The registration process goes as follows:</p>\n<p><img src=\"THM_AdventOfCyber3.assets/image-20211203042719876.png\" alt=\"\"></p>\n<p><img src=\"THM_AdventOfCyber3.assets/image-20211203042824920.png\" alt=\"\"></p>\n<p>It can be determined that the website uses <code>GET</code> method to send the sign up data to the server, as all the user input can be seen in the browser’s URL bar.</p>\n<p>Once registered, the following is displayed.</p>\n<p><img src=\"THM_AdventOfCyber3.assets/image-20211203043301216.png\" alt=\"\"></p>\n<p>What is the name of the new cookie that was created for your account?</p>\n<p><img src=\"THM_AdventOfCyber3.assets/image-20211203043437509.png\" alt=\"\"></p>\n<blockquote>\n<p>user-auth</p>\n</blockquote>\n<p>What encoding type was used for the cookie value?</p>\n<p>The cookie value can be deduced to be of <code>Hex</code> as it contains <code>0 -9 A-F</code>.</p>\n<blockquote>\n<p>hexadecimal</p>\n</blockquote>\n<p>What object format is the data of the cookie stored in?</p>\n<p><a target=\"_blank\" rel=\"nofollow\" href=\"https://gchq.github.io/CyberChef/\">CyberChef</a> is a simple, intuitive web app for analysing and decoding data without having to deal with complex tools or programming languages. </p>\n<p><img src=\"THM_AdventOfCyber3.assets/image-20211203044020280.png\" alt=\"\"></p>\n<p>The output of the decoded cookie is in JSON or Javascript Object Notation format.</p>\n<blockquote>\n<p>JSON</p>\n</blockquote>\n<p>Manipulate the cookie and bypass the login portal.</p>\n<p>What is the value of the administrator cookie? (username = admin)</p>\n<p><img src=\"THM_AdventOfCyber3.assets/image-20211203044208882.png\" alt=\"\"></p>\n<pre class=\"language-\"><code class=\"language-\">7b636f6d70616e793a2022546865204265737420466573746976616c20436f6d70616e79222c206973726567697374657265643a2254727565222c20757365726e616d653a2261646d696e227d</code></pre><p>What team environment is not responding?</p>\n<p>After replacing the current user’s cookie with the new crafted cookie, admin access is granted</p>\n<p><img src=\"THM_AdventOfCyber3.assets/image-20211203044342791.png\" alt=\"\"></p>\n<p>The following page is then displayed upon going to the following URL.</p>\n<p><code>https://static-labs.tryhackme.cloud/sites/aoc-cookies/monitor.html</code></p>\n<p><img src=\"THM_AdventOfCyber3.assets/image-20211203044418843.png\" alt=\"\"></p>\n<p>The team that is not responding is <code>HR</code></p>\n<blockquote>\n<p>HR</p>\n</blockquote>\n<p>What team environment has a network warning?</p>\n<p>The team having network warning is <code>Application</code></p>\n<blockquote>\n<p>Application</p>\n</blockquote>\n<h2 id=\"day-3-web-exploitation-christmas-blackout\">[Day 3] <code>Web Exploitation</code> Christmas Blackout</h2>\n<p>This task is based on content discovery.  Content is the assets and inner workings of the application that we are testing. Contents can be files, folders, or pathways that weren&#39;t necessarily intended to be accessed by the general public.</p>\n<p><img src=\"THM_AdventOfCyber3.assets/image-20211203224537004.png\" alt=\"\"></p>\n<p>More detail can be found on the challenge page.</p>\n<h3 id=\"challenge-walkthrough-2\">Challenge Walkthrough</h3>\n<p>When deployed, the IP of the machine is provided. In this case the IP is <a target=\"_blank\" rel=\"nofollow\" href=\"http://10.10.87.213\">10.10.87.213</a>.</p>\n<p>To access the machine, a VPN connection is needed so as to access the lab. This can be done as followed.</p>\n<p><img src=\"THM_AdventOfCyber3.assets/image-20211203225604950.png\" alt=\"\"></p>\n<p>Then the machine IP can be pinged to see if it responds.</p>\n<p><img src=\"THM_AdventOfCyber3.assets/image-20211203225655156.png\" alt=\"\"></p>\n<p>Using a common wordlist for discovering content, enumerate <a target=\"_blank\" rel=\"nofollow\" href=\"http://10.10.87.213\">http://10.10.87.213</a> to find the location of the administrator dashboard. What is the name of the folder?</p>\n<p>This is the default index page.</p>\n<p><img src=\"THM_AdventOfCyber3.assets/image-20211203232041659.png\" alt=\"\"></p>\n<p><img src=\"THM_AdventOfCyber3.assets/image-20211203231521255.png\" alt=\"\"></p>\n<p>This is the /admin page.</p>\n<p><img src=\"THM_AdventOfCyber3.assets/image-20211203232134491.png\" alt=\"\"></p>\n<blockquote>\n<p>admin</p>\n</blockquote>\n<p>In your web browser, try some default credentials on the newly discovered login form for the &quot;<strong>administrator</strong>&quot; user. What is the password?</p>\n<p>The challenge page provided some default credentials.</p>\n<p><img src=\"THM_AdventOfCyber3.assets/image-20211203232310465.png\" alt=\"\"></p>\n<p><img src=\"THM_AdventOfCyber3.assets/image-20211203232225379.png\" alt=\"\"></p>\n<p>The valid credential is username: <code>administrator</code> and password: <code>administrator</code> </p>\n<blockquote>\n<p>administrator</p>\n</blockquote>\n<p>Access the admin panel. What is the value of the flag?</p>\n<p><img src=\"THM_AdventOfCyber3.assets/image-20211203232625213.png\" alt=\"\"></p>\n<blockquote>\n<p>THM{Fake_Flag}</p>\n</blockquote>\n","date":"2021-12-01","excerpt":"\nTryHackMe - Advent of Cyber 3 (2021)\n\n","printDate":"December 1, 2021","printReadingTime":"4 min read"}