<!doctype html> <head> <meta charset=utf-8> <meta name=viewport content="width=device-width,initial-scale=1"> <meta name=theme-color content=#333333> <base href=/logbook/ > <link href=global.css rel=stylesheet> <link href=fonts.css rel=stylesheet> <link href=highlight.css rel=stylesheet> <link href=manifest.json rel=manifest> <link href=as-logo2.ico rel=icon type=image/png> <link href=client/main.2271471939.css rel=stylesheet> <noscript id=sapper-head-start></noscript><title>TryHackMe - Advent of Cyber 3 (2021)</title><meta content=article property=og:type><meta content="TryHackMe - Advent of Cyber 3 (2021)" property=og:title><meta name=Description content="
TryHackMe - Advent of Cyber 3 (2021)

"><meta content="
TryHackMe - Advent of Cyber 3 (2021)

" property=og:description><meta name=twitter:card content=summary_large_image><meta name=twitter:title value="TryHackMe - Advent of Cyber 3 (2021)"><meta name=twitter:description content="
TryHackMe - Advent of Cyber 3 (2021)

"><meta name=twitter:label1 value="Published on"><meta name=twitter:data1 value="Dec 1, 2021"><meta name=twitter:label2 value="Reading Time"><meta name=twitter:data2 value="3 min read"><noscript id=sapper-head-end></noscript> </head> <body> <div id=sapper> <div class="svelte-v25qrq layout"> <header class=svelte-y9ah38> <a href=/ > <img alt=Sapper src=as-logo2.ico class=svelte-1u41owj> </a> <nav class=svelte-16qpxtx> <a href=. class=svelte-16qpxtx>Home</a> <a href=blog class="svelte-16qpxtx selected" rel=prefetch>Blog</a> <a href=https://anu-bhav.github.io class=svelte-16qpxtx>Website</a> </nav> </header> <main class=svelte-v25qrq> <header class=svelte-ww3xvk> <p class=svelte-ww3xvk>December 1, 2021 ~ 3 min read</p> <h1 class=svelte-ww3xvk>TryHackMe - Advent of Cyber 3 (2021)</h1> <hr class=svelte-ww3xvk> </header> <div class=container> <article class=content> <h1 id=tryhackme---advent-of-cyber-3-2021><a href=https://tryhackme.com/room/adventofcyber3 target=_blank rel=nofollow>TryHackMe - Advent of Cyber 3 (2021)</a></h1> <p>The TryHackMe - Advent of Cyber 3 just launched today on the 1st of December 2021 and there are a lot of prizes to win.</p> <p>The room consists of completing a new, beginner friendly security exercise every day leading up until Christmas;</p> <p>I will be updating this walkthrough daily for each challenge.</p> <h2 id=day-1-web-exploitation-save-the-gifts>[Day 1] <strong><code>Web Exploitation</code></strong> Save The Gifts</h2> <p>This task is based on Insecure Direct Object Reference or IDOR for short.</p> <p>The explanations are all provided on the challenge page.</p> <p><img alt="" src=THM_AdventOfCyber3.assets/image-20211202004735054.png></p> <h3 id=challenge-walkthrough><strong>Challenge Walkthrough</strong></h3> <p>After finding Santa's account, what is their position in the company?</p> <p><img alt="" src=THM_AdventOfCyber3.assets/image-20211202005102738.png></p> <p>Santa’s <code>user_id</code> is <code>1</code></p> <blockquote> <p>The Boss!</p> </blockquote> <p>After finding McStocker's account, what is their position in the company?</p> <p><img alt="" src=THM_AdventOfCyber3.assets/image-20211202005343221.png></p> <p>McStocker's <code>user_id</code> is <code>2</code></p> <blockquote> <p>Build Manager</p> </blockquote> <p>After finding the account responsible for tampering, what is their position in the company?</p> <p><img alt="" src=THM_AdventOfCyber3.assets/image-20211202005454133.png></p> <p>The account responsible for tampering is <code>Grinch’s</code> and <code>user_id</code> is <code>9</code></p> <blockquote> <p>Mischief Manager</p> </blockquote> <p>What is the received flag when McSkidy fixes the Inventory Management System?</p> <p><img alt="" src=THM_AdventOfCyber3.assets/image-20211202010129552.png></p> <p>Once all the actions are revoked, the flag is displayed.</p> <p><img alt="" src=THM_AdventOfCyber3.assets/image-20211202010016166.png></p> <blockquote> <p>THM{Fake_Flag}</p> </blockquote> <h2 id=day-2-web-exploitation-elf-hr-problems>[Day 2] <code>Web Exploitation</code> Elf HR Problems</h2> <p>This task is based on understanding the underlying technology of web servers and how the web communicates.</p> <p>The objective is to know what cookies are and their purpose, and to learn how to manipulate and manage cookies for malicious use.</p> <p>More details can be found on the challenge page.</p> <p><img alt=image-20211203042343205 src=THM_AdventOfCyber3.assets/image-20211203042343205.png></p> <h3 id=challenge-walkthrough-1><strong>Challenge Walkthrough</strong></h3> <p>Register an account, and verify the cookies using the Developer Tools in your browser.</p> <p>The registration process goes as follows:</p> <p><img alt=image-20211203042719876 src=THM_AdventOfCyber3.assets/image-20211203042719876.png></p> <p><img alt=image-20211203042824920 src=THM_AdventOfCyber3.assets/image-20211203042824920.png></p> <p>It can be determined that the website uses <code>GET</code> method to send the sign up data to the server, as all the user input can be seen in the browser’s URL bar.</p> <p>Once registered, the following is displayed.</p> <p><img alt=image-20211203043301216 src=THM_AdventOfCyber3.assets/image-20211203043301216.png></p> <p>What is the name of the new cookie that was created for your account?</p> <p><img alt=image-20211203043437509 src=THM_AdventOfCyber3.assets/image-20211203043437509.png></p> <blockquote> <p>user-auth</p> </blockquote> <p>What encoding type was used for the cookie value?</p> <p>The cookie value can be deduced to be of <code>Hex</code> as it contains <code>0 -9 A-F</code>.</p> <blockquote> <p>hexadecimal</p> </blockquote> <p>What object format is the data of the cookie stored in?</p> <p>CyberChef is a simple, intuitive web app for analysing and decoding data without having to deal with complex tools or programming languages. </p> <p><img alt=image-20211203044020280 src=THM_AdventOfCyber3.assets/image-20211203044020280.png></p> <p>The output of the decoded cookie is in JSON or Javascript Object Notation format.</p> <blockquote> <p>JSON</p> </blockquote> <p>Manipulate the cookie and bypass the login portal.</p> <p>What is the value of the administrator cookie? (username = admin)</p> <p><img alt=image-20211203044208882 src=THM_AdventOfCyber3.assets/image-20211203044208882.png></p> <blockquote> <p>7b636f6d70616e793a2022546865204265737420466573746976616c20436f6d70616e79222c206973726567697374657265643a2254727565222c20757365726e616d653a2261646d696e227d</p> </blockquote> <p>What team environment is not responding?</p> <p>After replacing the current user’s cookie with the new crafted cookie, admin access is granted</p> <p><img alt=image-20211203044342791 src=THM_AdventOfCyber3.assets/image-20211203044342791.png></p> <p>The following page is then displayed upon going to the following URL.</p> <p><code>https://static-labs.tryhackme.cloud/sites/aoc-cookies/monitor.html</code></p> <p><img alt=image-20211203044418843 src=THM_AdventOfCyber3.assets/image-20211203044418843.png></p> <p>The team that is not responding is <code>HR</code></p> <blockquote> <p>HR</p> </blockquote> <p>What team environment has a network warning?</p> <p>The team having network warning is <code>Application</code></p> <blockquote> <p>Application</p> </blockquote> </article> <hr> <button class="back-to-top hidden svelte-h76b9j"> <svg aria-hidden=true class="" id="" role=img style=height:1em;line-height:.75em;font-size:1.33333em;vertical-align:-.225em;overflow:visible viewBox="0 0 448 512" xmlns=http://www.w3.org/2000/svg> <g transform="translate(256 256)"> <g transform=""> <path d="M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6 0-33.9L207 39c9.4-9.4 24.6-9.4 33.9 0l194.3 194.3c9.4 9.4 9.4 24.6 0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3 0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z" fill=currentColor transform="translate(-256 -256)"></path> </g> </g> </svg> </button> <div class=svelte-16tlu6p> <img alt="Anubhavsingh Sawdagur" src=profile-pic.png class=svelte-16tlu6p> <p class=svelte-16tlu6p> Hi, I'm <strong class=highlight>Anubhav</strong>. I'm an Ethical Hacker, Software Engineer and Network Engineer from Mauritius. <br> You can find me on <a href=https://www.instagram.com/_anu_bhav_/ target=_blank>Instagram</a>, <a href=https://www.twitter.com/0_Pr0t0typ3/ target=_blank>Twitter</a>, <a href=https://www.facebook.com/anubhav.s.0809/ target=_blank>Facebook</a> or <a href=https://www.linkedin.com/in/anubhavsingh-sawdagur/ target=_blank>LinkedIn</a>. See more of my work on <a href="https://github.com/Anu-bhav?tab=repositories" target=_blank>GitHub</a> or read about me on my <a href=https://anu-bhav.github.io/ target=_blank>Website</a> </p> </div> </div> </main> <footer class=svelte-v25qrq> <span> © 2021 Personal Blog. Powered by <a href=https://sapper.svelte.dev target=_blank>Sapper</a>. Template by <a href=https://anu-bhav.github.io target=_blank>Anubhavsingh Sawdagur</a>. </span> </footer> </div></div> <script>__SAPPER__={baseUrl:"/logbook",preloaded:[void 0,null,{pdf_location:"#",has_pdf:false,post:{title:"TryHackMe - Advent of Cyber 3 (2021)",slug:"THM_AdventOfCyber3",html:"\u003Ch1 id=\"tryhackme---advent-of-cyber-3-2021\"\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Ftryhackme.com\u002Froom\u002Fadventofcyber3\"\u003ETryHackMe - Advent of Cyber 3 (2021)\u003C\u002Fa\u003E\u003C\u002Fh1\u003E\n\u003Cp\u003EThe TryHackMe - Advent of Cyber 3 just launched today on the 1st of December 2021 and there are a lot of prizes to win.\u003C\u002Fp\u003E\n\u003Cp\u003EThe room consists of completing a new, beginner friendly security exercise every day leading up until Christmas;\u003C\u002Fp\u003E\n\u003Cp\u003EI will be updating this walkthrough daily for each challenge.\u003C\u002Fp\u003E\n\u003Ch2 id=\"day-1-web-exploitation-save-the-gifts\"\u003E[Day 1] \u003Cstrong\u003E\u003Ccode\u003EWeb Exploitation\u003C\u002Fcode\u003E\u003C\u002Fstrong\u003E Save The Gifts\u003C\u002Fh2\u003E\n\u003Cp\u003EThis task is based on Insecure Direct Object Reference or IDOR for short.\u003C\u002Fp\u003E\n\u003Cp\u003EThe explanations are all provided on the challenge page.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"THM_AdventOfCyber3.assets\u002Fimage-20211202004735054.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Ch3 id=\"challenge-walkthrough\"\u003E\u003Cstrong\u003EChallenge Walkthrough\u003C\u002Fstrong\u003E\u003C\u002Fh3\u003E\n\u003Cp\u003EAfter finding Santa&#39;s account, what is their position in the company?\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"THM_AdventOfCyber3.assets\u002Fimage-20211202005102738.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003ESanta’s \u003Ccode\u003Euser_id\u003C\u002Fcode\u003E is \u003Ccode\u003E1\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003EThe Boss!\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cp\u003EAfter finding McStocker&#39;s account, what is their position in the company?\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"THM_AdventOfCyber3.assets\u002Fimage-20211202005343221.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EMcStocker&#39;s \u003Ccode\u003Euser_id\u003C\u002Fcode\u003E is \u003Ccode\u003E2\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003EBuild Manager\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cp\u003EAfter finding the account responsible for tampering, what is their position in the company?\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"THM_AdventOfCyber3.assets\u002Fimage-20211202005454133.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EThe account responsible for tampering is \u003Ccode\u003EGrinch’s\u003C\u002Fcode\u003E and \u003Ccode\u003Euser_id\u003C\u002Fcode\u003E is \u003Ccode\u003E9\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003EMischief Manager\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cp\u003EWhat is the received flag when McSkidy fixes the Inventory Management System?\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"THM_AdventOfCyber3.assets\u002Fimage-20211202010129552.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EOnce all the actions are revoked, the flag is displayed.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"THM_AdventOfCyber3.assets\u002Fimage-20211202010016166.png\" alt=\"\"\u003E\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003ETHM{Fake_Flag}\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Ch2 id=\"day-2-web-exploitation-elf-hr-problems\"\u003E[Day 2] \u003Ccode\u003EWeb Exploitation\u003C\u002Fcode\u003E Elf HR Problems\u003C\u002Fh2\u003E\n\u003Cp\u003EThis task is based on understanding the underlying technology of web servers and how the web communicates.\u003C\u002Fp\u003E\n\u003Cp\u003EThe objective is to know what cookies are and their purpose, and to learn how to manipulate and manage cookies for malicious use.\u003C\u002Fp\u003E\n\u003Cp\u003EMore details can be found on the challenge page.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"THM_AdventOfCyber3.assets\u002Fimage-20211203042343205.png\" alt=\"image-20211203042343205\"\u003E\u003C\u002Fp\u003E\n\u003Ch3 id=\"challenge-walkthrough-1\"\u003E\u003Cstrong\u003EChallenge Walkthrough\u003C\u002Fstrong\u003E\u003C\u002Fh3\u003E\n\u003Cp\u003ERegister an account, and verify the cookies using the Developer Tools in your browser.\u003C\u002Fp\u003E\n\u003Cp\u003EThe registration process goes as follows:\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"THM_AdventOfCyber3.assets\u002Fimage-20211203042719876.png\" alt=\"image-20211203042719876\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"THM_AdventOfCyber3.assets\u002Fimage-20211203042824920.png\" alt=\"image-20211203042824920\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EIt can be determined that the website uses \u003Ccode\u003EGET\u003C\u002Fcode\u003E method to send the sign up data to the server, as all the user input can be seen in the browser’s URL bar.\u003C\u002Fp\u003E\n\u003Cp\u003EOnce registered, the following is displayed.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"THM_AdventOfCyber3.assets\u002Fimage-20211203043301216.png\" alt=\"image-20211203043301216\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EWhat is the name of the new cookie that was created for your account?\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"THM_AdventOfCyber3.assets\u002Fimage-20211203043437509.png\" alt=\"image-20211203043437509\"\u003E\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003Euser-auth\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cp\u003EWhat encoding type was used for the cookie value?\u003C\u002Fp\u003E\n\u003Cp\u003EThe cookie value can be deduced to be of \u003Ccode\u003EHex\u003C\u002Fcode\u003E as it contains \u003Ccode\u003E0 -9 A-F\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003Ehexadecimal\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cp\u003EWhat object format is the data of the cookie stored in?\u003C\u002Fp\u003E\n\u003Cp\u003ECyberChef is a simple, intuitive web app for analysing and decoding data without having to deal with complex tools or programming languages. \u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"THM_AdventOfCyber3.assets\u002Fimage-20211203044020280.png\" alt=\"image-20211203044020280\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EThe output of the decoded cookie is in JSON or Javascript Object Notation format.\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003EJSON\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cp\u003EManipulate the cookie and bypass the login portal.\u003C\u002Fp\u003E\n\u003Cp\u003EWhat is the value of the administrator cookie? (username = admin)\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"THM_AdventOfCyber3.assets\u002Fimage-20211203044208882.png\" alt=\"image-20211203044208882\"\u003E\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E7b636f6d70616e793a2022546865204265737420466573746976616c20436f6d70616e79222c206973726567697374657265643a2254727565222c20757365726e616d653a2261646d696e227d\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cp\u003EWhat team environment is not responding?\u003C\u002Fp\u003E\n\u003Cp\u003EAfter replacing the current user’s cookie with the new crafted cookie, admin access is granted\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"THM_AdventOfCyber3.assets\u002Fimage-20211203044342791.png\" alt=\"image-20211203044342791\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EThe following page is then displayed upon going to the following URL.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ccode\u003Ehttps:\u002F\u002Fstatic-labs.tryhackme.cloud\u002Fsites\u002Faoc-cookies\u002Fmonitor.html\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"THM_AdventOfCyber3.assets\u002Fimage-20211203044418843.png\" alt=\"image-20211203044418843\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EThe team that is not responding is \u003Ccode\u003EHR\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003EHR\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cp\u003EWhat team environment has a network warning?\u003C\u002Fp\u003E\n\u003Cp\u003EThe team having network warning is \u003Ccode\u003EApplication\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003EApplication\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n",date:"2021-12-01",excerpt:"\nTryHackMe - Advent of Cyber 3 (2021)\n\n",printDate:"December 1, 2021",printReadingTime:"3 min read"}}]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/logbook/service-worker.js');(function(){try{eval("async function x(){}");var main="/logbook/client/client.e7e93abc.js"}catch(e){main="/logbook/client/legacy/client.60304074.js"};var s=document.createElement("script");try{new Function("if(0)import('')")();s.src=main;s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/logbook/client/shimport@1.0.1.js";s.setAttribute("data-main",main);}document.head.appendChild(s);}());</script> 